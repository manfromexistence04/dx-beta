import{a as g,b as y}from"./chunk-M2JW2GFW.js";import{d as re,f as Pr}from"./chunk-SXMPUQ6M.js";var ma=re(fa=>{g();var Gl;(function(e){typeof DO_NOT_EXPORT_CRC>"u"?typeof fa=="object"?e(fa):typeof define=="function"&&define.amd?define(function(){var t={};return e(t),t}):e(Gl={}):e(Gl={})})(function(e){e.version="0.3.0";function t(){for(var l=0,c=new Array(256),d=0;d!=256;++d)l=d,l=l&1?-306674912^l>>>1:l>>>1,l=l&1?-306674912^l>>>1:l>>>1,l=l&1?-306674912^l>>>1:l>>>1,l=l&1?-306674912^l>>>1:l>>>1,l=l&1?-306674912^l>>>1:l>>>1,l=l&1?-306674912^l>>>1:l>>>1,l=l&1?-306674912^l>>>1:l>>>1,l=l&1?-306674912^l>>>1:l>>>1,c[d]=l;return typeof Int32Array<"u"?new Int32Array(c):c}var n=t(),r=typeof Buffer<"u";function o(l){if(l.length>32768&&r)return a(new Buffer(l));for(var c=-1,d=l.length-1,u=0;u<d;)c=n[(c^l.charCodeAt(u++))&255]^c>>>8,c=n[(c^l.charCodeAt(u++))&255]^c>>>8;return u===d&&(c=c>>>8^n[(c^l.charCodeAt(u))&255]),c^-1}function i(l){if(l.length>1e4)return a(l);for(var c=-1,d=0,u=l.length-3;d<u;)c=c>>>8^n[(c^l[d++])&255],c=c>>>8^n[(c^l[d++])&255],c=c>>>8^n[(c^l[d++])&255],c=c>>>8^n[(c^l[d++])&255];for(;d<u+3;)c=c>>>8^n[(c^l[d++])&255];return c^-1}function a(l){for(var c=-1,d=0,u=l.length-7;d<u;)c=c>>>8^n[(c^l[d++])&255],c=c>>>8^n[(c^l[d++])&255],c=c>>>8^n[(c^l[d++])&255],c=c>>>8^n[(c^l[d++])&255],c=c>>>8^n[(c^l[d++])&255],c=c>>>8^n[(c^l[d++])&255],c=c>>>8^n[(c^l[d++])&255],c=c>>>8^n[(c^l[d++])&255];for(;d<u+7;)c=c>>>8^n[(c^l[d++])&255];return c^-1}function s(l){for(var c=-1,d=0,u=l.length,f,m;d<u;)f=l.charCodeAt(d++),f<128?c=c>>>8^n[(c^f)&255]:f<2048?(c=c>>>8^n[(c^(192|f>>6&31))&255],c=c>>>8^n[(c^(128|f&63))&255]):f>=55296&&f<57344?(f=(f&1023)+64,m=l.charCodeAt(d++)&1023,c=c>>>8^n[(c^(240|f>>8&7))&255],c=c>>>8^n[(c^(128|f>>2&63))&255],c=c>>>8^n[(c^(128|m>>6&15|f&3))&255],c=c>>>8^n[(c^(128|m&63))&255]):(c=c>>>8^n[(c^(224|f>>12&15))&255],c=c>>>8^n[(c^(128|f>>6&63))&255],c=c>>>8^n[(c^(128|f&63))&255]);return c^-1}e.table=n,e.bstr=o,e.buf=i,e.str=s})});var Hl=re((Jw,zl)=>{g();var $p=ma();zl.exports=Xp;var ut=new Uint8Array(4),Yp=new Int32Array(ut.buffer),Wp=new Uint32Array(ut.buffer);function Xp(e){if(e[0]!==137)throw new Error("Invalid .png file header");if(e[1]!==80)throw new Error("Invalid .png file header");if(e[2]!==78)throw new Error("Invalid .png file header");if(e[3]!==71)throw new Error("Invalid .png file header");if(e[4]!==13)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(e[5]!==10)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(e[6]!==26)throw new Error("Invalid .png file header");if(e[7]!==10)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");for(var t=!1,n=[],r=8;r<e.length;){ut[3]=e[r++],ut[2]=e[r++],ut[1]=e[r++],ut[0]=e[r++];var o=Wp[0]+4,i=new Uint8Array(o);i[0]=e[r++],i[1]=e[r++],i[2]=e[r++],i[3]=e[r++];var a=String.fromCharCode(i[0])+String.fromCharCode(i[1])+String.fromCharCode(i[2])+String.fromCharCode(i[3]);if(!n.length&&a!=="IHDR")throw new Error("IHDR header missing");if(a==="IEND"){t=!0,n.push({name:a,data:new Uint8Array(0)});break}for(var s=4;s<o;s++)i[s]=e[r++];ut[3]=e[r++],ut[2]=e[r++],ut[1]=e[r++],ut[0]=e[r++];var l=Yp[0],c=$p.buf(i);if(c!==l)throw new Error("CRC values for "+a+" header do not match, PNG file is likely corrupted");var d=new Uint8Array(i.buffer.slice(4));n.push({name:a,data:d})}if(!t)throw new Error(".png file ended prematurely: no IEND header was found");return n}});var Vl=re((eb,Ul)=>{g();Ul.exports=Zp;function Zp(e,t){if(e=String(e),t=String(t),!/^[\x00-\xFF]+$/.test(e)||!/^[\x00-\xFF]+$/.test(t))throw new Error("Only Latin-1 characters are permitted in PNG tEXt chunks. You might want to consider base64 encoding and/or zEXt compression");if(e.length>=80)throw new Error('Keyword "'+e+'" is longer than the 79-character limit imposed by the PNG specification');for(var n=e.length+t.length+1,r=new Uint8Array(n),o=0,i,a=0;a<e.length;a++){if(!(i=e.charCodeAt(a)))throw new Error("0x00 character is not permitted in tEXt keywords");r[o++]=i}r[o++]=0;for(var s=0;s<t.length;s++){if(!(i=t.charCodeAt(s)))throw new Error("0x00 character is not permitted in tEXt content");r[o++]=i}return{name:"tEXt",data:r}}});var Yl=re((nb,$l)=>{g();$l.exports=Kp;function Kp(e){e.data&&e.name&&(e=e.data);for(var t=!0,n="",r="",o=0;o<e.length;o++){var i=e[o];if(t)i?r+=String.fromCharCode(i):t=!1;else if(i)n+=String.fromCharCode(i);else throw new Error("Invalid NULL character found. 0x00 character is not permitted in tEXt content")}return{keyword:r,text:n}}});var Wl=re(pa=>{g();pa.encode=Vl();pa.decode=Yl()});var Zl=re((ab,Xl)=>{g();Xl.exports=function(e,t,n){var r=[],o=e.length;if(o===0)return r;var i=t<0?Math.max(0,t+o):t||0;for(n!==void 0&&(o=n<0?n+o:n);o-- >i;)r[o-i]=e[o];return r}});var jl=re((lb,Kl)=>{g();var jp=Zl(),qp=ma();Kl.exports=eh;var ft=new Uint8Array(4),Jp=new Int32Array(ft.buffer),Qp=new Uint32Array(ft.buffer);function eh(e){var t=8,n=t,r;for(r=0;r<e.length;r++)t+=e[r].data.length,t+=12;var o=new Uint8Array(t);for(o[0]=137,o[1]=80,o[2]=78,o[3]=71,o[4]=13,o[5]=10,o[6]=26,o[7]=10,r=0;r<e.length;r++){var i=e[r],a=i.name,s=i.data,l=s.length,c=[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)];Qp[0]=l,o[n++]=ft[3],o[n++]=ft[2],o[n++]=ft[1],o[n++]=ft[0],o[n++]=c[0],o[n++]=c[1],o[n++]=c[2],o[n++]=c[3];for(var d=0;d<l;)o[n++]=s[d++];var u=c.concat(jp(s)),f=qp.buf(u);Jp[0]=f,o[n++]=ft[3],o[n++]=ft[2],o[n++]=ft[1],o[n++]=ft[0]}return o}});var Ct=re(Te=>{"use strict";g();var th=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function nh(e,t){return Object.prototype.hasOwnProperty.call(e,t)}Te.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(var r in n)nh(n,r)&&(e[r]=n[r])}}return e};Te.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var rh={arraySet:function(e,t,n,r,o){if(t.subarray&&e.subarray){e.set(t.subarray(n,n+r),o);return}for(var i=0;i<r;i++)e[o+i]=t[n+i]},flattenChunks:function(e){var t,n,r,o,i,a;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(a=new Uint8Array(r),o=0,t=0,n=e.length;t<n;t++)i=e[t],a.set(i,o),o+=i.length;return a}},oh={arraySet:function(e,t,n,r,o){for(var i=0;i<r;i++)e[o+i]=t[n+i]},flattenChunks:function(e){return[].concat.apply([],e)}};Te.setTyped=function(e){e?(Te.Buf8=Uint8Array,Te.Buf16=Uint16Array,Te.Buf32=Int32Array,Te.assign(Te,rh)):(Te.Buf8=Array,Te.Buf16=Array,Te.Buf32=Array,Te.assign(Te,oh))};Te.setTyped(th)});var wc=re(Zn=>{"use strict";g();var ih=Ct(),ah=4,ql=0,Jl=1,sh=2;function Xn(e){for(var t=e.length;--t>=0;)e[t]=0}var lh=0,oc=1,ch=2,dh=3,uh=258,ya=29,Or=256,Dr=Or+1+ya,Wn=30,va=19,ic=2*Dr+1,wn=15,ha=16,fh=7,Ta=256,ac=16,sc=17,lc=18,wa=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Oo=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],mh=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],cc=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ph=512,Lt=new Array((Dr+2)*2);Xn(Lt);var Mr=new Array(Wn*2);Xn(Mr);var Cr=new Array(ph);Xn(Cr);var Lr=new Array(uh-dh+1);Xn(Lr);var Aa=new Array(ya);Xn(Aa);var Ro=new Array(Wn);Xn(Ro);function Ea(e,t,n,r,o){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=o,this.has_stree=e&&e.length}var dc,uc,fc;function ga(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function mc(e){return e<256?Cr[e]:Cr[256+(e>>>7)]}function kr(e,t){e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255}function Ie(e,t,n){e.bi_valid>ha-n?(e.bi_buf|=t<<e.bi_valid&65535,kr(e,e.bi_buf),e.bi_buf=t>>ha-e.bi_valid,e.bi_valid+=n-ha):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function mt(e,t,n){Ie(e,n[t*2],n[t*2+1])}function pc(e,t){var n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1}function hh(e){e.bi_valid===16?(kr(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function Eh(e,t){var n=t.dyn_tree,r=t.max_code,o=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,l=t.stat_desc.max_length,c,d,u,f,m,p,h=0;for(f=0;f<=wn;f++)e.bl_count[f]=0;for(n[e.heap[e.heap_max]*2+1]=0,c=e.heap_max+1;c<ic;c++)d=e.heap[c],f=n[n[d*2+1]*2+1]+1,f>l&&(f=l,h++),n[d*2+1]=f,!(d>r)&&(e.bl_count[f]++,m=0,d>=s&&(m=a[d-s]),p=n[d*2],e.opt_len+=p*(f+m),i&&(e.static_len+=p*(o[d*2+1]+m)));if(h!==0){do{for(f=l-1;e.bl_count[f]===0;)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[l]--,h-=2}while(h>0);for(f=l;f!==0;f--)for(d=e.bl_count[f];d!==0;)u=e.heap[--c],!(u>r)&&(n[u*2+1]!==f&&(e.opt_len+=(f-n[u*2+1])*n[u*2],n[u*2+1]=f),d--)}}function hc(e,t,n){var r=new Array(wn+1),o=0,i,a;for(i=1;i<=wn;i++)r[i]=o=o+n[i-1]<<1;for(a=0;a<=t;a++){var s=e[a*2+1];s!==0&&(e[a*2]=pc(r[s]++,s))}}function gh(){var e,t,n,r,o,i=new Array(wn+1);for(n=0,r=0;r<ya-1;r++)for(Aa[r]=n,e=0;e<1<<wa[r];e++)Lr[n++]=r;for(Lr[n-1]=r,o=0,r=0;r<16;r++)for(Ro[r]=o,e=0;e<1<<Oo[r];e++)Cr[o++]=r;for(o>>=7;r<Wn;r++)for(Ro[r]=o<<7,e=0;e<1<<Oo[r]-7;e++)Cr[256+o++]=r;for(t=0;t<=wn;t++)i[t]=0;for(e=0;e<=143;)Lt[e*2+1]=8,e++,i[8]++;for(;e<=255;)Lt[e*2+1]=9,e++,i[9]++;for(;e<=279;)Lt[e*2+1]=7,e++,i[7]++;for(;e<=287;)Lt[e*2+1]=8,e++,i[8]++;for(hc(Lt,Dr+1,i),e=0;e<Wn;e++)Mr[e*2+1]=5,Mr[e*2]=pc(e,5);dc=new Ea(Lt,wa,Or+1,Dr,wn),uc=new Ea(Mr,Oo,0,Wn,wn),fc=new Ea(new Array(0),mh,0,va,fh)}function Ec(e){var t;for(t=0;t<Dr;t++)e.dyn_ltree[t*2]=0;for(t=0;t<Wn;t++)e.dyn_dtree[t*2]=0;for(t=0;t<va;t++)e.bl_tree[t*2]=0;e.dyn_ltree[Ta*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function gc(e){e.bi_valid>8?kr(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function xh(e,t,n,r){gc(e),r&&(kr(e,n),kr(e,~n)),ih.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}function Ql(e,t,n,r){var o=t*2,i=n*2;return e[o]<e[i]||e[o]===e[i]&&r[t]<=r[n]}function xa(e,t,n){for(var r=e.heap[n],o=n<<1;o<=e.heap_len&&(o<e.heap_len&&Ql(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!Ql(t,r,e.heap[o],e.depth));)e.heap[n]=e.heap[o],n=o,o<<=1;e.heap[n]=r}function ec(e,t,n){var r,o,i=0,a,s;if(e.last_lit!==0)do r=e.pending_buf[e.d_buf+i*2]<<8|e.pending_buf[e.d_buf+i*2+1],o=e.pending_buf[e.l_buf+i],i++,r===0?mt(e,o,t):(a=Lr[o],mt(e,a+Or+1,t),s=wa[a],s!==0&&(o-=Aa[a],Ie(e,o,s)),r--,a=mc(r),mt(e,a,n),s=Oo[a],s!==0&&(r-=Ro[a],Ie(e,r,s)));while(i<e.last_lit);mt(e,Ta,t)}function ba(e,t){var n=t.dyn_tree,r=t.stat_desc.static_tree,o=t.stat_desc.has_stree,i=t.stat_desc.elems,a,s,l=-1,c;for(e.heap_len=0,e.heap_max=ic,a=0;a<i;a++)n[a*2]!==0?(e.heap[++e.heap_len]=l=a,e.depth[a]=0):n[a*2+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,n[c*2]=1,e.depth[c]=0,e.opt_len--,o&&(e.static_len-=r[c*2+1]);for(t.max_code=l,a=e.heap_len>>1;a>=1;a--)xa(e,n,a);c=i;do a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],xa(e,n,1),s=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=s,n[c*2]=n[a*2]+n[s*2],e.depth[c]=(e.depth[a]>=e.depth[s]?e.depth[a]:e.depth[s])+1,n[a*2+1]=n[s*2+1]=c,e.heap[1]=c++,xa(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Eh(e,t),hc(n,l,e.bl_count)}function tc(e,t,n){var r,o=-1,i,a=t[0*2+1],s=0,l=7,c=4;for(a===0&&(l=138,c=3),t[(n+1)*2+1]=65535,r=0;r<=n;r++)i=a,a=t[(r+1)*2+1],!(++s<l&&i===a)&&(s<c?e.bl_tree[i*2]+=s:i!==0?(i!==o&&e.bl_tree[i*2]++,e.bl_tree[ac*2]++):s<=10?e.bl_tree[sc*2]++:e.bl_tree[lc*2]++,s=0,o=i,a===0?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4))}function nc(e,t,n){var r,o=-1,i,a=t[0*2+1],s=0,l=7,c=4;for(a===0&&(l=138,c=3),r=0;r<=n;r++)if(i=a,a=t[(r+1)*2+1],!(++s<l&&i===a)){if(s<c)do mt(e,i,e.bl_tree);while(--s!==0);else i!==0?(i!==o&&(mt(e,i,e.bl_tree),s--),mt(e,ac,e.bl_tree),Ie(e,s-3,2)):s<=10?(mt(e,sc,e.bl_tree),Ie(e,s-3,3)):(mt(e,lc,e.bl_tree),Ie(e,s-11,7));s=0,o=i,a===0?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4)}}function wh(e){var t;for(tc(e,e.dyn_ltree,e.l_desc.max_code),tc(e,e.dyn_dtree,e.d_desc.max_code),ba(e,e.bl_desc),t=va-1;t>=3&&e.bl_tree[cc[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t}function bh(e,t,n,r){var o;for(Ie(e,t-257,5),Ie(e,n-1,5),Ie(e,r-4,4),o=0;o<r;o++)Ie(e,e.bl_tree[cc[o]*2+1],3);nc(e,e.dyn_ltree,t-1),nc(e,e.dyn_dtree,n-1)}function yh(e){var t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return ql;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Jl;for(n=32;n<Or;n++)if(e.dyn_ltree[n*2]!==0)return Jl;return ql}var rc=!1;function vh(e){rc||(gh(),rc=!0),e.l_desc=new ga(e.dyn_ltree,dc),e.d_desc=new ga(e.dyn_dtree,uc),e.bl_desc=new ga(e.bl_tree,fc),e.bi_buf=0,e.bi_valid=0,Ec(e)}function xc(e,t,n,r){Ie(e,(lh<<1)+(r?1:0),3),xh(e,t,n,!0)}function Th(e){Ie(e,oc<<1,3),mt(e,Ta,Lt),hh(e)}function Ah(e,t,n,r){var o,i,a=0;e.level>0?(e.strm.data_type===sh&&(e.strm.data_type=yh(e)),ba(e,e.l_desc),ba(e,e.d_desc),a=wh(e),o=e.opt_len+3+7>>>3,i=e.static_len+3+7>>>3,i<=o&&(o=i)):o=i=n+5,n+4<=o&&t!==-1?xc(e,t,n,r):e.strategy===ah||i===o?(Ie(e,(oc<<1)+(r?1:0),3),ec(e,Lt,Mr)):(Ie(e,(ch<<1)+(r?1:0),3),bh(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),ec(e,e.dyn_ltree,e.dyn_dtree)),Ec(e),r&&gc(e)}function Sh(e,t,n){return e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255,e.pending_buf[e.l_buf+e.last_lit]=n&255,e.last_lit++,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(Lr[n]+Or+1)*2]++,e.dyn_dtree[mc(t)*2]++),e.last_lit===e.lit_bufsize-1}Zn._tr_init=vh;Zn._tr_stored_block=xc;Zn._tr_flush_block=Ah;Zn._tr_tally=Sh;Zn._tr_align=Th});var Sa=re((pb,bc)=>{"use strict";g();function _h(e,t,n,r){for(var o=e&65535|0,i=e>>>16&65535|0,a=0;n!==0;){a=n>2e3?2e3:n,n-=a;do o=o+t[r++]|0,i=i+o|0;while(--a);o%=65521,i%=65521}return o|i<<16|0}bc.exports=_h});var _a=re((Eb,yc)=>{"use strict";g();function Ih(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t}var Ph=Ih();function Mh(e,t,n,r){var o=Ph,i=r+n;e^=-1;for(var a=r;a<i;a++)e=e>>>8^o[(e^t[a])&255];return e^-1}yc.exports=Mh});var Fo=re((xb,vc)=>{"use strict";g();vc.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var Cc=re(Et=>{"use strict";g();var Ae=Ct(),ze=wc(),_c=Sa(),Jt=_a(),Dh=Fo(),Tn=0,Ch=1,Lh=3,rn=4,Tc=5,ht=0,Ac=1,He=-2,kh=-3,Ia=-5,Oh=-1,Rh=1,No=2,Fh=3,Nh=4,Bh=0,Gh=2,Ho=8,zh=9,Hh=15,Uh=8,Vh=29,$h=256,Ma=$h+1+Vh,Yh=30,Wh=19,Xh=2*Ma+1,Zh=15,W=3,tn=258,Ze=tn+W+1,Kh=32,Uo=42,Da=69,Bo=73,Go=91,zo=103,bn=113,Fr=666,me=1,Nr=2,yn=3,qn=4,jh=3;function nn(e,t){return e.msg=Dh[t],t}function Sc(e){return(e<<1)-(e>4?9:0)}function en(e){for(var t=e.length;--t>=0;)e[t]=0}function Qt(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(Ae.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))}function we(e,t){ze._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Qt(e.strm)}function Z(e,t){e.pending_buf[e.pending++]=t}function Rr(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255}function qh(e,t,n,r){var o=e.avail_in;return o>r&&(o=r),o===0?0:(e.avail_in-=o,Ae.arraySet(t,e.input,e.next_in,o,n),e.state.wrap===1?e.adler=_c(e.adler,t,o,n):e.state.wrap===2&&(e.adler=Jt(e.adler,t,o,n)),e.next_in+=o,e.total_in+=o,o)}function Ic(e,t){var n=e.max_chain_length,r=e.strstart,o,i,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-Ze?e.strstart-(e.w_size-Ze):0,c=e.window,d=e.w_mask,u=e.prev,f=e.strstart+tn,m=c[r+a-1],p=c[r+a];e.prev_length>=e.good_match&&(n>>=2),s>e.lookahead&&(s=e.lookahead);do if(o=t,!(c[o+a]!==p||c[o+a-1]!==m||c[o]!==c[r]||c[++o]!==c[r+1])){r+=2,o++;do;while(c[++r]===c[++o]&&c[++r]===c[++o]&&c[++r]===c[++o]&&c[++r]===c[++o]&&c[++r]===c[++o]&&c[++r]===c[++o]&&c[++r]===c[++o]&&c[++r]===c[++o]&&r<f);if(i=tn-(f-r),r=f-tn,i>a){if(e.match_start=t,a=i,i>=s)break;m=c[r+a-1],p=c[r+a]}}while((t=u[t&d])>l&&--n!==0);return a<=e.lookahead?a:e.lookahead}function vn(e){var t=e.w_size,n,r,o,i,a;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Ze)){Ae.arraySet(e.window,e.window,t,t,0),e.match_start-=t,e.strstart-=t,e.block_start-=t,r=e.hash_size,n=r;do o=e.head[--n],e.head[n]=o>=t?o-t:0;while(--r);r=t,n=r;do o=e.prev[--n],e.prev[n]=o>=t?o-t:0;while(--r);i+=t}if(e.strm.avail_in===0)break;if(r=qh(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=W)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+W-1])&e.hash_mask,e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<W)););}while(e.lookahead<Ze&&e.strm.avail_in!==0)}function Jh(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(vn(e),e.lookahead===0&&t===Tn)return me;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((e.strstart===0||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,we(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-Ze&&(we(e,!1),e.strm.avail_out===0))return me}return e.insert=0,t===rn?(we(e,!0),e.strm.avail_out===0?yn:qn):(e.strstart>e.block_start&&(we(e,!1),e.strm.avail_out===0),me)}function Pa(e,t){for(var n,r;;){if(e.lookahead<Ze){if(vn(e),e.lookahead<Ze&&t===Tn)return me;if(e.lookahead===0)break}if(n=0,e.lookahead>=W&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+W-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-Ze&&(e.match_length=Ic(e,n)),e.match_length>=W)if(r=ze._tr_tally(e,e.strstart-e.match_start,e.match_length-W),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=W){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+W-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=ze._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(we(e,!1),e.strm.avail_out===0))return me}return e.insert=e.strstart<W-1?e.strstart:W-1,t===rn?(we(e,!0),e.strm.avail_out===0?yn:qn):e.last_lit&&(we(e,!1),e.strm.avail_out===0)?me:Nr}function Kn(e,t){for(var n,r,o;;){if(e.lookahead<Ze){if(vn(e),e.lookahead<Ze&&t===Tn)return me;if(e.lookahead===0)break}if(n=0,e.lookahead>=W&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+W-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=W-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Ze&&(e.match_length=Ic(e,n),e.match_length<=5&&(e.strategy===Rh||e.match_length===W&&e.strstart-e.match_start>4096)&&(e.match_length=W-1)),e.prev_length>=W&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-W,r=ze._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-W),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=o&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+W-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=W-1,e.strstart++,r&&(we(e,!1),e.strm.avail_out===0))return me}else if(e.match_available){if(r=ze._tr_tally(e,0,e.window[e.strstart-1]),r&&we(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return me}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=ze._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<W-1?e.strstart:W-1,t===rn?(we(e,!0),e.strm.avail_out===0?yn:qn):e.last_lit&&(we(e,!1),e.strm.avail_out===0)?me:Nr}function Qh(e,t){for(var n,r,o,i,a=e.window;;){if(e.lookahead<=tn){if(vn(e),e.lookahead<=tn&&t===Tn)return me;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=W&&e.strstart>0&&(o=e.strstart-1,r=a[o],r===a[++o]&&r===a[++o]&&r===a[++o])){i=e.strstart+tn;do;while(r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&o<i);e.match_length=tn-(i-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=W?(n=ze._tr_tally(e,1,e.match_length-W),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=ze._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(we(e,!1),e.strm.avail_out===0))return me}return e.insert=0,t===rn?(we(e,!0),e.strm.avail_out===0?yn:qn):e.last_lit&&(we(e,!1),e.strm.avail_out===0)?me:Nr}function eE(e,t){for(var n;;){if(e.lookahead===0&&(vn(e),e.lookahead===0)){if(t===Tn)return me;break}if(e.match_length=0,n=ze._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(we(e,!1),e.strm.avail_out===0))return me}return e.insert=0,t===rn?(we(e,!0),e.strm.avail_out===0?yn:qn):e.last_lit&&(we(e,!1),e.strm.avail_out===0)?me:Nr}function pt(e,t,n,r,o){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=o}var jn;jn=[new pt(0,0,0,0,Jh),new pt(4,4,8,4,Pa),new pt(4,5,16,8,Pa),new pt(4,6,32,32,Pa),new pt(4,4,16,16,Kn),new pt(8,16,32,32,Kn),new pt(8,16,128,128,Kn),new pt(8,32,128,256,Kn),new pt(32,128,258,1024,Kn),new pt(32,258,258,4096,Kn)];function tE(e){e.window_size=2*e.w_size,en(e.head),e.max_lazy_match=jn[e.level].max_lazy,e.good_match=jn[e.level].good_length,e.nice_match=jn[e.level].nice_length,e.max_chain_length=jn[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=W-1,e.match_available=0,e.ins_h=0}function nE(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ho,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Ae.Buf16(Xh*2),this.dyn_dtree=new Ae.Buf16((2*Yh+1)*2),this.bl_tree=new Ae.Buf16((2*Wh+1)*2),en(this.dyn_ltree),en(this.dyn_dtree),en(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Ae.Buf16(Zh+1),this.heap=new Ae.Buf16(2*Ma+1),en(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Ae.Buf16(2*Ma+1),en(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Pc(e){var t;return!e||!e.state?nn(e,He):(e.total_in=e.total_out=0,e.data_type=Gh,t=e.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?Uo:bn,e.adler=t.wrap===2?0:1,t.last_flush=Tn,ze._tr_init(t),ht)}function Mc(e){var t=Pc(e);return t===ht&&tE(e.state),t}function rE(e,t){return!e||!e.state||e.state.wrap!==2?He:(e.state.gzhead=t,ht)}function Dc(e,t,n,r,o,i){if(!e)return He;var a=1;if(t===Oh&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),o<1||o>zh||n!==Ho||r<8||r>15||t<0||t>9||i<0||i>Nh)return nn(e,He);r===8&&(r=9);var s=new nE;return e.state=s,s.strm=e,s.wrap=a,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=o+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+W-1)/W),s.window=new Ae.Buf8(s.w_size*2),s.head=new Ae.Buf16(s.hash_size),s.prev=new Ae.Buf16(s.w_size),s.lit_bufsize=1<<o+6,s.pending_buf_size=s.lit_bufsize*4,s.pending_buf=new Ae.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=i,s.method=n,Mc(e)}function oE(e,t){return Dc(e,t,Ho,Hh,Uh,Bh)}function iE(e,t){var n,r,o,i;if(!e||!e.state||t>Tc||t<0)return e?nn(e,He):He;if(r=e.state,!e.output||!e.input&&e.avail_in!==0||r.status===Fr&&t!==rn)return nn(e,e.avail_out===0?Ia:He);if(r.strm=e,n=r.last_flush,r.last_flush=t,r.status===Uo)if(r.wrap===2)e.adler=0,Z(r,31),Z(r,139),Z(r,8),r.gzhead?(Z(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Z(r,r.gzhead.time&255),Z(r,r.gzhead.time>>8&255),Z(r,r.gzhead.time>>16&255),Z(r,r.gzhead.time>>24&255),Z(r,r.level===9?2:r.strategy>=No||r.level<2?4:0),Z(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(Z(r,r.gzhead.extra.length&255),Z(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Jt(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Da):(Z(r,0),Z(r,0),Z(r,0),Z(r,0),Z(r,0),Z(r,r.level===9?2:r.strategy>=No||r.level<2?4:0),Z(r,jh),r.status=bn);else{var a=Ho+(r.w_bits-8<<4)<<8,s=-1;r.strategy>=No||r.level<2?s=0:r.level<6?s=1:r.level===6?s=2:s=3,a|=s<<6,r.strstart!==0&&(a|=Kh),a+=31-a%31,r.status=bn,Rr(r,a),r.strstart!==0&&(Rr(r,e.adler>>>16),Rr(r,e.adler&65535)),e.adler=1}if(r.status===Da)if(r.gzhead.extra){for(o=r.pending;r.gzindex<(r.gzhead.extra.length&65535)&&!(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(e.adler=Jt(e.adler,r.pending_buf,r.pending-o,o)),Qt(e),o=r.pending,r.pending===r.pending_buf_size));)Z(r,r.gzhead.extra[r.gzindex]&255),r.gzindex++;r.gzhead.hcrc&&r.pending>o&&(e.adler=Jt(e.adler,r.pending_buf,r.pending-o,o)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=Bo)}else r.status=Bo;if(r.status===Bo)if(r.gzhead.name){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(e.adler=Jt(e.adler,r.pending_buf,r.pending-o,o)),Qt(e),o=r.pending,r.pending===r.pending_buf_size)){i=1;break}r.gzindex<r.gzhead.name.length?i=r.gzhead.name.charCodeAt(r.gzindex++)&255:i=0,Z(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>o&&(e.adler=Jt(e.adler,r.pending_buf,r.pending-o,o)),i===0&&(r.gzindex=0,r.status=Go)}else r.status=Go;if(r.status===Go)if(r.gzhead.comment){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(e.adler=Jt(e.adler,r.pending_buf,r.pending-o,o)),Qt(e),o=r.pending,r.pending===r.pending_buf_size)){i=1;break}r.gzindex<r.gzhead.comment.length?i=r.gzhead.comment.charCodeAt(r.gzindex++)&255:i=0,Z(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>o&&(e.adler=Jt(e.adler,r.pending_buf,r.pending-o,o)),i===0&&(r.status=zo)}else r.status=zo;if(r.status===zo&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&Qt(e),r.pending+2<=r.pending_buf_size&&(Z(r,e.adler&255),Z(r,e.adler>>8&255),e.adler=0,r.status=bn)):r.status=bn),r.pending!==0){if(Qt(e),e.avail_out===0)return r.last_flush=-1,ht}else if(e.avail_in===0&&Sc(t)<=Sc(n)&&t!==rn)return nn(e,Ia);if(r.status===Fr&&e.avail_in!==0)return nn(e,Ia);if(e.avail_in!==0||r.lookahead!==0||t!==Tn&&r.status!==Fr){var l=r.strategy===No?eE(r,t):r.strategy===Fh?Qh(r,t):jn[r.level].func(r,t);if((l===yn||l===qn)&&(r.status=Fr),l===me||l===yn)return e.avail_out===0&&(r.last_flush=-1),ht;if(l===Nr&&(t===Ch?ze._tr_align(r):t!==Tc&&(ze._tr_stored_block(r,0,0,!1),t===Lh&&(en(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),Qt(e),e.avail_out===0))return r.last_flush=-1,ht}return t!==rn?ht:r.wrap<=0?Ac:(r.wrap===2?(Z(r,e.adler&255),Z(r,e.adler>>8&255),Z(r,e.adler>>16&255),Z(r,e.adler>>24&255),Z(r,e.total_in&255),Z(r,e.total_in>>8&255),Z(r,e.total_in>>16&255),Z(r,e.total_in>>24&255)):(Rr(r,e.adler>>>16),Rr(r,e.adler&65535)),Qt(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?ht:Ac)}function aE(e){var t;return!e||!e.state?He:(t=e.state.status,t!==Uo&&t!==Da&&t!==Bo&&t!==Go&&t!==zo&&t!==bn&&t!==Fr?nn(e,He):(e.state=null,t===bn?nn(e,kh):ht))}function sE(e,t){var n=t.length,r,o,i,a,s,l,c,d;if(!e||!e.state||(r=e.state,a=r.wrap,a===2||a===1&&r.status!==Uo||r.lookahead))return He;for(a===1&&(e.adler=_c(e.adler,t,n,0)),r.wrap=0,n>=r.w_size&&(a===0&&(en(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new Ae.Buf8(r.w_size),Ae.arraySet(d,t,n-r.w_size,r.w_size,0),t=d,n=r.w_size),s=e.avail_in,l=e.next_in,c=e.input,e.avail_in=n,e.next_in=0,e.input=t,vn(r);r.lookahead>=W;){o=r.strstart,i=r.lookahead-(W-1);do r.ins_h=(r.ins_h<<r.hash_shift^r.window[o+W-1])&r.hash_mask,r.prev[o&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=o,o++;while(--i);r.strstart=o,r.lookahead=W-1,vn(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=W-1,r.match_available=0,e.next_in=l,e.input=c,e.avail_in=s,r.wrap=a,ht}Et.deflateInit=oE;Et.deflateInit2=Dc;Et.deflateReset=Mc;Et.deflateResetKeep=Pc;Et.deflateSetHeader=rE;Et.deflate=iE;Et.deflateEnd=aE;Et.deflateSetDictionary=sE;Et.deflateInfo="pako deflate (from Nodeca project)"});var Ca=re(Jn=>{"use strict";g();var Vo=Ct(),Lc=!0,kc=!0;try{String.fromCharCode.apply(null,[0])}catch{Lc=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{kc=!1}var Br=new Vo.Buf8(256);for(kt=0;kt<256;kt++)Br[kt]=kt>=252?6:kt>=248?5:kt>=240?4:kt>=224?3:kt>=192?2:1;var kt;Br[254]=Br[254]=1;Jn.string2buf=function(e){var t,n,r,o,i,a=e.length,s=0;for(o=0;o<a;o++)n=e.charCodeAt(o),(n&64512)===55296&&o+1<a&&(r=e.charCodeAt(o+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),o++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Vo.Buf8(s),i=0,o=0;i<s;o++)n=e.charCodeAt(o),(n&64512)===55296&&o+1<a&&(r=e.charCodeAt(o+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),o++)),n<128?t[i++]=n:n<2048?(t[i++]=192|n>>>6,t[i++]=128|n&63):n<65536?(t[i++]=224|n>>>12,t[i++]=128|n>>>6&63,t[i++]=128|n&63):(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63,t[i++]=128|n>>>6&63,t[i++]=128|n&63);return t};function Oc(e,t){if(t<65534&&(e.subarray&&kc||!e.subarray&&Lc))return String.fromCharCode.apply(null,Vo.shrinkBuf(e,t));for(var n="",r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n}Jn.buf2binstring=function(e){return Oc(e,e.length)};Jn.binstring2buf=function(e){for(var t=new Vo.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t};Jn.buf2string=function(e,t){var n,r,o,i,a=t||e.length,s=new Array(a*2);for(r=0,n=0;n<a;){if(o=e[n++],o<128){s[r++]=o;continue}if(i=Br[o],i>4){s[r++]=65533,n+=i-1;continue}for(o&=i===2?31:i===3?15:7;i>1&&n<a;)o=o<<6|e[n++]&63,i--;if(i>1){s[r++]=65533;continue}o<65536?s[r++]=o:(o-=65536,s[r++]=55296|o>>10&1023,s[r++]=56320|o&1023)}return Oc(s,r)};Jn.utf8border=function(e,t){var n;for(t=t||e.length,t>e.length&&(t=e.length),n=t-1;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+Br[e[n]]>t?n:t}});var La=re((Ab,Rc)=>{"use strict";g();function lE(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}Rc.exports=lE});var Gc=re(Hr=>{"use strict";g();var Gr=Cc(),zr=Ct(),Oa=Ca(),Ra=Fo(),cE=La(),Bc=Object.prototype.toString,dE=0,ka=4,Qn=0,Fc=1,Nc=2,uE=-1,fE=0,mE=8;function An(e){if(!(this instanceof An))return new An(e);this.options=zr.assign({level:uE,method:mE,chunkSize:16384,windowBits:15,memLevel:8,strategy:fE,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new cE,this.strm.avail_out=0;var n=Gr.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Qn)throw new Error(Ra[n]);if(t.header&&Gr.deflateSetHeader(this.strm,t.header),t.dictionary){var r;if(typeof t.dictionary=="string"?r=Oa.string2buf(t.dictionary):Bc.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,n=Gr.deflateSetDictionary(this.strm,r),n!==Qn)throw new Error(Ra[n]);this._dict_set=!0}}An.prototype.push=function(e,t){var n=this.strm,r=this.options.chunkSize,o,i;if(this.ended)return!1;i=t===~~t?t:t===!0?ka:dE,typeof e=="string"?n.input=Oa.string2buf(e):Bc.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;do{if(n.avail_out===0&&(n.output=new zr.Buf8(r),n.next_out=0,n.avail_out=r),o=Gr.deflate(n,i),o!==Fc&&o!==Qn)return this.onEnd(o),this.ended=!0,!1;(n.avail_out===0||n.avail_in===0&&(i===ka||i===Nc))&&(this.options.to==="string"?this.onData(Oa.buf2binstring(zr.shrinkBuf(n.output,n.next_out))):this.onData(zr.shrinkBuf(n.output,n.next_out)))}while((n.avail_in>0||n.avail_out===0)&&o!==Fc);return i===ka?(o=Gr.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===Qn):(i===Nc&&(this.onEnd(Qn),n.avail_out=0),!0)};An.prototype.onData=function(e){this.chunks.push(e)};An.prototype.onEnd=function(e){e===Qn&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=zr.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Fa(e,t){var n=new An(t);if(n.push(e,!0),n.err)throw n.msg||Ra[n.err];return n.result}function pE(e,t){return t=t||{},t.raw=!0,Fa(e,t)}function hE(e,t){return t=t||{},t.gzip=!0,Fa(e,t)}Hr.Deflate=An;Hr.deflate=Fa;Hr.deflateRaw=pE;Hr.gzip=hE});var Hc=re((Pb,zc)=>{"use strict";g();var $o=30,EE=12;zc.exports=function(t,n){var r,o,i,a,s,l,c,d,u,f,m,p,h,E,x,w,v,T,b,D,A,S,I,P,_;r=t.state,o=t.next_in,P=t.input,i=o+(t.avail_in-5),a=t.next_out,_=t.output,s=a-(n-t.avail_out),l=a+(t.avail_out-257),c=r.dmax,d=r.wsize,u=r.whave,f=r.wnext,m=r.window,p=r.hold,h=r.bits,E=r.lencode,x=r.distcode,w=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;e:do{h<15&&(p+=P[o++]<<h,h+=8,p+=P[o++]<<h,h+=8),T=E[p&w];t:for(;;){if(b=T>>>24,p>>>=b,h-=b,b=T>>>16&255,b===0)_[a++]=T&65535;else if(b&16){D=T&65535,b&=15,b&&(h<b&&(p+=P[o++]<<h,h+=8),D+=p&(1<<b)-1,p>>>=b,h-=b),h<15&&(p+=P[o++]<<h,h+=8,p+=P[o++]<<h,h+=8),T=x[p&v];n:for(;;){if(b=T>>>24,p>>>=b,h-=b,b=T>>>16&255,b&16){if(A=T&65535,b&=15,h<b&&(p+=P[o++]<<h,h+=8,h<b&&(p+=P[o++]<<h,h+=8)),A+=p&(1<<b)-1,A>c){t.msg="invalid distance too far back",r.mode=$o;break e}if(p>>>=b,h-=b,b=a-s,A>b){if(b=A-b,b>u&&r.sane){t.msg="invalid distance too far back",r.mode=$o;break e}if(S=0,I=m,f===0){if(S+=d-b,b<D){D-=b;do _[a++]=m[S++];while(--b);S=a-A,I=_}}else if(f<b){if(S+=d+f-b,b-=f,b<D){D-=b;do _[a++]=m[S++];while(--b);if(S=0,f<D){b=f,D-=b;do _[a++]=m[S++];while(--b);S=a-A,I=_}}}else if(S+=f-b,b<D){D-=b;do _[a++]=m[S++];while(--b);S=a-A,I=_}for(;D>2;)_[a++]=I[S++],_[a++]=I[S++],_[a++]=I[S++],D-=3;D&&(_[a++]=I[S++],D>1&&(_[a++]=I[S++]))}else{S=a-A;do _[a++]=_[S++],_[a++]=_[S++],_[a++]=_[S++],D-=3;while(D>2);D&&(_[a++]=_[S++],D>1&&(_[a++]=_[S++]))}}else if(b&64){t.msg="invalid distance code",r.mode=$o;break e}else{T=x[(T&65535)+(p&(1<<b)-1)];continue n}break}}else if(b&64)if(b&32){r.mode=EE;break e}else{t.msg="invalid literal/length code",r.mode=$o;break e}else{T=E[(T&65535)+(p&(1<<b)-1)];continue t}break}}while(o<i&&a<l);D=h>>3,o-=D,h-=D<<3,p&=(1<<h)-1,t.next_in=o,t.next_out=a,t.avail_in=o<i?5+(i-o):5-(o-i),t.avail_out=a<l?257+(l-a):257-(a-l),r.hold=p,r.bits=h}});var Zc=re((Db,Xc)=>{"use strict";g();var Uc=Ct(),er=15,Vc=852,$c=592,Yc=0,Na=1,Wc=2,gE=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],xE=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],wE=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],bE=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Xc.exports=function(t,n,r,o,i,a,s,l){var c=l.bits,d=0,u=0,f=0,m=0,p=0,h=0,E=0,x=0,w=0,v=0,T,b,D,A,S,I=null,P=0,_,M=new Uc.Buf16(er+1),k=new Uc.Buf16(er+1),U=null,G=0,B,L,C;for(d=0;d<=er;d++)M[d]=0;for(u=0;u<o;u++)M[n[r+u]]++;for(p=c,m=er;m>=1&&M[m]===0;m--);if(p>m&&(p=m),m===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<m&&M[f]===0;f++);for(p<f&&(p=f),x=1,d=1;d<=er;d++)if(x<<=1,x-=M[d],x<0)return-1;if(x>0&&(t===Yc||m!==1))return-1;for(k[1]=0,d=1;d<er;d++)k[d+1]=k[d]+M[d];for(u=0;u<o;u++)n[r+u]!==0&&(s[k[n[r+u]]++]=u);if(t===Yc?(I=U=s,_=19):t===Na?(I=gE,P-=257,U=xE,G-=257,_=256):(I=wE,U=bE,_=-1),v=0,u=0,d=f,S=a,h=p,E=0,D=-1,w=1<<p,A=w-1,t===Na&&w>Vc||t===Wc&&w>$c)return 1;for(;;){B=d-E,s[u]<_?(L=0,C=s[u]):s[u]>_?(L=U[G+s[u]],C=I[P+s[u]]):(L=96,C=0),T=1<<d-E,b=1<<h,f=b;do b-=T,i[S+(v>>E)+b]=B<<24|L<<16|C|0;while(b!==0);for(T=1<<d-1;v&T;)T>>=1;if(T!==0?(v&=T-1,v+=T):v=0,u++,--M[d]===0){if(d===m)break;d=n[r+s[u]]}if(d>p&&(v&A)!==D){for(E===0&&(E=p),S+=f,h=d-E,x=1<<h;h+E<m&&(x-=M[h+E],!(x<=0));)h++,x<<=1;if(w+=1<<h,t===Na&&w>Vc||t===Wc&&w>$c)return 1;D=v&A,i[D]=p<<24|h<<16|S-a|0}}return v!==0&&(i[S+v]=d-E<<24|64<<16|0),l.bits=p,0}});var Md=re(Ke=>{"use strict";g();var Le=Ct(),Va=Sa(),gt=_a(),yE=Hc(),Ur=Zc(),vE=0,bd=1,yd=2,Kc=4,TE=5,Yo=6,Sn=0,AE=1,SE=2,Ue=-2,vd=-3,$a=-4,_E=-5,jc=8,Td=1,qc=2,Jc=3,Qc=4,ed=5,td=6,nd=7,rd=8,od=9,id=10,Zo=11,Ot=12,Ba=13,ad=14,Ga=15,sd=16,ld=17,cd=18,dd=19,Wo=20,Xo=21,ud=22,fd=23,md=24,pd=25,hd=26,za=27,Ed=28,gd=29,oe=30,Ya=31,IE=32,PE=852,ME=592,DE=15,CE=DE;function xd(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function LE(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Le.Buf16(320),this.work=new Le.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Ad(e){var t;return!e||!e.state?Ue:(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Td,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Le.Buf32(PE),t.distcode=t.distdyn=new Le.Buf32(ME),t.sane=1,t.back=-1,Sn)}function Sd(e){var t;return!e||!e.state?Ue:(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,Ad(e))}function _d(e,t){var n,r;return!e||!e.state||(r=e.state,t<0?(n=0,t=-t):(n=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15))?Ue:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,Sd(e))}function Id(e,t){var n,r;return e?(r=new LE,e.state=r,r.window=null,n=_d(e,t),n!==Sn&&(e.state=null),n):Ue}function kE(e){return Id(e,CE)}var wd=!0,Ha,Ua;function OE(e){if(wd){var t;for(Ha=new Le.Buf32(512),Ua=new Le.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ur(bd,e.lens,0,288,Ha,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ur(yd,e.lens,0,32,Ua,0,e.work,{bits:5}),wd=!1}e.lencode=Ha,e.lenbits=9,e.distcode=Ua,e.distbits=5}function Pd(e,t,n,r){var o,i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Le.Buf8(i.wsize)),r>=i.wsize?(Le.arraySet(i.window,t,n-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):(o=i.wsize-i.wnext,o>r&&(o=r),Le.arraySet(i.window,t,n-r,o,i.wnext),r-=o,r?(Le.arraySet(i.window,t,n-r,r,0),i.wnext=r,i.whave=i.wsize):(i.wnext+=o,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=o))),0}function RE(e,t){var n,r,o,i,a,s,l,c,d,u,f,m,p,h,E=0,x,w,v,T,b,D,A,S,I=new Le.Buf8(4),P,_,M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return Ue;n=e.state,n.mode===Ot&&(n.mode=Ba),a=e.next_out,o=e.output,l=e.avail_out,i=e.next_in,r=e.input,s=e.avail_in,c=n.hold,d=n.bits,u=s,f=l,S=Sn;e:for(;;)switch(n.mode){case Td:if(n.wrap===0){n.mode=Ba;break}for(;d<16;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}if(n.wrap&2&&c===35615){n.check=0,I[0]=c&255,I[1]=c>>>8&255,n.check=gt(n.check,I,2,0),c=0,d=0,n.mode=qc;break}if(n.flags=0,n.head&&(n.head.done=!1),!(n.wrap&1)||(((c&255)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=oe;break}if((c&15)!==jc){e.msg="unknown compression method",n.mode=oe;break}if(c>>>=4,d-=4,A=(c&15)+8,n.wbits===0)n.wbits=A;else if(A>n.wbits){e.msg="invalid window size",n.mode=oe;break}n.dmax=1<<A,e.adler=n.check=1,n.mode=c&512?id:Ot,c=0,d=0;break;case qc:for(;d<16;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}if(n.flags=c,(n.flags&255)!==jc){e.msg="unknown compression method",n.mode=oe;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=oe;break}n.head&&(n.head.text=c>>8&1),n.flags&512&&(I[0]=c&255,I[1]=c>>>8&255,n.check=gt(n.check,I,2,0)),c=0,d=0,n.mode=Jc;case Jc:for(;d<32;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}n.head&&(n.head.time=c),n.flags&512&&(I[0]=c&255,I[1]=c>>>8&255,I[2]=c>>>16&255,I[3]=c>>>24&255,n.check=gt(n.check,I,4,0)),c=0,d=0,n.mode=Qc;case Qc:for(;d<16;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}n.head&&(n.head.xflags=c&255,n.head.os=c>>8),n.flags&512&&(I[0]=c&255,I[1]=c>>>8&255,n.check=gt(n.check,I,2,0)),c=0,d=0,n.mode=ed;case ed:if(n.flags&1024){for(;d<16;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}n.length=c,n.head&&(n.head.extra_len=c),n.flags&512&&(I[0]=c&255,I[1]=c>>>8&255,n.check=gt(n.check,I,2,0)),c=0,d=0}else n.head&&(n.head.extra=null);n.mode=td;case td:if(n.flags&1024&&(m=n.length,m>s&&(m=s),m&&(n.head&&(A=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),Le.arraySet(n.head.extra,r,i,m,A)),n.flags&512&&(n.check=gt(n.check,r,m,i)),s-=m,i+=m,n.length-=m),n.length))break e;n.length=0,n.mode=nd;case nd:if(n.flags&2048){if(s===0)break e;m=0;do A=r[i+m++],n.head&&A&&n.length<65536&&(n.head.name+=String.fromCharCode(A));while(A&&m<s);if(n.flags&512&&(n.check=gt(n.check,r,m,i)),s-=m,i+=m,A)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=rd;case rd:if(n.flags&4096){if(s===0)break e;m=0;do A=r[i+m++],n.head&&A&&n.length<65536&&(n.head.comment+=String.fromCharCode(A));while(A&&m<s);if(n.flags&512&&(n.check=gt(n.check,r,m,i)),s-=m,i+=m,A)break e}else n.head&&(n.head.comment=null);n.mode=od;case od:if(n.flags&512){for(;d<16;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}if(c!==(n.check&65535)){e.msg="header crc mismatch",n.mode=oe;break}c=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Ot;break;case id:for(;d<32;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}e.adler=n.check=xd(c),c=0,d=0,n.mode=Zo;case Zo:if(n.havedict===0)return e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=d,SE;e.adler=n.check=1,n.mode=Ot;case Ot:if(t===TE||t===Yo)break e;case Ba:if(n.last){c>>>=d&7,d-=d&7,n.mode=za;break}for(;d<3;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}switch(n.last=c&1,c>>>=1,d-=1,c&3){case 0:n.mode=ad;break;case 1:if(OE(n),n.mode=Wo,t===Yo){c>>>=2,d-=2;break e}break;case 2:n.mode=ld;break;case 3:e.msg="invalid block type",n.mode=oe}c>>>=2,d-=2;break;case ad:for(c>>>=d&7,d-=d&7;d<32;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}if((c&65535)!==(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=oe;break}if(n.length=c&65535,c=0,d=0,n.mode=Ga,t===Yo)break e;case Ga:n.mode=sd;case sd:if(m=n.length,m){if(m>s&&(m=s),m>l&&(m=l),m===0)break e;Le.arraySet(o,r,i,m,a),s-=m,i+=m,l-=m,a+=m,n.length-=m;break}n.mode=Ot;break;case ld:for(;d<14;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}if(n.nlen=(c&31)+257,c>>>=5,d-=5,n.ndist=(c&31)+1,c>>>=5,d-=5,n.ncode=(c&15)+4,c>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=oe;break}n.have=0,n.mode=cd;case cd:for(;n.have<n.ncode;){for(;d<3;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}n.lens[M[n.have++]]=c&7,c>>>=3,d-=3}for(;n.have<19;)n.lens[M[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,P={bits:n.lenbits},S=Ur(vE,n.lens,0,19,n.lencode,0,n.work,P),n.lenbits=P.bits,S){e.msg="invalid code lengths set",n.mode=oe;break}n.have=0,n.mode=dd;case dd:for(;n.have<n.nlen+n.ndist;){for(;E=n.lencode[c&(1<<n.lenbits)-1],x=E>>>24,w=E>>>16&255,v=E&65535,!(x<=d);){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}if(v<16)c>>>=x,d-=x,n.lens[n.have++]=v;else{if(v===16){for(_=x+2;d<_;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}if(c>>>=x,d-=x,n.have===0){e.msg="invalid bit length repeat",n.mode=oe;break}A=n.lens[n.have-1],m=3+(c&3),c>>>=2,d-=2}else if(v===17){for(_=x+3;d<_;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}c>>>=x,d-=x,A=0,m=3+(c&7),c>>>=3,d-=3}else{for(_=x+7;d<_;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}c>>>=x,d-=x,A=0,m=11+(c&127),c>>>=7,d-=7}if(n.have+m>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=oe;break}for(;m--;)n.lens[n.have++]=A}}if(n.mode===oe)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=oe;break}if(n.lenbits=9,P={bits:n.lenbits},S=Ur(bd,n.lens,0,n.nlen,n.lencode,0,n.work,P),n.lenbits=P.bits,S){e.msg="invalid literal/lengths set",n.mode=oe;break}if(n.distbits=6,n.distcode=n.distdyn,P={bits:n.distbits},S=Ur(yd,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,P),n.distbits=P.bits,S){e.msg="invalid distances set",n.mode=oe;break}if(n.mode=Wo,t===Yo)break e;case Wo:n.mode=Xo;case Xo:if(s>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=d,yE(e,f),a=e.next_out,o=e.output,l=e.avail_out,i=e.next_in,r=e.input,s=e.avail_in,c=n.hold,d=n.bits,n.mode===Ot&&(n.back=-1);break}for(n.back=0;E=n.lencode[c&(1<<n.lenbits)-1],x=E>>>24,w=E>>>16&255,v=E&65535,!(x<=d);){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}if(w&&!(w&240)){for(T=x,b=w,D=v;E=n.lencode[D+((c&(1<<T+b)-1)>>T)],x=E>>>24,w=E>>>16&255,v=E&65535,!(T+x<=d);){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}c>>>=T,d-=T,n.back+=T}if(c>>>=x,d-=x,n.back+=x,n.length=v,w===0){n.mode=hd;break}if(w&32){n.back=-1,n.mode=Ot;break}if(w&64){e.msg="invalid literal/length code",n.mode=oe;break}n.extra=w&15,n.mode=ud;case ud:if(n.extra){for(_=n.extra;d<_;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=fd;case fd:for(;E=n.distcode[c&(1<<n.distbits)-1],x=E>>>24,w=E>>>16&255,v=E&65535,!(x<=d);){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}if(!(w&240)){for(T=x,b=w,D=v;E=n.distcode[D+((c&(1<<T+b)-1)>>T)],x=E>>>24,w=E>>>16&255,v=E&65535,!(T+x<=d);){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}c>>>=T,d-=T,n.back+=T}if(c>>>=x,d-=x,n.back+=x,w&64){e.msg="invalid distance code",n.mode=oe;break}n.offset=v,n.extra=w&15,n.mode=md;case md:if(n.extra){for(_=n.extra;d<_;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=oe;break}n.mode=pd;case pd:if(l===0)break e;if(m=f-l,n.offset>m){if(m=n.offset-m,m>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=oe;break}m>n.wnext?(m-=n.wnext,p=n.wsize-m):p=n.wnext-m,m>n.length&&(m=n.length),h=n.window}else h=o,p=a-n.offset,m=n.length;m>l&&(m=l),l-=m,n.length-=m;do o[a++]=h[p++];while(--m);n.length===0&&(n.mode=Xo);break;case hd:if(l===0)break e;o[a++]=n.length,l--,n.mode=Xo;break;case za:if(n.wrap){for(;d<32;){if(s===0)break e;s--,c|=r[i++]<<d,d+=8}if(f-=l,e.total_out+=f,n.total+=f,f&&(e.adler=n.check=n.flags?gt(n.check,o,f,a-f):Va(n.check,o,f,a-f)),f=l,(n.flags?c:xd(c))!==n.check){e.msg="incorrect data check",n.mode=oe;break}c=0,d=0}n.mode=Ed;case Ed:if(n.wrap&&n.flags){for(;d<32;){if(s===0)break e;s--,c+=r[i++]<<d,d+=8}if(c!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=oe;break}c=0,d=0}n.mode=gd;case gd:S=AE;break e;case oe:S=vd;break e;case Ya:return $a;case IE:default:return Ue}return e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=d,(n.wsize||f!==e.avail_out&&n.mode<oe&&(n.mode<za||t!==Kc))&&Pd(e,e.output,e.next_out,f-e.avail_out)?(n.mode=Ya,$a):(u-=e.avail_in,f-=e.avail_out,e.total_in+=u,e.total_out+=f,n.total+=f,n.wrap&&f&&(e.adler=n.check=n.flags?gt(n.check,o,f,e.next_out-f):Va(n.check,o,f,e.next_out-f)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Ot?128:0)+(n.mode===Wo||n.mode===Ga?256:0),(u===0&&f===0||t===Kc)&&S===Sn&&(S=_E),S)}function FE(e){if(!e||!e.state)return Ue;var t=e.state;return t.window&&(t.window=null),e.state=null,Sn}function NE(e,t){var n;return!e||!e.state||(n=e.state,!(n.wrap&2))?Ue:(n.head=t,t.done=!1,Sn)}function BE(e,t){var n=t.length,r,o,i;return!e||!e.state||(r=e.state,r.wrap!==0&&r.mode!==Zo)?Ue:r.mode===Zo&&(o=1,o=Va(o,t,n,0),o!==r.check)?vd:(i=Pd(e,t,n,n),i?(r.mode=Ya,$a):(r.havedict=1,Sn))}Ke.inflateReset=Sd;Ke.inflateReset2=_d;Ke.inflateResetKeep=Ad;Ke.inflateInit=kE;Ke.inflateInit2=Id;Ke.inflate=RE;Ke.inflateEnd=FE;Ke.inflateGetHeader=NE;Ke.inflateSetDictionary=BE;Ke.inflateInfo="pako inflate (from Nodeca project)"});var Wa=re((Ob,Dd)=>{"use strict";g();Dd.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var Ld=re((Fb,Cd)=>{"use strict";g();function GE(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}Cd.exports=GE});var Od=re($r=>{"use strict";g();var tr=Md(),Vr=Ct(),Ko=Ca(),ue=Wa(),Xa=Fo(),zE=La(),HE=Ld(),kd=Object.prototype.toString;function _n(e){if(!(this instanceof _n))return new _n(e);this.options=Vr.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zE,this.strm.avail_out=0;var n=tr.inflateInit2(this.strm,t.windowBits);if(n!==ue.Z_OK)throw new Error(Xa[n]);if(this.header=new HE,tr.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Ko.string2buf(t.dictionary):kd.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=tr.inflateSetDictionary(this.strm,t.dictionary),n!==ue.Z_OK)))throw new Error(Xa[n])}_n.prototype.push=function(e,t){var n=this.strm,r=this.options.chunkSize,o=this.options.dictionary,i,a,s,l,c,d=!1;if(this.ended)return!1;a=t===~~t?t:t===!0?ue.Z_FINISH:ue.Z_NO_FLUSH,typeof e=="string"?n.input=Ko.binstring2buf(e):kd.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;do{if(n.avail_out===0&&(n.output=new Vr.Buf8(r),n.next_out=0,n.avail_out=r),i=tr.inflate(n,ue.Z_NO_FLUSH),i===ue.Z_NEED_DICT&&o&&(i=tr.inflateSetDictionary(this.strm,o)),i===ue.Z_BUF_ERROR&&d===!0&&(i=ue.Z_OK,d=!1),i!==ue.Z_STREAM_END&&i!==ue.Z_OK)return this.onEnd(i),this.ended=!0,!1;n.next_out&&(n.avail_out===0||i===ue.Z_STREAM_END||n.avail_in===0&&(a===ue.Z_FINISH||a===ue.Z_SYNC_FLUSH))&&(this.options.to==="string"?(s=Ko.utf8border(n.output,n.next_out),l=n.next_out-s,c=Ko.buf2string(n.output,s),n.next_out=l,n.avail_out=r-l,l&&Vr.arraySet(n.output,n.output,s,l,0),this.onData(c)):this.onData(Vr.shrinkBuf(n.output,n.next_out))),n.avail_in===0&&n.avail_out===0&&(d=!0)}while((n.avail_in>0||n.avail_out===0)&&i!==ue.Z_STREAM_END);return i===ue.Z_STREAM_END&&(a=ue.Z_FINISH),a===ue.Z_FINISH?(i=tr.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===ue.Z_OK):(a===ue.Z_SYNC_FLUSH&&(this.onEnd(ue.Z_OK),n.avail_out=0),!0)};_n.prototype.onData=function(e){this.chunks.push(e)};_n.prototype.onEnd=function(e){e===ue.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Vr.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Za(e,t){var n=new _n(t);if(n.push(e,!0),n.err)throw n.msg||Xa[n.err];return n.result}function UE(e,t){return t=t||{},t.raw=!0,Za(e,t)}$r.Inflate=_n;$r.inflate=Za;$r.inflateRaw=UE;$r.ungzip=Za});var Nd=re((zb,Fd)=>{"use strict";g();var VE=Ct().assign,$E=Gc(),YE=Od(),WE=Wa(),Rd={};VE(Rd,$E,YE,WE);Fd.exports=Rd});var em=re(zi=>{"use strict";g();Object.defineProperty(zi,"__esModule",{value:!0});zi.sanitizeUrl=void 0;var Qx=/^([^\w]*)(javascript|data|vbscript)/im,e0=/&#(\w+)(^\w|;)?/g,t0=/&(newline|tab);/gi,n0=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,r0=/^.+(:|&colon;)/gim,o0=[".","/"];function i0(e){return o0.indexOf(e[0])>-1}function a0(e){return e.replace(e0,function(t,n){return String.fromCharCode(n)})}function s0(e){var t=a0(e||"").replace(t0,"").replace(n0,"").trim();if(!t)return"about:blank";if(i0(t))return t;var n=t.match(r0);if(!n)return t;var r=n[0];return Qx.test(r)?"about:blank":t}zi.sanitizeUrl=s0});g();var Rl=Pr(Hl(),1),Fl=Pr(Wl(),1),Up=Pr(jl(),1);g();var ua=Pr(Nd(),1);g();g();var Ka={};g();var In={white:"#ffffff",black:"#000000",gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]};var KE=(e,t)=>t.reduce((n,r)=>(r in e&&(n[r]=e[r]),n),{}),Yb=5,Wb=5,Bd=4,jo=4,qo=1,je=[0,2,4,6,8];var qe=(e,t)=>t.map(n=>In[e][n]),z={transparent:"transparent",black:"#1e1e1e",white:"#ffffff",gray:qe("gray",je),red:qe("red",je),pink:qe("pink",je),grape:qe("grape",je),violet:qe("violet",je),blue:qe("blue",je),cyan:qe("cyan",je),teal:qe("teal",je),green:qe("green",je),yellow:qe("yellow",je),orange:qe("orange",je),bronze:["#f8f1ee","#eaddd7","#d2bab0","#a18072","#846358"]},Gd=KE(z,["cyan","blue","violet","grape","pink","green","teal","yellow","orange","red"]),Xb=[z.black,z.red[jo],z.green[jo],z.blue[jo],z.yellow[jo]],Zb=[z.transparent,z.red[qo],z.green[qo],z.blue[qo],z.yellow[qo]],Kb=[z.white,"#f8f9fa","#f5faff","#fffce8","#fdf8f6"],jb={transparent:z.transparent,white:z.white,gray:z.gray,black:z.black,bronze:z.bronze,...Gd},qb={transparent:z.transparent,white:z.white,gray:z.gray,black:z.black,bronze:z.bronze,...Gd},zd=e=>[z.cyan[e],z.blue[e],z.violet[e],z.grape[e],z.pink[e],z.green[e],z.teal[e],z.yellow[e],z.orange[e],z.red[e]],Jb=(e,t,n)=>`#${((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1)}`;var Jo=/Mac|iPod|iPhone|iPad/.test(navigator.platform),ry=/^Win/.test(navigator.platform),Hd=/\b(android)\b/i.test(navigator.userAgent),oy="netscape"in window&&navigator.userAgent.indexOf("rv:")>1&&navigator.userAgent.indexOf("Gecko")>1,jE=navigator.userAgent.indexOf("Chrome")!==-1,iy=!jE&&navigator.userAgent.indexOf("Safari")!==-1,Ud=/iPad|iPhone/.test(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,ay=()=>navigator.brave?.isBrave?.name==="isBrave",sy=typeof window<"u"&&"ResizeObserver"in window,ly="Excalidraw",Vd=10,$d=8,cy=5,dy=1,uy=30,xt=Math.PI/12,fy="red",Qo={TEXT:"text",CROSSHAIR:"crosshair",GRABBING:"grabbing",GRAB:"grab",POINTER:"pointer",MOVE:"move",AUTO:""},my={MAIN:0,WHEEL:1,SECONDARY:2,TOUCH:-1,ERASER:5},py={enabled:"all",disabled:"none",inheritFromUI:"var(--ui-pointerEvents)"};var hy={UNSTARTED:-1,ENDED:0,PLAYING:1,PAUSED:2,BUFFERING:3,CUED:5},Je={TEST:"test",DEVELOPMENT:"development"},Ey={SHAPE_ACTIONS_MENU:"App-menu__left"},pe={Virgil:1,Helvetica:2,Cascadia:3,Assistant:4},ke={LIGHT:"light",DARK:"dark"},xe={strokeColor:"#bbb",strokeWidth:2,strokeStyle:"solid",fillStyle:"solid",roughness:0,roundness:null,backgroundColor:"transparent",radius:8,nameOffsetY:3,nameColorLightTheme:"#999999",nameColorDarkTheme:"#7a7a7a",nameFontSize:14,nameLineHeight:1.25},ja="Segoe UI Emoji",ei=1,wt=20,Qe=pe.Virgil,nr="left",ti="top";var Yr=2,ni=2*Yr,qE=1e-5,gy=2*ni-qE,xy="#ffffff",wy="#1e1e1e",by="#a2f1a6";var yy=20,qa={svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",gif:"image/gif",webp:"image/webp",bmp:"image/bmp",ico:"image/x-icon",avif:"image/avif",jfif:"image/jfif"},Yd=["text/plain","text/html"],F={json:"application/json",excalidraw:"application/vnd.excalidraw+json",excalidrawlib:"application/vnd.excalidrawlib+json","excalidraw.svg":"image/svg+xml","excalidraw.png":"image/png",binary:"application/octet-stream",...qa},vy={png:"png",svg:"svg",clipboard:"clipboard"},Pe={excalidraw:"excalidraw",excalidrawClipboard:"excalidraw/clipboard",excalidrawLibrary:"excalidrawlib",excalidrawClipboardWithAPI:"excalidraw-api/clipboard"},Ja=window.EXCALIDRAW_EXPORT_SOURCE||window.location.origin,Ty=500,Ay=300,Sy=500;var _y=100,Iy=.1,Wd=.1,Py=30,My=300;var ri=Ka.themeFilter,Dy={addLibrary:"addLibrary"},Cy={addLibrary:"addLibrary"},Ly={canvasActions:{changeViewBackgroundColor:!0,clearCanvas:!0,export:{saveFileToDisk:!0},loadScene:!0,saveToActiveFile:!0,toggleTheme:null,saveAsImage:!0},tools:{image:!0}},ky=730,Oy=1e3,Ry=500,Fy=1229,Ny=parseInt(Ka.rightSidebarWidth),rr=2,Xd=[1,2,3],Qa=10,By=1440,Gy=2*1024*1024,Q="http://www.w3.org/2000/svg";var es={excalidraw:2,excalidrawLibrary:2},he=5,Zd=.7,Kd=11,Rt={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"},ts={LEFT:"left",CENTER:"center",RIGHT:"right"},jd=20,oi=.25,qd=32,Oe={LEGACY:1,PROPORTIONAL_RADIUS:2,ADAPTIVE_RADIUS:3},ns={architect:0,artist:1,cartoonist:2},zy={thin:1,bold:2,extraBold:4},ne={strokeColor:z.black,backgroundColor:z.transparent,fillStyle:"solid",strokeWidth:2,strokeStyle:"solid",roughness:ns.artist,opacity:100,locked:!1},JE="library",Jd={name:"default",defaultTab:JE},Hy=new Set(["iframe","embeddable","image"]),Uy={selection:"selection",rectangle:"rectangle",diamond:"diamond",ellipse:"ellipse",arrow:"arrow",line:"line",freedraw:"freedraw",text:"text",image:"image",eraser:"eraser",hand:"hand",frame:"frame",magicframe:"magicframe",embeddable:"embeddable",laser:"laser"},Vy={OAI_API_KEY:"excalidraw-oai-api-key",MERMAID_TO_EXCALIDRAW:"mermaid-to-excalidraw",PUBLISH_LIBRARY:"publish-library-data"},Qd="Untitled";g();g();g();var ii=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");g();var QE=Xd.includes(devicePixelRatio)?devicePixelRatio:1,et=()=>({showWelcomeScreen:!1,theme:ke.LIGHT,collaborators:new Map,currentChartType:"bar",currentItemBackgroundColor:ne.backgroundColor,currentItemEndArrowhead:"arrow",currentItemFillStyle:ne.fillStyle,currentItemFontFamily:Qe,currentItemFontSize:wt,currentItemOpacity:ne.opacity,currentItemRoughness:ne.roughness,currentItemStartArrowhead:null,currentItemStrokeColor:ne.strokeColor,currentItemRoundness:"round",currentItemStrokeStyle:ne.strokeStyle,currentItemStrokeWidth:ne.strokeWidth,currentItemTextAlign:nr,cursorButton:"up",activeEmbeddable:null,draggingElement:null,editingElement:null,editingGroupId:null,editingLinearElement:null,activeTool:{type:"selection",customType:null,locked:ne.locked,lastActiveTool:null},penMode:!1,penDetected:!1,errorMessage:null,exportBackground:!0,exportScale:QE,exportEmbedScene:!1,exportWithDarkMode:!1,fileHandle:null,gridSize:null,isBindingEnabled:!0,defaultSidebarDockedPreference:!1,isLoading:!1,isResizing:!1,isRotating:!1,lastPointerDownWith:"mouse",multiElement:null,name:null,contextMenu:null,openMenu:null,openPopup:null,openSidebar:null,openDialog:null,pasteDialog:{shown:!1,data:null},previousSelectedElementIds:{},resizingElement:null,scrolledOutside:!1,scrollX:0,scrollY:0,selectedElementIds:{},selectedGroupIds:{},selectedElementsAreBeingDragged:!1,selectionElement:null,shouldCacheIgnoreZoom:!1,showStats:!1,startBoundElement:null,suggestedBindings:[],frameRendering:{enabled:!0,clip:!0,name:!0,outline:!0},frameToHighlight:null,editingFrame:null,elementsToHighlight:null,toast:null,viewBackgroundColor:z.white,zenModeEnabled:!1,zoom:{value:1},viewModeEnabled:!1,pendingImageElementId:null,showHyperlinkPopup:!1,selectedLinearElement:null,snapLines:[],originSnapOffset:{x:0,y:0},objectsSnapModeEnabled:!1,userToFollow:null,followedBy:new Set}),eg=(e=>e)({showWelcomeScreen:{browser:!0,export:!1,server:!1},theme:{browser:!0,export:!1,server:!1},collaborators:{browser:!1,export:!1,server:!1},currentChartType:{browser:!0,export:!1,server:!1},currentItemBackgroundColor:{browser:!0,export:!1,server:!1},currentItemEndArrowhead:{browser:!0,export:!1,server:!1},currentItemFillStyle:{browser:!0,export:!1,server:!1},currentItemFontFamily:{browser:!0,export:!1,server:!1},currentItemFontSize:{browser:!0,export:!1,server:!1},currentItemRoundness:{browser:!0,export:!1,server:!1},currentItemOpacity:{browser:!0,export:!1,server:!1},currentItemRoughness:{browser:!0,export:!1,server:!1},currentItemStartArrowhead:{browser:!0,export:!1,server:!1},currentItemStrokeColor:{browser:!0,export:!1,server:!1},currentItemStrokeStyle:{browser:!0,export:!1,server:!1},currentItemStrokeWidth:{browser:!0,export:!1,server:!1},currentItemTextAlign:{browser:!0,export:!1,server:!1},cursorButton:{browser:!0,export:!1,server:!1},activeEmbeddable:{browser:!1,export:!1,server:!1},draggingElement:{browser:!1,export:!1,server:!1},editingElement:{browser:!1,export:!1,server:!1},editingGroupId:{browser:!0,export:!1,server:!1},editingLinearElement:{browser:!1,export:!1,server:!1},activeTool:{browser:!0,export:!1,server:!1},penMode:{browser:!0,export:!1,server:!1},penDetected:{browser:!0,export:!1,server:!1},errorMessage:{browser:!1,export:!1,server:!1},exportBackground:{browser:!0,export:!1,server:!1},exportEmbedScene:{browser:!0,export:!1,server:!1},exportScale:{browser:!0,export:!1,server:!1},exportWithDarkMode:{browser:!0,export:!1,server:!1},fileHandle:{browser:!1,export:!1,server:!1},gridSize:{browser:!0,export:!0,server:!0},height:{browser:!1,export:!1,server:!1},isBindingEnabled:{browser:!1,export:!1,server:!1},defaultSidebarDockedPreference:{browser:!0,export:!1,server:!1},isLoading:{browser:!1,export:!1,server:!1},isResizing:{browser:!1,export:!1,server:!1},isRotating:{browser:!1,export:!1,server:!1},lastPointerDownWith:{browser:!0,export:!1,server:!1},multiElement:{browser:!1,export:!1,server:!1},name:{browser:!0,export:!1,server:!1},offsetLeft:{browser:!1,export:!1,server:!1},offsetTop:{browser:!1,export:!1,server:!1},contextMenu:{browser:!1,export:!1,server:!1},openMenu:{browser:!0,export:!1,server:!1},openPopup:{browser:!1,export:!1,server:!1},openSidebar:{browser:!0,export:!1,server:!1},openDialog:{browser:!1,export:!1,server:!1},pasteDialog:{browser:!1,export:!1,server:!1},previousSelectedElementIds:{browser:!0,export:!1,server:!1},resizingElement:{browser:!1,export:!1,server:!1},scrolledOutside:{browser:!0,export:!1,server:!1},scrollX:{browser:!0,export:!1,server:!1},scrollY:{browser:!0,export:!1,server:!1},selectedElementIds:{browser:!0,export:!1,server:!1},selectedGroupIds:{browser:!0,export:!1,server:!1},selectedElementsAreBeingDragged:{browser:!1,export:!1,server:!1},selectionElement:{browser:!1,export:!1,server:!1},shouldCacheIgnoreZoom:{browser:!0,export:!1,server:!1},showStats:{browser:!0,export:!1,server:!1},startBoundElement:{browser:!1,export:!1,server:!1},suggestedBindings:{browser:!1,export:!1,server:!1},frameRendering:{browser:!1,export:!1,server:!1},frameToHighlight:{browser:!1,export:!1,server:!1},editingFrame:{browser:!1,export:!1,server:!1},elementsToHighlight:{browser:!1,export:!1,server:!1},toast:{browser:!1,export:!1,server:!1},viewBackgroundColor:{browser:!0,export:!0,server:!0},width:{browser:!1,export:!1,server:!1},zenModeEnabled:{browser:!0,export:!1,server:!1},zoom:{browser:!0,export:!1,server:!1},viewModeEnabled:{browser:!1,export:!1,server:!1},pendingImageElementId:{browser:!1,export:!1,server:!1},showHyperlinkPopup:{browser:!1,export:!1,server:!1},selectedLinearElement:{browser:!0,export:!1,server:!1},snapLines:{browser:!1,export:!1,server:!1},originSnapOffset:{browser:!1,export:!1,server:!1},objectsSnapModeEnabled:{browser:!0,export:!1,server:!1},userToFollow:{browser:!1,export:!1,server:!1},followedBy:{browser:!1,export:!1,server:!1}}),eu=(e,t)=>{let n={};for(let r of Object.keys(e))if(eg[r]?.[t]){let i=e[r];n[r]=i}return n};var ai=e=>eu(e,"export"),tu=e=>eu(e,"server"),nu=({activeTool:e})=>e.type==="eraser",ru=({activeTool:e})=>e.type==="hand";g();g();g();g();g();g();var ou=null;var a1=()=>{if(ou)return ou;let e=new Date,t=e.getFullYear(),n=`${e.getMonth()+1}`.padStart(2,"0"),r=`${e.getDate()}`.padStart(2,"0"),o=`${e.getHours()}`.padStart(2,"0"),i=`${e.getMinutes()}`.padStart(2,"0");return`${t}-${n}-${r}-${o}${i}`},s1=e=>e.charAt(0).toUpperCase()+e.slice(1),l1=e=>e instanceof HTMLElement&&e.className.includes("ToolIcon"),tg=e=>e instanceof HTMLElement&&e.dataset.type==="wysiwyg"||e instanceof HTMLBRElement||e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement,c1=e=>tg(e)||e instanceof Element&&!!e.closest("label, button"),d1=e=>e instanceof HTMLElement&&e.dataset.type==="wysiwyg"||e instanceof HTMLBRElement||e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement&&(e.type==="text"||e.type==="number"||e.type==="password"),rs=({fontFamily:e})=>{for(let[t,n]of Object.entries(pe))if(n===e)return`${t}, ${ja}`;return ja},Ee=({fontSize:e,fontFamily:t})=>`${e}px ${rs({fontFamily:t})}`,su=(e,t)=>{let n=0,r=null,o=(...i)=>{r=i,clearTimeout(n),n=window.setTimeout(()=>{r=null,e(...i)},t)};return o.flush=()=>{if(clearTimeout(n),r){let i=r;r=null,e(...i)}},o.cancel=()=>{r=null,clearTimeout(n)},o},lu=(e,t)=>{let n=null,r=null,o=null,i=s=>{n=window.requestAnimationFrame(()=>{n=null,e(...s),r=null,o&&(r=o,o=null,i(r))})},a=(...s)=>{if(y.MODE==="test"){e(...s);return}r=s,n===null?i(r):t?.trailing&&(o=s)};return a.flush=()=>{n!==null&&(cancelAnimationFrame(n),n=null),r&&(e(...o||r),r=o=null)},a.cancel=()=>{r=o=null,n!==null&&(cancelAnimationFrame(n),n=null)},a},cu=e=>1-Math.pow(1-e,4),iu=(e,t,n)=>(t-e)*cu(n)+e,u1=({fromValues:e,toValues:t,onStep:n,duration:r=250,interpolateValue:o,onStart:i,onEnd:a,onCancel:s})=>{let l=!1,c=0,d;function u(f){if(l)return;d===void 0&&(d=f,i?.());let m=Math.min(f-d,r),p=cu(m/r),h={};if(Object.keys(e).forEach(E=>{let x=E,w=(t[x]-e[x])*p+e[x];h[x]=w}),n(h),m<r){let E=m/r,x={};Object.keys(e).forEach(w=>{let v=w,T=e[v],b=t[v],D;D=o?o(T,b,E,v):iu(T,b,E),D==null&&(D=iu(T,b,E)),x[v]=D}),n(x),c=window.requestAnimationFrame(u)}else n(t),a?.()}return c=window.requestAnimationFrame(u),()=>{s?.(),l=!0,window.cancelAnimationFrame(c)}},f1=(e,t)=>{if(!e.length||t<1)return[];let n=0,r=0,o=Array(Math.ceil(e.length/t));for(;n<e.length;)o[r++]=e.slice(n,n+=t);return o};var Ve=(e,t)=>Math.abs(e-t),Wr=(e,t)=>t.type==="custom"?{...e.activeTool,type:"custom",customType:t.customType,locked:t.locked??e.activeTool.locked}:{...e.activeTool,lastActiveTool:t.lastActiveToolBeforeEraser===void 0?e.activeTool.lastActiveTool:t.lastActiveToolBeforeEraser,type:t.type,customType:null,locked:t.locked??e.activeTool.locked};var m1=e=>(e=e.replace(/\bAlt\b/i,"Alt").replace(/\bShift\b/i,"Shift").replace(/\b(Enter|Return)\b/i,"Enter"),Jo?e.replace(/\bCtrlOrCmd\b/gi,"Cmd").replace(/\bAlt\b/i,"Option"):e.replace(/\bCtrlOrCmd\b/gi,"Ctrl")),Xr=({clientX:e,clientY:t},{zoom:n,offsetLeft:r,offsetTop:o,scrollX:i,scrollY:a})=>{let s=(e-r)/n.value-i,l=(t-o)/n.value-a;return{x:s,y:l}},os=({sceneX:e,sceneY:t},{zoom:n,offsetLeft:r,offsetTop:o,scrollX:i,scrollY:a})=>{let s=(e+i)*n.value+r,l=(t+a)*n.value+o;return{x:s,y:l}},p1=e=>getComputedStyle(document.documentElement).getPropertyValue(`--${e}`),ng="A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u0300-\u0590\u0800-\u1FFF\u2C00-\uFB1C\uFDFE-\uFE6F\uFEFD-\uFFFF",rg="\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC",og=new RegExp(`^[^${ng}]*[${rg}]`),li=e=>og.test(e),or=e=>{let[t,n]=e;return{x:t,y:n}},h1=e=>{if(e?.name==="AbortError"){console.warn(e);return}throw e},E1=(e,t,n=0)=>{n<0&&(n=e.length+n),n=Math.min(e.length,Math.max(n,0));let r=n-1;for(;++r<e.length;)if(t(e[r],r,e))return r;return-1},g1=(e,t,n=e.length-1)=>{n<0&&(n=e.length+n),n=Math.min(e.length-1,Math.max(n,0));let r=n+1;for(;--r>-1;)if(t(e[r],r,e))return r;return-1},on=e=>{let t=e.length===5&&e.substr(4,1)==="0",n=e.length===9&&e.substr(7,2)==="00";return t||n||e===z.transparent},x1=()=>{let e,t,n=new Promise((r,o)=>{e=r,t=o});return n.resolve=e,n.reject=t,n};var w1=e=>{let t=e.parentElement;for(;t;){if(t===document.body)return document;let{overflowY:n}=window.getComputedStyle(t);if(t.scrollHeight>t.clientHeight&&(n==="auto"||n==="scroll"||n==="overlay"))return t;t=t.parentElement}return document},b1=e=>{let t=e.parentElement;for(;t;){if(t.tabIndex>-1){t.focus();return}t=t.parentElement}},y1=e=>{e.preventDefault(),e.returnValue=""},du=e=>Array.from(e).map(t=>`0${t.toString(16)}`.slice(-2)).join(""),Ft=()=>Nt()?1:Date.now(),X=e=>e instanceof Map?e:e.reduce((t,n)=>(t.set(typeof n=="string"?n:n.id,n),t),new Map),v1=e=>e.reduce((t,n,r)=>(t.set(n.id,[n,r]),t),new Map),bt=(e,t)=>e.reduce((n,r)=>(n[t?t(r):String(r)]=r,n),{}),Nt=()=>y.MODE==="test",T1=()=>y.MODE==="development",A1=(e,t)=>new CustomEvent(e,{detail:{nativeEvent:t},cancelable:!0}),S1=(e,t)=>{let n=!1;for(let r in t){let o=t[r];if(typeof o<"u"){if(e[r]===o&&(typeof o!="object"||o===null))continue;n=!0}}return n?{...e,...t}:e};var _1=()=>{try{return window.self===window.top?"top":"iframe"}catch{return"iframe"}};var ci=e=>!!e&&typeof e=="object"&&"then"in e&&"catch"in e&&"finally"in e,I1=e=>{let t=e?.querySelectorAll("button, a, input, select, textarea, div[tabindex], label[tabindex]");return t?Array.from(t).filter(n=>n.tabIndex>-1&&!n.disabled):[]},au=(e,t)=>Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t,Bt=(e,t,n,r=!1)=>{let o=Object.keys(e),i=Object.keys(t);if(o.length!==i.length)return r&&console.warn("%cisShallowEqual: objects don't have same properties ->","color: #8B4000",e,t),!1;if(n&&Array.isArray(n)){for(let a of n)if(!(e[a]===t[a]||au(e[a],t[a])))return r&&console.warn(`%cisShallowEqual: ${a} not equal ->`,"color: #8B4000",e[a],t[a]),!1;return!0}return o.every(a=>{let s=n?.[a],l=s?s(e[a],t[a]):e[a]===t[a]||au(e[a],t[a]);return!l&&r&&console.warn(`%cisShallowEqual: ${a} not equal ->`,"color: #8B4000",e[a],t[a]),l})},P1=(e,t,{checkForDefaultPrevented:n=!0}={})=>function(o){if(e?.(o),!n||!o?.defaultPrevented)return t?.(o)},Pn=(e,t,n)=>{if(!t)return e;if(n)return console.error(t),e;throw new Error(t)},M1=e=>{let t,n,r=function(o){let i=Object.entries(o);if(t){let s=!0;for(let[l,c]of i)if(t.get(l)!==c){s=!1;break}if(s)return n}let a=e(o);return t=new Map(i),n=a,a};return r.clear=()=>{t=void 0,n=void 0},r},uu=(e,t)=>e instanceof Set||e instanceof Map?e.has(t):"includes"in e?e.includes(t):e.hasOwnProperty(t),D1=e=>JSON.parse(JSON.stringify(e)),C1=e=>typeof e=="number"&&Number.isFinite(e),L1=(e,t)=>Bt(e,t)?e:t;function k1(e,t,n,r){return e?(e?.addEventListener?.(t,n,r),()=>{e?.removeEventListener?.(t,n,r)}):()=>{}}var si=(e,t)=>(e+t)/2;function O1(e,t=!0){let n=e.length;if(n<4)return"";let r=e[0],o=e[1],i=e[2],a=`M${r[0].toFixed(2)},${r[1].toFixed(2)} Q${o[0].toFixed(2)},${o[1].toFixed(2)} ${si(o[0],i[0]).toFixed(2)},${si(o[1],i[1]).toFixed(2)} T`;for(let s=2,l=n-1;s<l;s++)r=e[s],o=e[s+1],a+=`${si(r[0],o[0]).toFixed(2)},${si(r[1],o[1]).toFixed(2)} `;return t&&(a+="Z"),a}var fu=e=>e.replace(/\r?\n|\r/g,`
`),Gt=e=>e,R1=async(e,...t)=>new Promise(n=>{n(e(...t))});var yt=e=>!!e&&e.type==="image"&&!!e.fileId,di=e=>!!e&&e.type==="image",ui=e=>!!e&&e.type==="embeddable",Zr=e=>!!e&&e.type==="iframe",tt=e=>!!e&&(e.type==="iframe"||e.type==="embeddable"),Y=e=>e!=null&&e.type==="text",Kr=e=>e!=null&&e.type==="frame",mu=e=>e!=null&&e.type==="magicframe",ee=e=>e!=null&&(e.type==="frame"||e.type==="magicframe"),ge=e=>e!=null&&ig(e.type),ig=e=>e==="freedraw",J=e=>e!=null&&is(e.type),j=e=>e!=null&&e.type==="arrow",is=e=>e==="arrow"||e==="line",jr=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&ag(e.type),ag=e=>e==="arrow",Mn=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&(e.type==="rectangle"||e.type==="diamond"||e.type==="ellipse"||e.type==="image"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="text"&&!e.containerId),sg=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&(e.type==="rectangle"||e.type==="diamond"||e.type==="ellipse"||j(e)),as=e=>{let t=e?.type;if(!t)return!1;switch(t){case"text":case"diamond":case"rectangle":case"iframe":case"embeddable":case"ellipse":case"arrow":case"freedraw":case"line":case"frame":case"magicframe":case"image":case"selection":return!0;default:return Pn(t,null),!1}},ir=e=>sg(e)&&!!e.boundElements?.some(({type:t})=>t==="text"),be=e=>e!==null&&"containerId"in e&&e.containerId!==null&&Y(e),fi=e=>e==="rectangle"||e==="embeddable"||e==="iframe"||e==="image",pu=e=>e==="line"||e==="arrow"||e==="diamond",z1=(e,t)=>!!((e===Oe.ADAPTIVE_RADIUS||e===Oe.LEGACY)&&fi(t.type)||e===Oe.PROPORTIONAL_RADIUS&&pu(t.type)),H1=e=>pu(e.type)?{type:Oe.PROPORTIONAL_RADIUS}:fi(e.type)?{type:Oe.ADAPTIVE_RADIUS}:null;g();g();g();g();g();g();g();g();g();g();g();g();function ss(e,t,n){if(e&&e.length){let[r,o]=t,i=Math.PI/180*n,a=Math.cos(i),s=Math.sin(i);for(let l of e){let[c,d]=l;l[0]=(c-r)*a-(d-o)*s+r,l[1]=(c-r)*s+(d-o)*a+o}}}function lg(e,t,n){let r=[];e.forEach(o=>r.push(...o)),ss(r,t,n)}function cg(e,t){return e[0]===t[0]&&e[1]===t[1]}function hu(e,t,n,r=1){let o=n,i=Math.max(t,.1),a=e[0]&&e[0][0]&&typeof e[0][0]=="number"?[e]:e,s=[0,0];if(o)for(let c of a)ss(c,s,o);let l=dg(a,i,r);if(o){for(let c of a)ss(c,s,-o);lg(l,s,-o)}return l}function dg(e,t,n){let r=[];for(let c of e){let d=[...c];cg(d[0],d[d.length-1])||d.push([d[0][0],d[0][1]]),d.length>2&&r.push(d)}let o=[];t=Math.max(t,.1);let i=[];for(let c of r)for(let d=0;d<c.length-1;d++){let u=c[d],f=c[d+1];if(u[1]!==f[1]){let m=Math.min(u[1],f[1]);i.push({ymin:m,ymax:Math.max(u[1],f[1]),x:m===u[1]?u[0]:f[0],islope:(f[0]-u[0])/(f[1]-u[1])})}}if(i.sort((c,d)=>c.ymin<d.ymin?-1:c.ymin>d.ymin?1:c.x<d.x?-1:c.x>d.x?1:c.ymax===d.ymax?0:(c.ymax-d.ymax)/Math.abs(c.ymax-d.ymax)),!i.length)return o;let a=[],s=i[0].ymin,l=0;for(;a.length||i.length;){if(i.length){let c=-1;for(let u=0;u<i.length&&!(i[u].ymin>s);u++)c=u;i.splice(0,c+1).forEach(u=>{a.push({s,edge:u})})}if(a=a.filter(c=>!(c.edge.ymax<=s)),a.sort((c,d)=>c.edge.x===d.edge.x?0:(c.edge.x-d.edge.x)/Math.abs(c.edge.x-d.edge.x)),(n!==1||l%t===0)&&a.length>1)for(let c=0;c<a.length;c=c+2){let d=c+1;if(d>=a.length)break;let u=a[c].edge,f=a[d].edge;o.push([[Math.round(u.x),s],[Math.round(f.x),s]])}s+=n,a.forEach(c=>{c.edge.x=c.edge.x+n*c.edge.islope}),l++}return o}function vt(e,t){var n;let r=t.hachureAngle+90,o=t.hachureGap;o<0&&(o=t.strokeWidth*4),o=Math.max(o,.1);let i=1;return t.roughness>=1&&(((n=t.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(i=o),hu(e,o,r,i||1)}var an=class{constructor(t){this.helper=t}fillPolygons(t,n){return this._fillPolygons(t,n)}_fillPolygons(t,n){let r=vt(t,n);return{type:"fillSketch",ops:this.renderLines(r,n)}}renderLines(t,n){let r=[];for(let o of t)r.push(...this.helper.doubleLineOps(o[0][0],o[0][1],o[1][0],o[1][1],n));return r}};g();g();function sn(e){let t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}var mi=class extends an{fillPolygons(t,n){let r=n.hachureGap;r<0&&(r=n.strokeWidth*4),r=Math.max(r,.1);let o=Object.assign({},n,{hachureGap:r}),i=vt(t,o),a=Math.PI/180*n.hachureAngle,s=[],l=r*.5*Math.cos(a),c=r*.5*Math.sin(a);for(let[u,f]of i)sn([u,f])&&s.push([[u[0]-l,u[1]+c],[...f]],[[u[0]+l,u[1]-c],[...f]]);return{type:"fillSketch",ops:this.renderLines(s,n)}}};g();var pi=class extends an{fillPolygons(t,n){let r=this._fillPolygons(t,n),o=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),i=this._fillPolygons(t,o);return r.ops=r.ops.concat(i.ops),r}};g();var hi=class{constructor(t){this.helper=t}fillPolygons(t,n){n=Object.assign({},n,{hachureAngle:0});let r=vt(t,n);return this.dotsOnLines(r,n)}dotsOnLines(t,n){let r=[],o=n.hachureGap;o<0&&(o=n.strokeWidth*4),o=Math.max(o,.1);let i=n.fillWeight;i<0&&(i=n.strokeWidth/2);let a=o/4;for(let s of t){let l=sn(s),c=l/o,d=Math.ceil(c)-1,u=l-d*o,f=(s[0][0]+s[1][0])/2-o/4,m=Math.min(s[0][1],s[1][1]);for(let p=0;p<d;p++){let h=m+u+p*o,E=f-a+Math.random()*2*a,x=h-a+Math.random()*2*a,w=this.helper.ellipse(E,x,i,i,n);r.push(...w.ops)}}return{type:"fillSketch",ops:r}}};g();var Ei=class{constructor(t){this.helper=t}fillPolygons(t,n){let r=vt(t,n);return{type:"fillSketch",ops:this.dashedLine(r,n)}}dashedLine(t,n){let r=n.dashOffset<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashOffset,o=n.dashGap<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashGap,i=[];return t.forEach(a=>{let s=sn(a),l=Math.floor(s/(r+o)),c=(s+o-l*(r+o))/2,d=a[0],u=a[1];d[0]>u[0]&&(d=a[1],u=a[0]);let f=Math.atan((u[1]-d[1])/(u[0]-d[0]));for(let m=0;m<l;m++){let p=m*(r+o),h=p+r,E=[d[0]+p*Math.cos(f)+c*Math.cos(f),d[1]+p*Math.sin(f)+c*Math.sin(f)],x=[d[0]+h*Math.cos(f)+c*Math.cos(f),d[1]+h*Math.sin(f)+c*Math.sin(f)];i.push(...this.helper.doubleLineOps(E[0],E[1],x[0],x[1],n))}}),i}};g();var gi=class{constructor(t){this.helper=t}fillPolygons(t,n){let r=n.hachureGap<0?n.strokeWidth*4:n.hachureGap,o=n.zigzagOffset<0?r:n.zigzagOffset;n=Object.assign({},n,{hachureGap:r+o});let i=vt(t,n);return{type:"fillSketch",ops:this.zigzagLines(i,o,n)}}zigzagLines(t,n,r){let o=[];return t.forEach(i=>{let a=sn(i),s=Math.round(a/(2*n)),l=i[0],c=i[1];l[0]>c[0]&&(l=i[1],c=i[0]);let d=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let u=0;u<s;u++){let f=u*2*n,m=(u+1)*2*n,p=Math.sqrt(2*Math.pow(n,2)),h=[l[0]+f*Math.cos(d),l[1]+f*Math.sin(d)],E=[l[0]+m*Math.cos(d),l[1]+m*Math.sin(d)],x=[h[0]+p*Math.cos(d+Math.PI/4),h[1]+p*Math.sin(d+Math.PI/4)];o.push(...this.helper.doubleLineOps(h[0],h[1],x[0],x[1],r),...this.helper.doubleLineOps(x[0],x[1],E[0],E[1],r))}}),o}};var Me={};function Eu(e,t){let n=e.fillStyle||"hachure";if(!Me[n])switch(n){case"zigzag":Me[n]||(Me[n]=new mi(t));break;case"cross-hatch":Me[n]||(Me[n]=new pi(t));break;case"dots":Me[n]||(Me[n]=new hi(t));break;case"dashed":Me[n]||(Me[n]=new Ei(t));break;case"zigzag-line":Me[n]||(Me[n]=new gi(t));break;case"hachure":default:n="hachure",Me[n]||(Me[n]=new an(t));break}return Me[n]}g();function gu(){return Math.floor(Math.random()*2**31)}var ar=class{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}};g();g();var xi={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function ug(e){let t=new Array;for(;e!=="";)if(e.match(/^([ \t\r\n,]+)/))e=e.substr(RegExp.$1.length);else if(e.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]={type:0,text:RegExp.$1},e=e.substr(RegExp.$1.length);else if(e.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))t[t.length]={type:1,text:`${parseFloat(RegExp.$1)}`},e=e.substr(RegExp.$1.length);else return[];return t[t.length]={type:2,text:""},t}function ls(e,t){return e.type===t}function sr(e){let t=[],n=ug(e),r="BOD",o=0,i=n[o];for(;!ls(i,2);){let a=0,s=[];if(r==="BOD")if(i.text==="M"||i.text==="m")o++,a=xi[i.text],r=i.text;else return sr("M0,0"+e);else ls(i,1)?a=xi[r]:(o++,a=xi[i.text],r=i.text);if(o+a<n.length){for(let l=o;l<o+a;l++){let c=n[l];if(ls(c,1))s[s.length]=+c.text;else throw new Error("Param not a number: "+r+","+c.text)}if(typeof xi[r]=="number"){let l={key:r,data:s};t.push(l),o+=a,i=n[o],r==="M"&&(r="L"),r==="m"&&(r="l")}else throw new Error("Bad segment: "+r)}else throw new Error("Path data ended short")}return t}g();function qr(e){let t=0,n=0,r=0,o=0,i=[];for(let{key:a,data:s}of e)switch(a){case"M":i.push({key:"M",data:[...s]}),[t,n]=s,[r,o]=s;break;case"m":t+=s[0],n+=s[1],i.push({key:"M",data:[t,n]}),r=t,o=n;break;case"L":i.push({key:"L",data:[...s]}),[t,n]=s;break;case"l":t+=s[0],n+=s[1],i.push({key:"L",data:[t,n]});break;case"C":i.push({key:"C",data:[...s]}),t=s[4],n=s[5];break;case"c":{let l=s.map((c,d)=>d%2?c+n:c+t);i.push({key:"C",data:l}),t=l[4],n=l[5];break}case"Q":i.push({key:"Q",data:[...s]}),t=s[2],n=s[3];break;case"q":{let l=s.map((c,d)=>d%2?c+n:c+t);i.push({key:"Q",data:l}),t=l[2],n=l[3];break}case"A":i.push({key:"A",data:[...s]}),t=s[5],n=s[6];break;case"a":t+=s[5],n+=s[6],i.push({key:"A",data:[s[0],s[1],s[2],s[3],s[4],t,n]});break;case"H":i.push({key:"H",data:[...s]}),t=s[0];break;case"h":t+=s[0],i.push({key:"H",data:[t]});break;case"V":i.push({key:"V",data:[...s]}),n=s[0];break;case"v":n+=s[0],i.push({key:"V",data:[n]});break;case"S":i.push({key:"S",data:[...s]}),t=s[2],n=s[3];break;case"s":{let l=s.map((c,d)=>d%2?c+n:c+t);i.push({key:"S",data:l}),t=l[2],n=l[3];break}case"T":i.push({key:"T",data:[...s]}),t=s[0],n=s[1];break;case"t":t+=s[0],n+=s[1],i.push({key:"T",data:[t,n]});break;case"Z":case"z":i.push({key:"Z",data:[]}),t=r,n=o;break}return i}g();function Qr(e){let t=[],n="",r=0,o=0,i=0,a=0,s=0,l=0;for(let{key:c,data:d}of e){switch(c){case"M":t.push({key:"M",data:[...d]}),[r,o]=d,[i,a]=d;break;case"C":t.push({key:"C",data:[...d]}),r=d[4],o=d[5],s=d[2],l=d[3];break;case"L":t.push({key:"L",data:[...d]}),[r,o]=d;break;case"H":r=d[0],t.push({key:"L",data:[r,o]});break;case"V":o=d[0],t.push({key:"L",data:[r,o]});break;case"S":{let u=0,f=0;n==="C"||n==="S"?(u=r+(r-s),f=o+(o-l)):(u=r,f=o),t.push({key:"C",data:[u,f,...d]}),s=d[0],l=d[1],r=d[2],o=d[3];break}case"T":{let[u,f]=d,m=0,p=0;n==="Q"||n==="T"?(m=r+(r-s),p=o+(o-l)):(m=r,p=o);let h=r+2*(m-r)/3,E=o+2*(p-o)/3,x=u+2*(m-u)/3,w=f+2*(p-f)/3;t.push({key:"C",data:[h,E,x,w,u,f]}),s=m,l=p,r=u,o=f;break}case"Q":{let[u,f,m,p]=d,h=r+2*(u-r)/3,E=o+2*(f-o)/3,x=m+2*(u-m)/3,w=p+2*(f-p)/3;t.push({key:"C",data:[h,E,x,w,m,p]}),s=u,l=f,r=m,o=p;break}case"A":{let u=Math.abs(d[0]),f=Math.abs(d[1]),m=d[2],p=d[3],h=d[4],E=d[5],x=d[6];u===0||f===0?(t.push({key:"C",data:[r,o,E,x,E,x]}),r=E,o=x):(r!==E||o!==x)&&(xu(r,o,E,x,u,f,m,p,h).forEach(function(v){t.push({key:"C",data:v})}),r=E,o=x);break}case"Z":t.push({key:"Z",data:[]}),r=i,o=a;break}n=c}return t}function fg(e){return Math.PI*e/180}function Jr(e,t,n){let r=e*Math.cos(n)-t*Math.sin(n),o=e*Math.sin(n)+t*Math.cos(n);return[r,o]}function xu(e,t,n,r,o,i,a,s,l,c){let d=fg(a),u=[],f=0,m=0,p=0,h=0;if(c)[f,m,p,h]=c;else{[e,t]=Jr(e,t,-d),[n,r]=Jr(n,r,-d);let M=(e-n)/2,k=(t-r)/2,U=M*M/(o*o)+k*k/(i*i);U>1&&(U=Math.sqrt(U),o=U*o,i=U*i);let G=s===l?-1:1,B=o*o,L=i*i,C=B*L-B*k*k-L*M*M,V=B*k*k+L*M*M,$=G*Math.sqrt(Math.abs(C/V));p=$*o*k/i+(e+n)/2,h=$*-i*M/o+(t+r)/2,f=Math.asin(parseFloat(((t-h)/i).toFixed(9))),m=Math.asin(parseFloat(((r-h)/i).toFixed(9))),e<p&&(f=Math.PI-f),n<p&&(m=Math.PI-m),f<0&&(f=Math.PI*2+f),m<0&&(m=Math.PI*2+m),l&&f>m&&(f=f-Math.PI*2),!l&&m>f&&(m=m-Math.PI*2)}let E=m-f;if(Math.abs(E)>Math.PI*120/180){let M=m,k=n,U=r;l&&m>f?m=f+Math.PI*120/180*1:m=f+Math.PI*120/180*-1,n=p+o*Math.cos(m),r=h+i*Math.sin(m),u=xu(n,r,k,U,o,i,a,0,l,[m,M,p,h])}E=m-f;let x=Math.cos(f),w=Math.sin(f),v=Math.cos(m),T=Math.sin(m),b=Math.tan(E/4),D=4/3*o*b,A=4/3*i*b,S=[e,t],I=[e+D*w,t-A*x],P=[n+D*T,r-A*v],_=[n,r];if(I[0]=2*S[0]-I[0],I[1]=2*S[1]-I[1],c)return[I,P,_].concat(u);{u=[I,P,_].concat(u);let M=[];for(let k=0;k<u.length;k+=3){let U=Jr(u[k][0],u[k][1],d),G=Jr(u[k+1][0],u[k+1][1],d),B=Jr(u[k+2][0],u[k+2][1],d);M.push([U[0],U[1],G[0],G[1],B[0],B[1]])}return M}}var mg={randOffset:Eg,randOffsetWithRange:gg,ellipse:hg,doubleLineOps:xg};function cs(e,t,n,r,o){return{type:"path",ops:zt(e,t,n,r,o)}}function eo(e,t,n){let r=(e||[]).length;if(r>2){let o=[];for(let i=0;i<r-1;i++)o.push(...zt(e[i][0],e[i][1],e[i+1][0],e[i+1][1],n));return t&&o.push(...zt(e[r-1][0],e[r-1][1],e[0][0],e[0][1],n)),{type:"path",ops:o}}else if(r===2)return cs(e[0][0],e[0][1],e[1][0],e[1][1],n);return{type:"path",ops:[]}}function pg(e,t){return eo(e,!0,t)}function Tu(e,t,n,r,o){let i=[[e,t],[e+n,t],[e+n,t+r],[e,t+r]];return pg(i,o)}function ds(e,t){let n=bu(e,1*(1+t.roughness*.2),t);if(!t.disableMultiStroke){let r=bu(e,1.5*(1+t.roughness*.22),wg(t));n=n.concat(r)}return{type:"path",ops:n}}function hg(e,t,n,r,o){let i=us(n,r,o);return yi(e,t,o,i).opset}function us(e,t,n){let r=Math.sqrt(Math.PI*2*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),o=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),i=Math.PI*2/o,a=Math.abs(e/2),s=Math.abs(t/2),l=1-n.curveFitting;return a+=R(a*l,n),s+=R(s*l,n),{increment:i,rx:a,ry:s}}function yi(e,t,n,r){let[o,i]=yu(r.increment,e,t,r.rx,r.ry,1,r.increment*wi(.1,wi(.4,1,n),n),n),a=bi(o,null,n);if(!n.disableMultiStroke&&n.roughness!==0){let[s]=yu(r.increment,e,t,r.rx,r.ry,1.5,0,n),l=bi(s,null,n);a=a.concat(l)}return{estimatedPoints:i,opset:{type:"path",ops:a}}}function fs(e,t,n,r,o,i,a,s,l){let c=e,d=t,u=Math.abs(n/2),f=Math.abs(r/2);u+=R(u*.01,l),f+=R(f*.01,l);let m=o,p=i;for(;m<0;)m+=Math.PI*2,p+=Math.PI*2;p-m>Math.PI*2&&(m=0,p=Math.PI*2);let h=Math.PI*2/l.curveStepCount,E=Math.min(h/2,(p-m)/2),x=vu(E,c,d,u,f,m,p,1,l);if(!l.disableMultiStroke){let w=vu(E,c,d,u,f,m,p,1.5,l);x.push(...w)}return a&&(s?x.push(...zt(c,d,c+u*Math.cos(m),d+f*Math.sin(m),l),...zt(c,d,c+u*Math.cos(p),d+f*Math.sin(p),l)):x.push({op:"lineTo",data:[c,d]},{op:"lineTo",data:[c+u*Math.cos(m),d+f*Math.sin(m)]})),{type:"path",ops:x}}function ms(e,t){let n=Qr(qr(sr(e))),r=[],o=[0,0],i=[0,0];for(let{key:a,data:s}of n)switch(a){case"M":{i=[s[0],s[1]],o=[s[0],s[1]];break}case"L":r.push(...zt(i[0],i[1],s[0],s[1],t)),i=[s[0],s[1]];break;case"C":{let[l,c,d,u,f,m]=s;r.push(...bg(l,c,d,u,f,m,i,t)),i=[f,m];break}case"Z":r.push(...zt(i[0],i[1],o[0],o[1],t)),i=[o[0],o[1]];break}return{type:"path",ops:r}}function vi(e,t){let n=[];for(let r of e)if(r.length){let o=t.maxRandomnessOffset||0,i=r.length;if(i>2){n.push({op:"move",data:[r[0][0]+R(o,t),r[0][1]+R(o,t)]});for(let a=1;a<i;a++)n.push({op:"lineTo",data:[r[a][0]+R(o,t),r[a][1]+R(o,t)]})}}return{type:"fillPath",ops:n}}function Dn(e,t){return Eu(t,mg).fillPolygons(e,t)}function Au(e,t,n,r,o,i,a){let s=e,l=t,c=Math.abs(n/2),d=Math.abs(r/2);c+=R(c*.01,a),d+=R(d*.01,a);let u=o,f=i;for(;u<0;)u+=Math.PI*2,f+=Math.PI*2;f-u>Math.PI*2&&(u=0,f=Math.PI*2);let m=(f-u)/a.curveStepCount,p=[];for(let h=u;h<=f;h=h+m)p.push([s+c*Math.cos(h),l+d*Math.sin(h)]);return p.push([s+c*Math.cos(f),l+d*Math.sin(f)]),p.push([s,l]),Dn([p],a)}function Eg(e,t){return R(e,t)}function gg(e,t,n){return wi(e,t,n)}function xg(e,t,n,r,o){return zt(e,t,n,r,o,!0)}function wg(e){let t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function Su(e){return e.randomizer||(e.randomizer=new ar(e.seed||0)),e.randomizer.next()}function wi(e,t,n,r=1){return n.roughness*r*(Su(n)*(t-e)+e)}function R(e,t,n=1){return wi(-e,e,t,n)}function zt(e,t,n,r,o,i=!1){let a=i?o.disableMultiStrokeFill:o.disableMultiStroke,s=wu(e,t,n,r,o,!0,!1);if(a)return s;let l=wu(e,t,n,r,o,!0,!0);return s.concat(l)}function wu(e,t,n,r,o,i,a){let s=Math.pow(e-n,2)+Math.pow(t-r,2),l=Math.sqrt(s),c=1;l<200?c=1:l>500?c=.4:c=-.0016668*l+1.233334;let d=o.maxRandomnessOffset||0;d*d*100>s&&(d=l/10);let u=d/2,f=.2+Su(o)*.2,m=o.bowing*o.maxRandomnessOffset*(r-t)/200,p=o.bowing*o.maxRandomnessOffset*(e-n)/200;m=R(m,o,c),p=R(p,o,c);let h=[],E=()=>R(u,o,c),x=()=>R(d,o,c),w=o.preserveVertices;return i&&(a?h.push({op:"move",data:[e+(w?0:E()),t+(w?0:E())]}):h.push({op:"move",data:[e+(w?0:R(d,o,c)),t+(w?0:R(d,o,c))]})),a?h.push({op:"bcurveTo",data:[m+e+(n-e)*f+E(),p+t+(r-t)*f+E(),m+e+2*(n-e)*f+E(),p+t+2*(r-t)*f+E(),n+(w?0:E()),r+(w?0:E())]}):h.push({op:"bcurveTo",data:[m+e+(n-e)*f+x(),p+t+(r-t)*f+x(),m+e+2*(n-e)*f+x(),p+t+2*(r-t)*f+x(),n+(w?0:x()),r+(w?0:x())]}),h}function bu(e,t,n){let r=[];r.push([e[0][0]+R(t,n),e[0][1]+R(t,n)]),r.push([e[0][0]+R(t,n),e[0][1]+R(t,n)]);for(let o=1;o<e.length;o++)r.push([e[o][0]+R(t,n),e[o][1]+R(t,n)]),o===e.length-1&&r.push([e[o][0]+R(t,n),e[o][1]+R(t,n)]);return bi(r,null,n)}function bi(e,t,n){let r=e.length,o=[];if(r>3){let i=[],a=1-n.curveTightness;o.push({op:"move",data:[e[1][0],e[1][1]]});for(let s=1;s+2<r;s++){let l=e[s];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*e[s+1][0]-a*e[s-1][0])/6,l[1]+(a*e[s+1][1]-a*e[s-1][1])/6],i[2]=[e[s+1][0]+(a*e[s][0]-a*e[s+2][0])/6,e[s+1][1]+(a*e[s][1]-a*e[s+2][1])/6],i[3]=[e[s+1][0],e[s+1][1]],o.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[3][0],i[3][1]]})}if(t&&t.length===2){let s=n.maxRandomnessOffset;o.push({op:"lineTo",data:[t[0]+R(s,n),t[1]+R(s,n)]})}}else r===3?(o.push({op:"move",data:[e[1][0],e[1][1]]}),o.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):r===2&&o.push(...zt(e[0][0],e[0][1],e[1][0],e[1][1],n));return o}function yu(e,t,n,r,o,i,a,s){let l=s.roughness===0,c=[],d=[];if(l){e=e/4,d.push([t+r*Math.cos(-e),n+o*Math.sin(-e)]);for(let u=0;u<=Math.PI*2;u=u+e){let f=[t+r*Math.cos(u),n+o*Math.sin(u)];c.push(f),d.push(f)}d.push([t+r*Math.cos(0),n+o*Math.sin(0)]),d.push([t+r*Math.cos(e),n+o*Math.sin(e)])}else{let u=R(.5,s)-Math.PI/2;d.push([R(i,s)+t+.9*r*Math.cos(u-e),R(i,s)+n+.9*o*Math.sin(u-e)]);let f=Math.PI*2+u-.01;for(let m=u;m<f;m=m+e){let p=[R(i,s)+t+r*Math.cos(m),R(i,s)+n+o*Math.sin(m)];c.push(p),d.push(p)}d.push([R(i,s)+t+r*Math.cos(u+Math.PI*2+a*.5),R(i,s)+n+o*Math.sin(u+Math.PI*2+a*.5)]),d.push([R(i,s)+t+.98*r*Math.cos(u+a),R(i,s)+n+.98*o*Math.sin(u+a)]),d.push([R(i,s)+t+.9*r*Math.cos(u+a*.5),R(i,s)+n+.9*o*Math.sin(u+a*.5)])}return[d,c]}function vu(e,t,n,r,o,i,a,s,l){let c=i+R(.1,l),d=[];d.push([R(s,l)+t+.9*r*Math.cos(c-e),R(s,l)+n+.9*o*Math.sin(c-e)]);for(let u=c;u<=a;u=u+e)d.push([R(s,l)+t+r*Math.cos(u),R(s,l)+n+o*Math.sin(u)]);return d.push([t+r*Math.cos(a),n+o*Math.sin(a)]),d.push([t+r*Math.cos(a),n+o*Math.sin(a)]),bi(d,null,l)}function bg(e,t,n,r,o,i,a,s){let l=[],c=[s.maxRandomnessOffset||1,(s.maxRandomnessOffset||1)+.3],d=[0,0],u=s.disableMultiStroke?1:2,f=s.preserveVertices;for(let m=0;m<u;m++)m===0?l.push({op:"move",data:[a[0],a[1]]}):l.push({op:"move",data:[a[0]+(f?0:R(c[0],s)),a[1]+(f?0:R(c[0],s))]}),d=f?[o,i]:[o+R(c[m],s),i+R(c[m],s)],l.push({op:"bcurveTo",data:[e+R(c[m],s),t+R(c[m],s),n+R(c[m],s),r+R(c[m],s),d[0],d[1]]});return l}g();function to(e){return[...e]}function _u(e,t=0){let n=e.length;if(n<3)throw new Error("A curve must have at least three points.");let r=[];if(n===3)r.push(to(e[0]),to(e[1]),to(e[2]),to(e[2]));else{let o=[];o.push(e[0],e[0]);for(let s=1;s<e.length;s++)o.push(e[s]),s===e.length-1&&o.push(e[s]);let i=[],a=1-t;r.push(to(o[0]));for(let s=1;s+2<o.length;s++){let l=o[s];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*o[s+1][0]-a*o[s-1][0])/6,l[1]+(a*o[s+1][1]-a*o[s-1][1])/6],i[2]=[o[s+1][0]+(a*o[s][0]-a*o[s+2][0])/6,o[s+1][1]+(a*o[s][1]-a*o[s+2][1])/6],i[3]=[o[s+1][0],o[s+1][1]],r.push(i[1],i[2],i[3])}}return r}g();function yg(e,t){return Math.sqrt(Ti(e,t))}function Ti(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function vg(e,t,n){let r=Ti(t,n);if(r===0)return Ti(e,t);let o=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/r;return o=Math.max(0,Math.min(1,o)),Ti(e,Cn(t,n,o))}function Cn(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function Tg(e,t){let n=e[t+0],r=e[t+1],o=e[t+2],i=e[t+3],a=3*r[0]-2*n[0]-i[0];a*=a;let s=3*r[1]-2*n[1]-i[1];s*=s;let l=3*o[0]-2*i[0]-n[0];l*=l;let c=3*o[1]-2*i[1]-n[1];return c*=c,a<l&&(a=l),s<c&&(s=c),a+s}function ps(e,t,n,r){let o=r||[];if(Tg(e,t)<n){let i=e[t+0];o.length?yg(o[o.length-1],i)>1&&o.push(i):o.push(i),o.push(e[t+3])}else{let a=e[t+0],s=e[t+1],l=e[t+2],c=e[t+3],d=Cn(a,s,.5),u=Cn(s,l,.5),f=Cn(l,c,.5),m=Cn(d,u,.5),p=Cn(u,f,.5),h=Cn(m,p,.5);ps([a,d,m,h],0,n,o),ps([h,p,f,c],0,n,o)}return o}function Iu(e,t){return Ai(e,0,e.length,t)}function Ai(e,t,n,r,o){let i=o||[],a=e[t],s=e[n-1],l=0,c=1;for(let d=t+1;d<n-1;++d){let u=vg(e[d],a,s);u>l&&(l=u,c=d)}return Math.sqrt(l)>r?(Ai(e,t,c+1,r,i),Ai(e,c,n,r,i)):(i.length||i.push(a),i.push(s)),i}function lr(e,t=.15,n){let r=[],o=(e.length-1)/3;for(let i=0;i<o;i++){let a=i*3;ps(e,a,t,r)}return n&&n>0?Ai(r,0,r.length,n):r}g();function Pu(e,t,n){let r=sr(e),o=Qr(qr(r)),i=[],a=[],s=[0,0],l=[],c=()=>{l.length>=4&&a.push(...lr(l,t)),l=[]},d=()=>{c(),a.length&&(i.push(a),a=[])};for(let{key:f,data:m}of o)switch(f){case"M":d(),s=[m[0],m[1]],a.push(s);break;case"L":c(),a.push([m[0],m[1]]);break;case"C":if(!l.length){let p=a.length?a[a.length-1]:s;l.push([p[0],p[1]])}l.push([m[0],m[1]]),l.push([m[2],m[3]]),l.push([m[4],m[5]]);break;case"Z":c(),a.push([s[0],s[1]]);break}if(d(),!n)return i;let u=[];for(let f of i){let m=Iu(f,n);m.length&&u.push(m)}return u}var Re="none",nt=class{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return gu()}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,n,r){return{shape:t,sets:n||[],options:r||this.defaultOptions}}line(t,n,r,o,i){let a=this._o(i);return this._d("line",[cs(t,n,r,o,a)],a)}rectangle(t,n,r,o,i){let a=this._o(i),s=[],l=Tu(t,n,r,o,a);if(a.fill){let c=[[t,n],[t+r,n],[t+r,n+o],[t,n+o]];a.fillStyle==="solid"?s.push(vi([c],a)):s.push(Dn([c],a))}return a.stroke!==Re&&s.push(l),this._d("rectangle",s,a)}ellipse(t,n,r,o,i){let a=this._o(i),s=[],l=us(r,o,a),c=yi(t,n,a,l);if(a.fill)if(a.fillStyle==="solid"){let d=yi(t,n,a,l).opset;d.type="fillPath",s.push(d)}else s.push(Dn([c.estimatedPoints],a));return a.stroke!==Re&&s.push(c.opset),this._d("ellipse",s,a)}circle(t,n,r,o){let i=this.ellipse(t,n,r,r,o);return i.shape="circle",i}linearPath(t,n){let r=this._o(n);return this._d("linearPath",[eo(t,!1,r)],r)}arc(t,n,r,o,i,a,s=!1,l){let c=this._o(l),d=[],u=fs(t,n,r,o,i,a,s,!0,c);if(s&&c.fill)if(c.fillStyle==="solid"){let f=Object.assign({},c);f.disableMultiStroke=!0;let m=fs(t,n,r,o,i,a,!0,!1,f);m.type="fillPath",d.push(m)}else d.push(Au(t,n,r,o,i,a,c));return c.stroke!==Re&&d.push(u),this._d("arc",d,c)}curve(t,n){let r=this._o(n),o=[],i=ds(t,r);if(r.fill&&r.fill!==Re&&t.length>=3)if(r.fillStyle==="solid"){let a=ds(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));o.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{let a=_u(t),s=lr(a,10,(1+r.roughness)/2);o.push(Dn([s],r))}return r.stroke!==Re&&o.push(i),this._d("curve",o,r)}polygon(t,n){let r=this._o(n),o=[],i=eo(t,!0,r);return r.fill&&(r.fillStyle==="solid"?o.push(vi([t],r)):o.push(Dn([t],r))),r.stroke!==Re&&o.push(i),this._d("polygon",o,r)}path(t,n){let r=this._o(n),o=[];if(!t)return this._d("path",o,r);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let i=r.fill&&r.fill!=="transparent"&&r.fill!==Re,a=r.stroke!==Re,s=!!(r.simplification&&r.simplification<1),l=s?4-4*(r.simplification||1):(1+r.roughness)/2,c=Pu(t,1,l),d=ms(t,r);if(i)if(r.fillStyle==="solid")if(c.length===1){let u=ms(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));o.push({type:"fillPath",ops:this._mergedShape(u.ops)})}else o.push(vi(c,r));else o.push(Dn(c,r));return a&&(s?c.forEach(u=>{o.push(eo(u,!1,r))}):o.push(d)),this._d("path",o,r)}opsToPath(t,n){let r="";for(let o of t.ops){let i=typeof n=="number"&&n>=0?o.data.map(a=>+a.toFixed(n)):o.data;switch(o.op){case"move":r+=`M${i[0]} ${i[1]} `;break;case"bcurveTo":r+=`C${i[0]} ${i[1]}, ${i[2]} ${i[3]}, ${i[4]} ${i[5]} `;break;case"lineTo":r+=`L${i[0]} ${i[1]} `;break}}return r.trim()}toPaths(t){let n=t.sets||[],r=t.options||this.defaultOptions,o=[];for(let i of n){let a=null;switch(i.type){case"path":a={d:this.opsToPath(i),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:Re};break;case"fillPath":a={d:this.opsToPath(i),stroke:Re,strokeWidth:0,fill:r.fill||Re};break;case"fillSketch":a=this.fillSketch(i,r);break}a&&o.push(a)}return o}fillSketch(t,n){let r=n.fillWeight;return r<0&&(r=n.strokeWidth/2),{d:this.opsToPath(t),stroke:n.fill||Re,strokeWidth:r,fill:Re}}_mergedShape(t){return t.filter((n,r)=>r===0?!0:n.op!=="move")}};var Si=class{constructor(t,n){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new nt(n)}draw(t){let n=t.sets||[],r=t.options||this.getDefaultOptions(),o=this.ctx,i=t.options.fixedDecimalPlaceDigits;for(let a of n)switch(a.type){case"path":o.save(),o.strokeStyle=r.stroke==="none"?"transparent":r.stroke,o.lineWidth=r.strokeWidth,r.strokeLineDash&&o.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(o.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(o,a,i),o.restore();break;case"fillPath":{o.save(),o.fillStyle=r.fill||"";let s=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(o,a,i,s),o.restore();break}case"fillSketch":this.fillSketch(o,a,r);break}}fillSketch(t,n,r){let o=r.fillWeight;o<0&&(o=r.strokeWidth/2),t.save(),r.fillLineDash&&t.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(t.lineDashOffset=r.fillLineDashOffset),t.strokeStyle=r.fill||"",t.lineWidth=o,this._drawToContext(t,n,r.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,n,r,o="nonzero"){t.beginPath();for(let i of n.ops){let a=typeof r=="number"&&r>=0?i.data.map(s=>+s.toFixed(r)):i.data;switch(i.op){case"move":t.moveTo(a[0],a[1]);break;case"bcurveTo":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":t.lineTo(a[0],a[1]);break}}n.type==="fillPath"?t.fill(o):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,n,r,o,i){let a=this.gen.line(t,n,r,o,i);return this.draw(a),a}rectangle(t,n,r,o,i){let a=this.gen.rectangle(t,n,r,o,i);return this.draw(a),a}ellipse(t,n,r,o,i){let a=this.gen.ellipse(t,n,r,o,i);return this.draw(a),a}circle(t,n,r,o){let i=this.gen.circle(t,n,r,o);return this.draw(i),i}linearPath(t,n){let r=this.gen.linearPath(t,n);return this.draw(r),r}polygon(t,n){let r=this.gen.polygon(t,n);return this.draw(r),r}arc(t,n,r,o,i,a,s=!1,l){let c=this.gen.arc(t,n,r,o,i,a,s,l);return this.draw(c),c}curve(t,n){let r=this.gen.curve(t,n);return this.draw(r),r}path(t,n){let r=this.gen.path(t,n);return this.draw(r),r}};g();g();var no="http://www.w3.org/2000/svg";var _i=class{constructor(t,n){this.svg=t,this.gen=new nt(n)}draw(t){let n=t.sets||[],r=t.options||this.getDefaultOptions(),o=this.svg.ownerDocument||window.document,i=o.createElementNS(no,"g"),a=t.options.fixedDecimalPlaceDigits;for(let s of n){let l=null;switch(s.type){case"path":{l=o.createElementNS(no,"path"),l.setAttribute("d",this.opsToPath(s,a)),l.setAttribute("stroke",r.stroke),l.setAttribute("stroke-width",r.strokeWidth+""),l.setAttribute("fill","none"),r.strokeLineDash&&l.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break}case"fillPath":{l=o.createElementNS(no,"path"),l.setAttribute("d",this.opsToPath(s,a)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",r.fill||""),(t.shape==="curve"||t.shape==="polygon")&&l.setAttribute("fill-rule","evenodd");break}case"fillSketch":{l=this.fillSketch(o,s,r);break}}l&&i.appendChild(l)}return i}fillSketch(t,n,r){let o=r.fillWeight;o<0&&(o=r.strokeWidth/2);let i=t.createElementNS(no,"path");return i.setAttribute("d",this.opsToPath(n,r.fixedDecimalPlaceDigits)),i.setAttribute("stroke",r.fill||""),i.setAttribute("stroke-width",o+""),i.setAttribute("fill","none"),r.fillLineDash&&i.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&i.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,n){return this.gen.opsToPath(t,n)}line(t,n,r,o,i){let a=this.gen.line(t,n,r,o,i);return this.draw(a)}rectangle(t,n,r,o,i){let a=this.gen.rectangle(t,n,r,o,i);return this.draw(a)}ellipse(t,n,r,o,i){let a=this.gen.ellipse(t,n,r,o,i);return this.draw(a)}circle(t,n,r,o){let i=this.gen.circle(t,n,r,o);return this.draw(i)}linearPath(t,n){let r=this.gen.linearPath(t,n);return this.draw(r)}polygon(t,n){let r=this.gen.polygon(t,n);return this.draw(r)}arc(t,n,r,o,i,a,s=!1,l){let c=this.gen.arc(t,n,r,o,i,a,s,l);return this.draw(c)}curve(t,n){let r=this.gen.curve(t,n);return this.draw(r)}path(t,n){let r=this.gen.path(t,n);return this.draw(r)}};var Tt={canvas(e,t){return new Si(e,t)},svg(e,t){return new _i(e,t)},generator(e){return new nt(e)},newSeed(){return nt.newSeed()}};g();g();g();function Mu(e,t,n,r=o=>o){return e*r(.5-t*(.5-n))}function Ag(e){return[-e[0],-e[1]]}function ot(e,t){return[e[0]+t[0],e[1]+t[1]]}function $e(e,t){return[e[0]-t[0],e[1]-t[1]]}function rt(e,t){return[e[0]*t,e[1]*t]}function Sg(e,t){return[e[0]/t,e[1]/t]}function ro(e){return[e[1],-e[0]]}function Du(e,t){return e[0]*t[0]+e[1]*t[1]}function _g(e,t){return e[0]===t[0]&&e[1]===t[1]}function Ig(e){return Math.hypot(e[0],e[1])}function Pg(e){return e[0]*e[0]+e[1]*e[1]}function Cu(e,t){return Pg($e(e,t))}function Ou(e){return Sg(e,Ig(e))}function Mg(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function oo(e,t,n){let r=Math.sin(n),o=Math.cos(n),i=e[0]-t[0],a=e[1]-t[1],s=i*o-a*r,l=i*r+a*o;return[s+t[0],l+t[1]]}function hs(e,t,n){return ot(e,rt($e(t,e),n))}function Lu(e,t,n){return ot(e,rt(t,n))}var{min:cr,PI:Dg}=Math,ku=.275,io=Dg+1e-4;function Cg(e,t={}){let{size:n=16,smoothing:r=.5,thinning:o=.5,simulatePressure:i=!0,easing:a=L=>L,start:s={},end:l={},last:c=!1}=t,{cap:d=!0,easing:u=L=>L*(2-L)}=s,{cap:f=!0,easing:m=L=>--L*L*L+1}=l;if(e.length===0||n<=0)return[];let p=e[e.length-1].runningLength,h=s.taper===!1?0:s.taper===!0?Math.max(n,p):s.taper,E=l.taper===!1?0:l.taper===!0?Math.max(n,p):l.taper,x=Math.pow(n*r,2),w=[],v=[],T=e.slice(0,10).reduce((L,C)=>{let V=C.pressure;if(i){let $=cr(1,C.distance/n),de=cr(1,1-$);V=cr(1,L+(de-L)*($*ku))}return(L+V)/2},e[0].pressure),b=Mu(n,o,e[e.length-1].pressure,a),D,A=e[0].vector,S=e[0].point,I=S,P=S,_=I,M=!1;for(let L=0;L<e.length;L++){let{pressure:C}=e[L],{point:V,vector:$,distance:de,runningLength:fe}=e[L];if(L<e.length-1&&p-fe<3)continue;if(o){if(i){let ve=cr(1,de/n),Xe=cr(1,1-ve);C=cr(1,T+(Xe-T)*(ve*ku))}b=Mu(n,o,C,a)}else b=n/2;D===void 0&&(D=b);let ie=fe<h?u(fe/h):1,jt=p-fe<E?m((p-fe)/E):1;b=Math.max(.01,b*Math.min(ie,jt));let Un=(L<e.length-1?e[L+1]:e[L]).vector,Dt=L<e.length-1?Du($,Un):1,Ir=Du($,A)<0&&!M,Vn=Dt!==null&&Dt<0;if(Ir||Vn){let ve=rt(ro(A),b);for(let Xe=1/13,dt=0;dt<=1;dt+=Xe)P=oo($e(V,ve),V,io*dt),w.push(P),_=oo(ot(V,ve),V,io*-dt),v.push(_);S=P,I=_,Vn&&(M=!0);continue}if(M=!1,L===e.length-1){let ve=rt(ro($),b);w.push($e(V,ve)),v.push(ot(V,ve));continue}let $n=rt(ro(hs(Un,$,Dt)),b);P=$e(V,$n),(L<=1||Cu(S,P)>x)&&(w.push(P),S=P),_=ot(V,$n),(L<=1||Cu(I,_)>x)&&(v.push(_),I=_),T=C,A=$}let k=e[0].point.slice(0,2),U=e.length>1?e[e.length-1].point.slice(0,2):ot(e[0].point,[1,1]),G=[],B=[];if(e.length===1){if(!(h||E)||c){let L=Lu(k,Ou(ro($e(k,U))),-(D||b)),C=[];for(let V=1/13,$=V;$<=1;$+=V)C.push(oo(L,k,io*2*$));return C}}else{if(!(h||E&&e.length===1))if(d)for(let C=1/13,V=C;V<=1;V+=C){let $=oo(v[0],k,io*V);G.push($)}else{let C=$e(w[0],v[0]),V=rt(C,.5),$=rt(C,.51);G.push($e(k,V),$e(k,$),ot(k,$),ot(k,V))}let L=ro(Ag(e[e.length-1].vector));if(E||h&&e.length===1)B.push(U);else if(f){let C=Lu(U,L,b);for(let V=1/29,$=V;$<1;$+=V)B.push(oo(C,U,io*3*$))}else B.push(ot(U,rt(L,b)),ot(U,rt(L,b*.99)),$e(U,rt(L,b*.99)),$e(U,rt(L,b)))}return w.concat(B,v.reverse(),G)}function Lg(e,t={}){var n;let{streamline:r=.5,size:o=16,last:i=!1}=t;if(e.length===0)return[];let a=.15+(1-r)*.85,s=Array.isArray(e[0])?e:e.map(({x:m,y:p,pressure:h=.5})=>[m,p,h]);if(s.length===2){let m=s[1];s=s.slice(0,-1);for(let p=1;p<5;p++)s.push(hs(s[0],m,p/4))}s.length===1&&(s=[...s,[...ot(s[0],[1,1]),...s[0].slice(2)]]);let l=[{point:[s[0][0],s[0][1]],pressure:s[0][2]>=0?s[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],c=!1,d=0,u=l[0],f=s.length-1;for(let m=1;m<s.length;m++){let p=i&&m===f?s[m].slice(0,2):hs(u.point,s[m],a);if(_g(u.point,p))continue;let h=Mg(p,u.point);if(d+=h,m<f&&!c){if(d<o)continue;c=!0}u={point:p,pressure:s[m][2]>=0?s[m][2]:.5,vector:Ou($e(u.point,p)),distance:h,runningLength:d},l.push(u)}return l[0].vector=((n=l[1])==null?void 0:n.vector)||[0,0],l}function Ru(e,t={}){return Cg(Lg(e,t),t)}g();g();g();g();var ye=(e,t)=>[0,0,0,0,t,e,1,0];var Fu=(e,t)=>[0,0,0,0,t,e,0,0];var Ln=(e=0,t=0)=>{let n=[0,0,0,0,0,0,0,0];if(t<0||t>7)throw new Error(`Expected \`index\` between 0 and 7, got \`${t}\``);return e!==0&&(n[t]=e),n};var dr=e=>[e[0],e[1],e[2],e[3],-e[4],-e[5],-e[6],-e[7]];var Nu=(e,t)=>bs(t)?[e[0]+t,e[1],e[2],e[3],e[4],e[5],e[6],e[7]]:[e[0]+t[0],e[1]+t[1],e[2]+t[2],e[3]+t[3],e[4]+t[4],e[5]+t[5],e[6]+t[6],e[7]+t[7]],Es=(e,t)=>bs(t)?[e[0]-t,e[1],e[2],e[3],e[4],e[5],e[6],e[7]]:[e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3],e[4]-t[4],e[5]-t[5],e[6]-t[6],e[7]-t[7]],ln=(e,t)=>bs(t)?[e[0]*t,e[1]*t,e[2]*t,e[3]*t,e[4]*t,e[5]*t,e[6]*t,e[7]*t]:[kg(e,t),t[1]*e[0]+t[0]*e[1]-t[4]*e[2]+t[5]*e[3]+t[2]*e[4]-t[3]*e[5]-t[7]*e[6]-t[6]*e[7],t[2]*e[0]+t[0]*e[2]-t[6]*e[3]+t[3]*e[6],t[3]*e[0]+t[6]*e[2]+t[0]*e[3]-t[2]*e[6],t[4]*e[0]+t[2]*e[1]-t[1]*e[2]+t[7]*e[3]+t[0]*e[4]+t[6]*e[5]-t[5]*e[6]+t[3]*e[7],t[5]*e[0]-t[3]*e[1]+t[7]*e[2]+t[1]*e[3]-t[6]*e[4]+t[0]*e[5]+t[4]*e[6]+t[2]*e[7],t[6]*e[0]+t[3]*e[2]-t[2]*e[3]+t[0]*e[6],t[7]*e[0]+t[6]*e[1]+t[5]*e[2]+t[4]*e[3]+t[3]*e[4]+t[2]*e[5]+t[1]*e[6]+t[0]*e[7]],kg=(e,t)=>t[0]*e[0]+t[2]*e[2]+t[3]*e[3]-t[6]*e[6],gs=(e,t)=>[t[0]*e[0],t[1]*e[0]+t[0]*e[1],t[2]*e[0]+t[0]*e[2],t[3]*e[0]+t[0]*e[3],t[4]*e[0]+t[2]*e[1]-t[1]*e[2]+t[0]*e[4],t[5]*e[0]-t[3]*e[1]+t[1]*e[3]+t[0]*e[5],t[6]*e[0]+t[3]*e[2]-t[2]*e[3]+t[0]*e[6],t[7]*e[0]+t[6]*e[1]+t[5]*e[2]+t[4]*e[3]+t[3]*e[4]+t[2]*e[5]+t[1]*e[6]],Ii=(e,t)=>[xs(e,t),e[1]*t[7]+e[4]*t[5]-e[5]*t[4]+e[7]*t[1],e[2]*t[7]-e[4]*t[6]+e[6]*t[4]+e[7]*t[2],e[3]*t[7]+e[5]*t[6]-e[6]*t[5]+e[7]*t[3],e[4]*t[7]+e[7]*t[4],e[5]*t[7]+e[7]*t[5],e[6]*t[7]+e[7]*t[6],e[7]*t[7]],xs=(e,t)=>e[0]*t[7]+e[1]*t[6]+e[2]*t[5]+e[3]*t[4]+e[4]*t[3]+e[5]*t[2]+e[6]*t[1]+e[7]*t[0],Bu=(e,t)=>[t[0]*e[0]+t[2]*e[2]+t[3]*e[3]-t[6]*e[6],t[1]*e[0]+t[0]*e[1]-t[4]*e[2]+t[5]*e[3]+t[2]*e[4]-t[3]*e[5]-t[7]*e[6]-t[6]*e[7],t[2]*e[0]+t[0]*e[2]-t[6]*e[3]+t[3]*e[6],t[3]*e[0]+t[6]*e[2]+t[0]*e[3]-t[2]*e[6],t[4]*e[0]+t[7]*e[3]+t[0]*e[4]+t[3]*e[7],t[5]*e[0]+t[7]*e[2]+t[0]*e[5]+t[2]*e[7],t[6]*e[0]+t[0]*e[6],t[7]*e[0]+t[0]*e[7]],ws=e=>Math.sqrt(Math.abs(e[0]*e[0]-e[2]*e[2]-e[3]*e[3]+e[6]*e[6])),Gu=e=>Math.sqrt(Math.abs(e[7]*e[7]-e[5]*e[5]-e[4]*e[4]+e[1]*e[1])),kn=e=>{let t=ws(e);if(t===0||t===1)return e;let n=e[6]<0?-1:1;return ln(e,n/t)},zu=e=>{let t=Gu(e);return t===0||t===1?e:ln(e,1/t)},bs=e=>typeof e=="number",AT=Ln(1,1),ST=Ln(1,2),_T=Ln(1,3),IT=Ln(1,4),PT=Ln(1,5),MT=Ln(1,6),DT=Ln(1,7);g();g();var Pi=(e,t,n)=>kn([0,n,e,t,0,0,0,0]),ur=(e,t)=>kn(Ii(t,e)),Hu=(e,t)=>Bu(e,t),Uu=(e,t)=>Hu(ur(e,t),t);var Vu=e=>Math.sign(e[1]);var On=([e,t])=>[0,0,0,0,t,e,1,0],Rn=e=>[e[5],e[4]],Yu=e=>[0,0,0,0,Math.abs(e[4]),Math.abs(e[5]),1,0],Wu=(e,t)=>kn(gs(e,t));var ys=(e,t)=>ws(Ii(e,t)),cn=(e,t)=>xs(e,t);g();var vs=e=>[0,0,0,0,e[4],e[5],0,0],Xu=(e,t)=>zu([0,0,0,0,t[4]-e[4],t[5]-e[5],0,0]);g();var Ts=(e,t)=>Nu(ln(e,Math.sin(t/2)),Math.cos(t/2)),Ku=e=>[1,0,0,0,-(.5*e[5]),.5*e[4],0,0],ju=(e,t)=>{let n=.5*t;return[1,0,0,0,n*e[4],n*e[5],0,0]};var qu=(e,t)=>ln(t,e),it=(e,t)=>kn(ln(ln(e,t),dr(e)));g();g();var fr=1e-4;var Fg=e=>{let t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]},mr=e=>Fg(e)?e:[...e,e[0]],At=e=>e*180/Math.PI,Ng=e=>e/180*Math.PI;var Ju=(e,t)=>[e[0]*Math.cos(t)-e[1]*Math.sin(t),e[0]*Math.sin(t)+e[1]*Math.cos(t)],Bg=e=>e[0]===0&&e[1]===0,se=(e,t,n)=>{let r=Ng(t);return!n||Bg(n)?Ju(e,r):Ju(e.map((o,i)=>o-n[i]),r).map((o,i)=>o+n[i])};var Gg=e=>[-e[0],-e[1]],As=(e,t)=>[e[0]+t[0],e[1]+t[1]],zg=(e,t)=>Fe(...e,...t);var Qu=(e,t,n)=>{let r=As(e,Gg(t));return se(r,-At(n))};var Hg=(e,t)=>{let[n,r]=e,[[o,i],[a,s]]=t,l=n-o,c=r-i,d=a-o,u=s-i,f=l*d+c*u,m=d*d+u*u,p=-1;m!==0&&(p=f/m);let h,E;p<0?(h=o,E=i):p>1?(h=a,E=s):(h=o+p*d,E=i+p*u);let x=n-h,w=r-E;return Math.sqrt(x*x+w*w)},Fn=(e,t,n=fr)=>{let r=Hg(e,t);return r===0?!0:r<n},Ss=(e,t,n=fr)=>t.some(r=>Fn(e,r,n));var Ug=e=>{let[t,n,r,o]=e;return(i,a)=>Math.pow(1-i,3)*o[a]+3*i*Math.pow(1-i,2)*r[a]+3*Math.pow(i,2)*(1-i)*n[a]+t[a]*Math.pow(i,3)},Vg=(e,t=10)=>{let n=Ug(e),r=[n(0,0),n(0,1)],o=[],i=0,a=1/t;for(let s=0;s<t;s++)if(i+=a,i<=1){let l=[n(i,0),n(i,1)];o.push([r,l]),r=l}return o},_s=(e,t,n=fr)=>Ss(e,Vg(t),n),ef=(e,t,n=fr)=>t.some(r=>_s(e,r,n)),Is=(e,t)=>{let n=e[0],r=e[1],o=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){let s=t[i][0],l=t[i][1],c=t[a][0],d=t[a][1];(l>r&&d<=r||l<=r&&d>r)&&n<(c-s)*(r-l)/(d-l)+s&&(o=!o)}return o},tf=(e,t,n=fr)=>{let r=!1,o=mr(t);for(let i=0,a=o.length-1;i<a;i++)if(Fn(e,[o[i],o[i+1]],n)){r=!0;break}return r};var $g=(e,t)=>{let{angle:n,halfWidth:r,halfHeight:o,center:i}=t,a=r,s=o,[l,c]=Qu(e,i,n),d=Math.abs(l),u=Math.abs(c),f=.707,m=.707;for(let E=0;E<3;E++){let x=a*f,w=s*m,v=(a*a-s*s)*f**3/a,T=(s*s-a*a)*m**3/s,b=x-v,D=w-T,A=d-v,S=u-T,I=Math.hypot(D,b),P=Math.hypot(S,A);f=Math.min(1,Math.max(0,(A*I/P+v)/a)),m=Math.min(1,Math.max(0,(S*I/P+T)/s));let _=Math.hypot(m,f);f/=_,m/=_}let[p,h]=[a*f*Math.sign(l),s*m*Math.sign(c)];return zg([l,c],[p,h])},nf=(e,t,n=fr)=>$g(e,t)<=n,rf=(e,t)=>{let{center:n,angle:r,halfWidth:o,halfHeight:i}=t,[a,s]=Qu(e,n,r);return a/o*(a/o)+s/i*(s/i)<=1};var so=(e,t,n=0)=>{switch(t.type){case"polygon":return tf(e,t.data,n);case"ellipse":return nf(e,t.data,n);case"line":return Fn(e,t.data,n);case"polyline":return Ss(e,t.data,n);case"curve":return _s(e,t.data,n);case"polycurve":return ef(e,t.data,n);default:throw Error(`shape ${t} is not implemented`)}},Mi=(e,t)=>{switch(t.type){case"polygon":return Is(e,t.data);case"line":return!1;case"curve":return!1;case"ellipse":return rf(e,t.data);case"polyline":{let n=mr(t.data.flat());return Is(e,n)}case"polycurve":return!1;default:throw Error(`shape ${t} is not implemented`)}};g();g();var Yg=(e,t)=>{let[n,r,o,i]=t,{x:a,y:s}=os({sceneX:n,sceneY:r},e),{x:l,y:c}=os({sceneX:o,sceneY:i},e);return l-a>e.width||c-s>e.height},Wg=({scenePoint:e,viewportDimensions:t,zoom:n})=>({scrollX:t.width/2/n.value-e.x,scrollY:t.height/2/n.value-e.y}),Ms=(e,t)=>{if(e=of(e),!e.length)return{scrollX:0,scrollY:0};let[n,r,o,i]=De(e);Yg(t,[n,r,o,i])&&([n,r,o,i]=Ps(e,Xr({clientX:t.scrollX,clientY:t.scrollY},t)));let a=(n+o)/2,s=(r+i)/2;return Wg({scenePoint:{x:a,y:s},viewportDimensions:{width:t.width,height:t.height},zoom:t.zoom})};g();var Xg=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="line"||e==="freedraw",JT=e=>e!=="image"&&e!=="frame"&&e!=="magicframe",Zg=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="freedraw"||e==="arrow"||e==="line",Kg=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="arrow"||e==="line",Ds=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="arrow"||e==="line"||e==="diamond"||e==="image",jg=e=>e==="arrow",Cs=(e,t)=>{let n=null;for(let r=e.length-1;r>=0;--r){let o=e[r];if(!o.isDeleted&&t(o)){n=o;break}}return n};g();var qg=e=>Math.max(Wd,Math.min(e,30)),nA=({viewportX:e,viewportY:t,nextZoom:n},r)=>{let o=e-r.offsetLeft,i=t-r.offsetTop,a=r.zoom.value,s=r.scrollX+(o-o/a),l=r.scrollY+(i-i/a),c=-(o-o/n),d=-(i-i/n);return{scrollX:s+c,scrollY:l+d,zoom:{value:n}}};g();var mA={EQUAL:"Equal",MINUS:"Minus",NUM_ADD:"NumpadAdd",NUM_SUBTRACT:"NumpadSubtract",NUM_ZERO:"Numpad0",BRACKET_RIGHT:"BracketRight",BRACKET_LEFT:"BracketLeft",ONE:"Digit1",TWO:"Digit2",THREE:"Digit3",NINE:"Digit9",QUOTE:"Quote",ZERO:"Digit0",SLASH:"Slash",C:"KeyC",D:"KeyD",H:"KeyH",V:"KeyV",Z:"KeyZ",R:"KeyR",S:"KeyS"},Ne={ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",BACKSPACE:"Backspace",ALT:"Alt",CTRL_OR_CMD:Jo?"metaKey":"ctrlKey",DELETE:"Delete",ENTER:"Enter",ESCAPE:"Escape",QUESTION_MARK:"?",SPACE:" ",TAB:"Tab",CHEVRON_LEFT:"<",CHEVRON_RIGHT:">",PERIOD:".",COMMA:",",SUBTRACT:"-",SLASH:"/",A:"a",C:"c",D:"d",E:"e",F:"f",G:"g",H:"h",I:"i",L:"l",O:"o",P:"p",Q:"q",R:"r",S:"s",T:"t",V:"v",X:"x",Y:"y",Z:"z",K:"k",W:"w",0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},pA=e=>e===Ne.ARROW_LEFT||e===Ne.ARROW_RIGHT||e===Ne.ARROW_DOWN||e===Ne.ARROW_UP,hA=e=>e.altKey,EA=e=>e.shiftKey,Ls=e=>e.shiftKey;var DA=e=>!e[Ne.CTRL_OR_CMD],ks=e=>e.isBindingEnabled,tx=(e,t)=>{let n=[];return t.forEach(r=>{let o=e.getNonDeletedElement(r);o!=null&&n.push(o)}),n},Os=(e,t,n,r)=>{let o=new Set,i=new Set;af(e,t,n,"start",o,i,r),af(e,n,t,"end",o,i,r);let a=Array.from(i).filter(s=>!o.has(s));tx(fn.getScene(e),a).forEach(s=>{O(s,{boundElements:s.boundElements?.filter(l=>l.type!=="arrow"||l.id!==e.id)})})},af=(e,t,n,r,o,i,a)=>{if(t!=="keep"){if(t===null){let s=ax(e,r);s!=null&&i.add(s);return}uf(e)?(n==null||(n==="keep"?!df(e,t,r):r==="start"||n.id!==t.id))&&(Ci(e,t,r,a),o.add(t.id)):(Ci(e,t,r,a),o.add(t.id))}},nx=(e,t,n)=>{let r=n.scene.getNonDeletedElementsMap(),o=ff(e,t,r),i=t==="start"?e.startBinding?.elementId:e.endBinding?.elementId;if(i){let a=r.get(i);if(mf(a,o,n))return a}return null},cf=(e,t)=>["start","end"].map(n=>nx(e,n,t)),rx=(e,t,n,r)=>{let i=e.points.length-1,a=n.findIndex(d=>d===0)>-1,s=n.findIndex(d=>d===i)>-1,l=a?t?pr(e,"start",r):null:pr(e,"start",r),c=s?t?pr(e,"end",r):null:pr(e,"end",r);return[l,c]},ox=(e,t,n)=>{let[r,o]=cf(e,t),i=r&&n?pr(e,"start",t):null,a=o&&n?pr(e,"end",t):null;return[i,a]},CA=(e,t,n,r)=>{e.forEach(o=>{let[i,a]=r?.length?rx(o,n,r??[],t):ox(o,t,n);Os(o,i,a,t.scene.getNonDeletedElementsMap())})},LA=(e,t)=>e.length>50?[]:e.filter(J).flatMap(n=>cf(n,t)).filter(n=>n!==null).filter(n=>e.filter(r=>r.id===n?.id).length===0),kA=(e,t,n,r)=>{t.startBoundElement!=null&&Ci(e,t.startBoundElement,"start",r.scene.getNonDeletedElementsMap());let o=co(n,r);o!=null&&!df(e,o,"end")&&Ci(e,o,"end",r.scene.getNonDeletedElementsMap())},Ci=(e,t,n,r)=>{O(e,{[n==="start"?"startBinding":"endBinding"]:{elementId:t.id,...sx(e,t,n,r)}}),X(t.boundElements||[]).has(e.id)||O(t,{boundElements:(t.boundElements||[]).concat({id:e.id,type:"arrow"})})},df=(e,t,n)=>{let r=e[n==="start"?"endBinding":"startBinding"];return ix(e,r?.elementId,t)},ix=(e,t,n)=>t===n.id&&uf(e),uf=e=>e.points.length<3,ax=(e,t)=>{let n=t==="start"?"startBinding":"endBinding",r=e[n];return r==null?null:(O(e,{[n]:null}),r.elementId)},co=(e,t)=>Cs(t.scene.getNonDeletedElements(),r=>Mn(r,!1)&&mf(r,e,t)),sx=(e,t,n,r)=>{let o=n==="start"?-1:1,i=o===-1?0:e.points.length-1,a=i-o,s=K.getPointAtIndexGlobalCoordinates(e,i,r),l=K.getPointAtIndexGlobalCoordinates(e,a,r);return{focus:Ex(t,l,s,r),gap:Math.max(1,ux(t,s,r))}},St=(e,t,n)=>{let{newSize:r,simultaneouslyUpdated:o}=n??{},i=cx(o);Mn(e)&&Li(t,e,a=>{if(!J(a)||a.isDeleted||!lx(a,e))return;let s={startBinding:sf(e,a.startBinding,r),endBinding:sf(e,a.endBinding,r)};if(i.has(a.id)){O(a,s);return}ki(t,a,(c,d)=>{c&&Mn(c)&&(d==="startBinding"||d==="endBinding")&&dx(a,d,s[d],c,t)});let l=q(a,t);l&&!l.isDeleted&&Nn(a,t,!1)})},lx=(e,t)=>e.startBinding?.elementId===t.id||e.endBinding?.elementId===t.id,cx=e=>new Set((e||[]).map(t=>t.id)),dx=(e,t,n,r,o)=>{if(n==null||n.elementId!==r.id&&e.points.length>2)return;let i=t==="startBinding"?-1:1,a=i===-1?0:e.points.length-1,s=a-i,l=K.getPointAtIndexGlobalCoordinates(e,s,o),c=gx(r,n.focus,l,o),d;if(n.gap===0)d=c;else{let u=xx(r,l,c,n.gap,o);u.length===0?d=c:d=u[0]}K.movePoints(e,[{index:a,point:K.pointFromAbsoluteCoords(e,d,o)}],{[t]:n})},sf=(e,t,n)=>{if(t==null||n==null)return t;let{gap:r,focus:o,elementId:i}=t,{width:a,height:s}=n,{width:l,height:c}=e,d=Math.max(1,Math.min(pf(e,a,s),r*(a<s?a/l:s/c)));return{elementId:i,gap:d,focus:o}},pr=(e,t,n)=>co(ff(e,t,n.scene.getNonDeletedElementsMap()),n),ff=(e,t,n)=>{let r=t==="start"?0:-1;return or(K.getPointAtIndexGlobalCoordinates(e,r,n))},OA=(e,t,n,r)=>{let o=new Set,i=new Set,a=r==="duplicatesServeAsOld";t.forEach(s=>{let{boundElements:l}=s;if(l!=null&&l.length>0&&(l.forEach(c=>{a&&!n.has(c.id)&&o.add(c.id)}),i.add(n.get(s.id))),jr(s)){if(s.startBinding!=null){let{elementId:c}=s.startBinding;a&&!n.has(c)&&i.add(c)}if(s.endBinding!=null){let{elementId:c}=s.endBinding;a&&!n.has(c)&&i.add(c)}(s.startBinding!=null||s.endBinding!=null)&&o.add(n.get(s.id))}}),e.filter(({id:s})=>o.has(s)).forEach(s=>{let{startBinding:l,endBinding:c}=s;O(s,{startBinding:lf(l,n),endBinding:lf(c,n)})}),e.filter(({id:s})=>i.has(s)).forEach(s=>{let{boundElements:l}=s;l!=null&&l.length>0&&O(s,{boundElements:l.map(c=>n.has(c.id)?{id:n.get(c.id),type:c.type}:c)})})},lf=(e,t)=>{if(e==null)return null;let{elementId:n,focus:r,gap:o}=e;return{focus:r,gap:o,elementId:t.get(n)??n}},RA=(e,t)=>{let n=X(e);for(let r of t)dn.unbindAffected(n,r,O),un.unbindAffected(n,r,O)},lo=(e,t,n=[])=>{if(!e)return null;let r=e.filter(o=>!t.has(o.id));return r.push(...n.map(o=>({id:o.id,type:o.type}))),r},mf=(e,{x:t,y:n},r)=>{let o=pf(e,e.width,e.height),i=r.getElementShape(e);return so([t,n],i,o)},pf=(e,t,n)=>{let o=(e.type==="diamond"?1/Math.sqrt(2):1)*Math.min(t,n);return Math.max(16,Math.min(.25*o,32))},ux=(e,t,n)=>{switch(e.type){case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"magicframe":return fx(e,t,n);case"diamond":return mx(e,t,n);case"ellipse":return px(e,t,n)}},fx=(e,t,n)=>{let[,r,o,i]=Rs(e,t,n);return Math.max(cn(r,Pi(0,1,-i)),cn(r,Pi(1,0,-o)))},mx=(e,t,n)=>{let[,r,o,i]=Rs(e,t,n),a=Pi(i,o,-i*o);return cn(r,a)},px=(e,t,n)=>{let[r,o]=hx(e,t,n);return-Vu(o)*cn(r,o)},hx=(e,t,n)=>{let[,r,o,i]=Rs(e,t,n),[a,s]=Rn(r),l=.707,c=.707,d=o,u=i;[0,1,2,3].forEach(p=>{let h=d*l,E=u*c,x=(d*d-u*u)*l**3/d,w=(u*u-d*d)*c**3/u,v=h-x,T=E-w,b=a-x,D=s-w,A=Math.hypot(T,v),S=Math.hypot(D,b);l=Math.min(1,Math.max(0,(b*A/S+x)/d)),c=Math.min(1,Math.max(0,(D*A/S+w)/u));let I=Math.hypot(c,l);l/=I,c/=I});let f=ye(d*l,u*c),m=Uu(r,f);return[r,m]},Rs=(e,t,n)=>{let r=On(t),[o,i,a,s]=N(e,n),l=Ns(o,i,a,s),c=Ts(l,e.angle),d=it(c,r),u=Es(d,vs(l)),f=Yu(u),m=Fu(e.x,e.y),p=Es(d,m),h=(a-o)/2,E=(s-i)/2;return[p,f,h,E]},Fs=(e,t)=>{let[n,r,o,i]=N(e,t),a=Ns(n,r,o,i),s=Ts(a,e.angle),l=dr(Ku(vs(a)));return qu(s,l)},Ns=(e,t,n,r)=>ye((e+n)/2,(t+r)/2),Ex=(e,t,n,r)=>{let o=Fs(e,r),i=it(o,On(t)),a=it(o,On(n)),s=ur(i,a),l=e.height/e.width,c=e.width/2,d=e.height/2,u=s[2],f=s[3],m=s[1],p=Math.abs(f),h=Math.abs(u),E;switch(e.type){case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"magicframe":E=m/(c*(h+l*p));break;case"diamond":E=p<h?m/(h*c):m/(p*d);break;case"ellipse":E=m/(c*Math.sqrt(u**2+l**2*f**2));break}return E||0},gx=(e,t,n,r)=>{if(t===0){let[l,c,d,u]=N(e,r),f=Ns(l,c,d,u);return Rn(f)}let o=Fs(e,r),i=it(o,On(n)),a=dr(o),s;switch(e.type){case"rectangle":case"image":case"text":case"diamond":case"iframe":case"embeddable":case"frame":case"magicframe":s=Sx(e,t,i);break;case"ellipse":s=Ax(e,t,i);break}return Rn(it(a,s))},xx=(e,t,n,r=0,o)=>{let i=Fs(e,o),a=it(i,On(t)),s=it(i,On(n)),l=ur(a,s),c=dr(i);return wx(e,l,a,r).map(u=>Rn(it(c,u)))},wx=(e,t,n,r=0)=>{let o;switch(e.type){case"rectangle":case"image":case"text":case"diamond":case"iframe":case"embeddable":case"frame":case"magicframe":let a=hf(e);o=a.flatMap((s,l)=>{let c=[s,a[(l+1)%4]];return bx(t,yx(c,r))}).concat(a.flatMap(s=>Tx(s,r,t)));break;case"ellipse":o=vx(e,r,t);break}if(o.length<2)return[];let i=o.sort((a,s)=>ys(a,n)-ys(s,n));return[i[0],i[i.length-1]]},hf=(e,t=1)=>{let n=t*e.width/2,r=t*e.height/2;switch(e.type){case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"magicframe":return[ye(n,r),ye(n,-r),ye(-n,-r),ye(-n,r)];case"diamond":return[ye(0,r),ye(n,0),ye(0,-r),ye(-n,0)]}},bx=(e,t)=>{let[n,r]=t,o=cn(n,e),i=cn(r,e);return o*i>=0?[]:[Wu(e,ur(n,r))]},yx=(e,t)=>{let[n,r]=e,o=ju(Xu(n,r),t);return[it(o,n),it(o,r)]},vx=(e,t,n)=>{let r=e.width/2+t,o=e.height/2+t,i=n[2],a=n[3],s=n[1],l=r*r*i*i+o*o*a*a,c=l-s*s;if(l===0||c<=0)return[];let d=Math.sqrt(c),u=-r*r*i*s,f=-o*o*a*s;return[ye((u+r*o*a*d)/l,(f-r*o*i*d)/l),ye((u-r*o*a*d)/l,(f+r*o*i*d)/l)]},Tx=(e,t,n)=>{if(t===0)return cn(n,e)===0?[e]:[];let r=n[2],o=n[3],i=n[1],[a,s]=Rn(e),l=t,c=r*r+o*o,d=l*l*c-(r*a+o*s+i)**2;if(c===0||d<=0)return[];let u=Math.sqrt(d),f=a*o*o-s*r*o-r*i,m=s*r*r-a*r*o-o*i;return[ye((f+o*u)/c,(m-r*u)/c),ye((f-o*u)/c,(m+r*u)/c)]},Ax=(e,t,n)=>{let r=Math.abs(t),o=e.width*r/2,i=e.height*r/2,a=Math.sign(t),[s,l]=Rn(n),c=l===0?1e-4:l,d=s**2*i**2+c**2*o**2,u=(-s*i**2+a*c*Math.sqrt(Math.max(0,d-o**2*i**2)))/d,f=(-u*s-1)/c;f===0&&(f=(Object.is(f,-0)?-1:1)*.01);let m=-(o**2*u)/(f**2*i**2+u**2*o**2);return ye(m,(-u*m-1)/f)},Sx=(e,t,n)=>{let r=Math.abs(t),o=Math.sign(t),i=hf(e,r),a=0,s=null;return i.forEach(l=>{let c=o*ur(n,l)[1];c>a&&(a=c,s=l)}),s},Ef=new Set(["boundElements","frameId","containerId","startBinding","endBinding"]),Li=(e,t,n)=>{Mn(t)&&(t.boundElements?.slice()??[]).forEach(({id:o})=>{n(e.get(o),"boundElements",o)})},ki=(e,t,n)=>{if(t.frameId){let r=t.frameId;n(e.get(r),"frameId",r)}if(be(t)){let r=t.containerId;n(e.get(r),"containerId",r)}if(j(t)){if(t.startBinding){let r=t.startBinding.elementId;n(e.get(r),"startBinding",r)}if(t.endBinding){let r=t.endBinding.elementId;n(e.get(r),"endBinding",r)}}},dn=class{static unbindAffected(t,n,r){n&&ki(t,n,o=>{!o||o.isDeleted||Li(t,o,(i,a,s)=>{s===n.id&&r(o,{boundElements:lo(o.boundElements,new Set([s]))})})})}static rebindAffected=(t,n,r)=>{!n||n.isDeleted||ki(t,n,(o,i)=>{if(!o||o.isDeleted){r(n,{[i]:null});return}i!=="frameId"&&(o.boundElements?.find(a=>a.id===n.id)||(j(n)&&r(o,{boundElements:lo(o.boundElements,new Set,new Array(n))}),Y(n)&&(o.boundElements?.find(a=>a.type==="text")?r(n,{[i]:null}):r(o,{boundElements:lo(o.boundElements,new Set,new Array(n))}))))})}},un=class{static unbindAffected(t,n,r){n&&Li(t,n,o=>{!o||o.isDeleted||ki(t,o,(i,a,s)=>{s===n.id&&r(o,{[a]:null})})})}static rebindAffected=(t,n,r)=>{!n||n.isDeleted||Li(t,n,(o,i,a)=>{if(!o||o.isDeleted){r(n,{boundElements:lo(n.boundElements,new Set([a]))});return}Y(o)&&((n.boundElements?.slice()??[]).reverse().find(l=>l.type==="text")?.id===o.id?o.containerId!==n.id&&r(o,{containerId:n.id}):(o.containerId!==null&&r(o,{containerId:null}),r(n,{boundElements:lo(n.boundElements,new Set([o.id]))})))})}};g();var le=class e{static rg=new nt;static cache=new WeakMap;static get=t=>e.cache.get(t);static set=(t,n)=>e.cache.set(t,n);static delete=t=>e.cache.delete(t);static destroy=()=>{e.cache=new WeakMap};static generateElementShape=(t,n)=>{let r=n?.isExporting?void 0:e.get(t);if(r!==void 0)return r;Oi.delete(t);let o=gf(t,e.rg,n||{isExporting:!1,canvasBackgroundColor:z.white,embedsValidationStatus:null});return e.cache.set(t,o),o}};var Ht={version:null,points:[],zoom:null},K=class e{elementId;selectedPointsIndices;pointerDownState;isDragging;lastUncommittedPoint;pointerOffset;startBindingElement;endBindingElement;hoverPointIndex;segmentMidPointHoveredCoords;constructor(t){this.elementId=t.id,e.normalizePoints(t),this.selectedPointsIndices=null,this.lastUncommittedPoint=null,this.isDragging=!1,this.pointerOffset={x:0,y:0},this.startBindingElement="keep",this.endBindingElement="keep",this.pointerDownState={prevSelectedPointsIndices:null,lastClickedPoint:-1,origin:null,segmentMidpoint:{value:null,index:null,added:!1}},this.hoverPointIndex=-1,this.segmentMidPointHoveredCoords=null}static POINT_HANDLE_SIZE=10;static getElement(t,n){let r=n.get(t);return r||null}static handleBoxSelection(t,n,r,o){if(!n.editingLinearElement||n.draggingElement?.type!=="selection")return!1;let{editingLinearElement:i}=n,{selectedPointsIndices:a,elementId:s}=i,l=e.getElement(s,o);if(!l)return!1;let[c,d,u,f]=N(n.draggingElement,o),p=e.getPointsGlobalCoordinates(l,o).reduce((h,E,x)=>((E[0]>=c&&E[0]<=u&&E[1]>=d&&E[1]<=f||t.shiftKey&&a?.includes(x))&&h.push(x),h),[]);r({editingLinearElement:{...i,selectedPointsIndices:p.length?p:null}})}static handlePointDragging(t,n,r,o,i,a,s){if(!a)return!1;let{selectedPointsIndices:l,elementId:c}=a,d=e.getElement(c,s);if(!d)return!1;let u=d.points[a.pointerDownState.lastClickedPoint];if(l&&u){if(Ls(t)&&l.length===1&&d.points.length>1){let m=l[0],p=d.points[m===0?1:m-1],[h,E]=e._getShiftLockedDelta(d,s,p,[r,o],t[Ne.CTRL_OR_CMD]?null:n.gridSize);e.movePoints(d,[{index:m,point:[h+p[0],E+p[1]],isDragging:m===a.pointerDownState.lastClickedPoint}])}else{let m=e.createPointAt(d,s,r-a.pointerOffset.x,o-a.pointerOffset.y,t[Ne.CTRL_OR_CMD]?null:n.gridSize),p=m[0]-u[0],h=m[1]-u[1];e.movePoints(d,l.map(E=>{let x=E===a.pointerDownState.lastClickedPoint?e.createPointAt(d,s,r-a.pointerOffset.x,o-a.pointerOffset.y,t[Ne.CTRL_OR_CMD]?null:n.gridSize):[d.points[E][0]+p,d.points[E][1]+h];return{index:E,point:x,isDragging:E===a.pointerDownState.lastClickedPoint}}))}if(q(d,s)&&Nn(d,s,!1),jr(d,!1)){let m=[];l[0]===0&&m.push(or(e.getPointGlobalCoordinates(d,d.points[0],s)));let h=l[l.length-1];h===d.points.length-1&&m.push(or(e.getPointGlobalCoordinates(d,d.points[h],s))),m.length&&i(d,m)}return!0}return!1}static handlePointerUp(t,n,r,o){let i=o.scene.getNonDeletedElementsMap(),{elementId:a,selectedPointsIndices:s,isDragging:l,pointerDownState:c}=n,d=e.getElement(a,i);if(!d)return n;let u={};if(l&&s){for(let f of s)if(f===0||f===d.points.length-1){_t(d.points,r.zoom.value)&&e.movePoints(d,[{index:f,point:f===0?d.points[d.points.length-1]:d.points[0]}]);let m=ks(r)?co(or(e.getPointAtIndexGlobalCoordinates(d,f,i)),o):null;u[f===0?"startBindingElement":"endBindingElement"]=m}}return{...n,...u,selectedPointsIndices:l||t.shiftKey?!l&&t.shiftKey&&c.prevSelectedPointsIndices?.includes(c.lastClickedPoint)?s&&s.filter(f=>f!==c.lastClickedPoint):s:s?.includes(c.lastClickedPoint)?[c.lastClickedPoint]:s,isDragging:!1,pointerOffset:{x:0,y:0}}}static getEditorMidPoints=(t,n,r)=>{let o=q(t,n);return!r.editingLinearElement&&t.points.length>2&&!o?[]:(Ht.version===t.version&&Ht.zoom===r.zoom.value||e.updateEditorMidPointsCache(t,n,r),Ht.points)};static updateEditorMidPointsCache=(t,n,r)=>{let o=e.getPointsGlobalCoordinates(t,n),i=0,a=[];for(;i<o.length-1;){if(e.isSegmentTooShort(t,t.points[i],t.points[i+1],r.zoom)){a.push(null),i++;continue}let s=e.getSegmentMidPoint(t,o[i],o[i+1],i+1,n);a.push(s),i++}Ht.points=a,Ht.version=t.version,Ht.zoom=r.zoom.value};static getSegmentMidpointHitCoords=(t,n,r,o)=>{let{elementId:i}=t,a=e.getElement(i,o);if(!a||e.getPointIndexUnderCursor(a,o,r.zoom,n.x,n.y)>=0||e.getPointsGlobalCoordinates(a,o).length>=3&&!r.editingLinearElement)return null;let c=e.POINT_HANDLE_SIZE/r.zoom.value,d=t.segmentMidPointHoveredCoords;if(d&&Fe(d[0],d[1],n.x,n.y)<=c)return d;let u=0,f=e.getEditorMidPoints(a,o,r);for(;u<f.length;){if(f[u]!==null&&Fe(f[u][0],f[u][1],n.x,n.y)<=c)return f[u];u++}return null};static isSegmentTooShort(t,n,r,o){let i=Fe(n[0],n[1],r[0],r[1]);return t.points.length>2&&t.roundness&&(i=xf(t,r)),i*o.value<e.POINT_HANDLE_SIZE*4}static getSegmentMidPoint(t,n,r,o,i){let a=uo(n,r);if(t.points.length>2&&t.roundness){let s=Gs(t,t.points[o]);if(s){let l=wf(t,t.points[o],.5),[c,d]=zs(s[0],s[1],s[2],s[3],l);a=e.getPointGlobalCoordinates(t,[c,d],i)}}return a}static getSegmentMidPointIndex(t,n,r,o){let i=e.getElement(t.elementId,o);if(!i)return-1;let a=e.getEditorMidPoints(i,o,n),s=0;for(;s<a.length;){if(e.arePointsEqual(r,a[s]))return s+1;s++}return-1}static handlePointerDown(t,n,r,o,i,a){let s=a.scene.getNonDeletedElementsMap(),l={didAddPoint:!1,hitElement:null,linearElementEditor:null};if(!i)return l;let{elementId:c}=i,d=e.getElement(c,s);if(!d)return l;let u=e.getSegmentMidpointHitCoords(i,o,n,s),f=null;if(u&&(f=e.getSegmentMidPointIndex(i,n,u,s)),t.altKey&&n.editingLinearElement)return i.lastUncommittedPoint==null&&(O(d,{points:[...d.points,e.createPointAt(d,s,o.x,o.y,t[Ne.CTRL_OR_CMD]?null:n.gridSize)]}),l.didAddPoint=!0),r.shouldCaptureIncrement(),l.linearElementEditor={...i,pointerDownState:{prevSelectedPointsIndices:i.selectedPointsIndices,lastClickedPoint:-1,origin:{x:o.x,y:o.y},segmentMidpoint:{value:u,index:f,added:!1}},selectedPointsIndices:[d.points.length-1],lastUncommittedPoint:null,endBindingElement:co(o,a)},l.didAddPoint=!0,l;let m=e.getPointIndexUnderCursor(d,s,n.zoom,o.x,o.y);if(m>=0||u)l.hitElement=d;else{let{startBindingElement:D,endBindingElement:A}=i;ks(n)&&jr(d)&&Os(d,D,A,s)}let[p,h,E,x]=N(d,s),w=(p+E)/2,v=(h+x)/2,T=m>-1&&H(d.x+d.points[m][0],d.y+d.points[m][1],w,v,d.angle),b=m>-1||t.shiftKey?t.shiftKey||i.selectedPointsIndices?.includes(m)?_x([...i.selectedPointsIndices||[],m]):[m]:null;return l.linearElementEditor={...i,pointerDownState:{prevSelectedPointsIndices:i.selectedPointsIndices,lastClickedPoint:m,origin:{x:o.x,y:o.y},segmentMidpoint:{value:u,index:f,added:!1}},selectedPointsIndices:b,pointerOffset:T?{x:o.x-T[0],y:o.y-T[1]}:{x:0,y:0}},l}static arePointsEqual(t,n){return!t&&!n?!0:!t||!n?!1:Hs(t,n)}static handlePointerMove(t,n,r,o,i){if(!o.editingLinearElement)return null;let{elementId:a,lastUncommittedPoint:s}=o.editingLinearElement,l=e.getElement(a,i);if(!l)return o.editingLinearElement;let{points:c}=l,d=c[c.length-1];if(!t.altKey)return d===s&&e.deletePoints(l,[c.length-1]),{...o.editingLinearElement,lastUncommittedPoint:null};let u;if(Ls(t)&&c.length>=2){let f=c[c.length-2],[m,p]=e._getShiftLockedDelta(l,i,f,[n,r],t[Ne.CTRL_OR_CMD]?null:o.gridSize);u=[m+f[0],p+f[1]]}else u=e.createPointAt(l,i,n-o.editingLinearElement.pointerOffset.x,r-o.editingLinearElement.pointerOffset.y,t[Ne.CTRL_OR_CMD]?null:o.gridSize);return d===s?e.movePoints(l,[{index:l.points.length-1,point:u}]):e.addPoints(l,o,[{point:u}]),{...o.editingLinearElement,lastUncommittedPoint:l.points[l.points.length-1]}}static getPointGlobalCoordinates(t,n,r){let[o,i,a,s]=N(t,r),l=(o+a)/2,c=(i+s)/2,{x:d,y:u}=t;return[d,u]=H(d+n[0],u+n[1],l,c,t.angle),[d,u]}static getPointsGlobalCoordinates(t,n){let[r,o,i,a]=N(t,n),s=(r+i)/2,l=(o+a)/2;return t.points.map(c=>{let{x:d,y:u}=t;return[d,u]=H(d+c[0],u+c[1],s,l,t.angle),[d,u]})}static getPointAtIndexGlobalCoordinates(t,n,r){let o=n<0?t.points.length+n:n,[i,a,s,l]=N(t,r),c=(i+s)/2,d=(a+l)/2,u=t.points[o],{x:f,y:m}=t;return u?H(f+u[0],m+u[1],c,d,t.angle):H(f,m,c,d,t.angle)}static pointFromAbsoluteCoords(t,n,r){let[o,i,a,s]=N(t,r),l=(o+a)/2,c=(i+s)/2,[d,u]=H(n[0],n[1],l,c,-t.angle);return[d-t.x,u-t.y]}static getPointIndexUnderCursor(t,n,r,o,i){let a=e.getPointsGlobalCoordinates(t,n),s=a.length;for(;--s>-1;){let l=a[s];if(Fe(o,i,l[0],l[1])*r.value<e.POINT_HANDLE_SIZE+1)return s}return-1}static createPointAt(t,n,r,o,i){let a=fo(r,o,i),[s,l,c,d]=N(t,n),u=(s+c)/2,f=(l+d)/2,[m,p]=H(a[0],a[1],u,f,-t.angle);return[m-t.x,p-t.y]}static getNormalizedPoints(t){let{points:n}=t,r=n[0][0],o=n[0][1];return{points:n.map((i,a)=>[i[0]-r,i[1]-o]),x:t.x+r,y:t.y+o}}static normalizePoints(t){O(t,e.getNormalizedPoints(t))}static duplicateSelectedPoints(t,n){if(!t.editingLinearElement)return!1;let{selectedPointsIndices:r,elementId:o}=t.editingLinearElement,i=e.getElement(o,n);if(!i||r===null)return!1;let{points:a}=i,s=[],l=!1,c=-1,d=a.reduce((u,f,m)=>{if(++c,u.push(f),r.includes(m)){let h=a[m+1];h||(l=!0),u.push(h?[(f[0]+h[0])/2,(f[1]+h[1])/2]:[f[0],f[1]]),s.push(c+1),++c}return u},[]);if(O(i,{points:d}),l){let u=i.points[i.points.length-1];e.movePoints(i,[{index:i.points.length-1,point:[u[0]+30,u[1]+30]}])}return{appState:{...t,editingLinearElement:{...t.editingLinearElement,selectedPointsIndices:s}}}}static deletePoints(t,n){let r=0,o=0;if(n.includes(0)){let s=t.points.find((l,c)=>!n.includes(c));s&&(r=s[0],o=s[1])}let a=t.points.reduce((s,l,c)=>(n.includes(c)||s.push(s.length?[l[0]-r,l[1]-o]:[0,0]),s),[]);e._updatePoints(t,a,r,o)}static addPoints(t,n,r){let a=[...t.points,...r.map(s=>s.point)];e._updatePoints(t,a,0,0)}static movePoints(t,n,r){let{points:o}=t,i=0,a=0,s=n.find(({index:c})=>c===0);s&&(i=s.point[0]+o[s.index][0],a=s.point[1]+o[s.index][1]);let l=o.map((c,d)=>{let u=n.find(f=>f.index===d);if(u){if(s)return c;let f=u.point[0]-o[u.index][0],m=u.point[1]-o[u.index][1];return[c[0]+f,c[1]+m]}return i||a?[c[0]-i,c[1]-a]:c});e._updatePoints(t,l,i,a,r)}static shouldAddMidpoint(t,n,r,o){if(!e.getElement(t.elementId,o))return!1;let{segmentMidpoint:a}=t.pointerDownState;if(a.added||a.value===null||a.index===null||t.pointerDownState.origin===null)return!1;let s=t.pointerDownState.origin,l=Fe(s.x,s.y,n.x,n.y);return!(!r.editingLinearElement&&l<Vd/r.zoom.value)}static addMidpoint(t,n,r,o,i){let a=e.getElement(t.elementId,i);if(!a)return;let{segmentMidpoint:s}=t.pointerDownState,l={pointerDownState:t.pointerDownState,selectedPointsIndices:t.selectedPointsIndices},c=e.createPointAt(a,i,n.x,n.y,o?r.gridSize:null),d=[...a.points.slice(0,s.index),c,...a.points.slice(s.index)];return O(a,{points:d}),l.pointerDownState={...t.pointerDownState,segmentMidpoint:{...t.pointerDownState.segmentMidpoint,added:!0},lastClickedPoint:s.index},l.selectedPointsIndices=[s.index],l}static _updatePoints(t,n,r,o,i){let a=Bs(t,n),s=Bs(t,t.points),l=(a[0]+a[2])/2,c=(a[1]+a[3])/2,d=(s[0]+s[2])/2,u=(s[1]+s[3])/2,f=d-l,m=u-c,p=H(r,o,f,m,t.angle);O(t,{...i,points:n,x:t.x+p[0],y:t.y+p[1]})}static _getShiftLockedDelta(t,n,r,o,i){let a=e.getPointGlobalCoordinates(t,r,n),[s,l]=fo(o[0],o[1],i),{width:c,height:d}=Us(a[0],a[1],s,l);return ce([c,d],[0,0],-t.angle)}static getBoundTextElementPosition=(t,n,r)=>{let o=e.getPointsGlobalCoordinates(t,r);o.length<2&&O(n,{isDeleted:!0});let i=0,a=0;if(t.points.length%2===1){let s=Math.floor(t.points.length/2),l=e.getPointGlobalCoordinates(t,t.points[s],r);i=l[0]-n.width/2,a=l[1]-n.height/2}else{let s=t.points.length/2-1,l=Ht.points[s];t.points.length===2&&(l=uo(o[0],o[1])),(!l||Ht.version!==t.version)&&(l=e.getSegmentMidPoint(t,o[s],o[s+1],s+1,r)),i=l[0]-n.width/2,a=l[1]-n.height/2}return{x:i,y:a}};static getMinMaxXYWithBoundText=(t,n,r,o)=>{let[i,a,s,l]=r,c=(i+s)/2,d=(a+l)/2,{x:u,y:f}=e.getBoundTextElementPosition(t,o,n),m=u+o.width,p=f+o.height,h=ce([i,a],[c,d],t.angle),E=ce([s,a],[c,d],t.angle),x=ce([u,f],[c,d],-t.angle),w=ce([m,f],[c,d],-t.angle),v=ce([u,p],[c,d],-t.angle),T=ce([m,p],[c,d],-t.angle);return h[0]<E[0]&&h[1]>=E[1]?(i=Math.min(i,v[0]),s=Math.max(s,Math.max(w[0],T[0])),a=Math.min(a,x[1]),l=Math.max(l,T[1])):h[0]>=E[0]&&h[1]>E[1]?(i=Math.min(i,T[0]),s=Math.max(s,Math.max(x[0],w[0])),a=Math.min(a,v[1]),l=Math.max(l,w[1])):h[0]>=E[0]?(i=Math.min(i,w[0]),s=Math.max(s,v[0]),a=Math.min(a,T[1]),l=Math.max(l,x[1])):h[1]<=E[1]&&(i=Math.min(i,Math.min(w[0],x[0])),s=Math.max(s,T[0]),a=Math.min(a,w[1]),l=Math.max(l,v[1])),[i,a,s,l,c,d]};static getElementAbsoluteCoords=(t,n,r=!1)=>{let o,i,a,s,l;if(t.points.length<2||!le.get(t)){let{minX:f,minY:m,maxX:p,maxY:h}=t.points.reduce((E,[x,w])=>(E.minY=Math.min(E.minY,w),E.minX=Math.min(E.minX,x),E.maxX=Math.max(E.maxX,x),E.maxY=Math.max(E.maxY,w),E),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});i=f+t.x,a=m+t.y,s=p+t.x,l=h+t.y}else{let f=le.generateElementShape(t,null),m=mn(f[0]),[p,h,E,x]=mo(m);i=p+t.x,a=h+t.y,s=E+t.x,l=x+t.y}let c=(i+s)/2,d=(a+l)/2;if(o=[i,a,s,l,c,d],!r)return o;let u=q(t,n);return u&&(o=e.getMinMaxXYWithBoundText(t,n,[i,a,s,l],u)),o}},_x=e=>{let t=[...new Set(e.filter(n=>n!==null&&n!==-1))];return t=t.sort((n,r)=>n-r),t.length?t:null};g();var po={},bf=(e,t)=>{let n=po[e]||(po[e]={height:t});return n.height=t,n},yf=e=>{po[e]&&delete po[e]},oS=e=>po[e]?.height??null;var Ws=e=>fu(e).replace(/\t/g,"        "),Xs=e=>Ws(e).split(`
`),Zs=(e,t,n,r=!0)=>{let o,i={x:e.x,y:e.y,text:e.text,width:e.width,height:e.height,angle:t?.angle??e.angle};i.text=e.text,t&&(o=st(t,e),i.text=Er(e.originalText,Ee(e),o));let a=Bn(i.text,Ee(e),e.lineHeight);if(i.width=a.width,i.height=a.height,t){let s=Eo(t,e),l=st(t,e);if(!j(t)&&a.height>s){let f=Ys(a.height,t.type);O(t,{height:f},r),bf(t.id,f)}if(a.width>l){let f=Ys(a.width,t.type);O(t,{width:f},r)}let c={...e,...i},{x:d,y:u}=Tf(t,c,n);i.x=d,i.y=u}O(e,i,r)},pS=(e,t,n)=>{let r=X(e);t.forEach(o=>{let i=n.get(o.id),a=Ut(o);if(a){let s=n.get(a);if(s){let l=r.get(i);l&&O(l,{boundElements:(o.boundElements||[]).filter(d=>d.id!==s&&d.id!==a).concat({type:"text",id:s})});let c=r.get(s);c&&Y(c)&&O(c,{containerId:l?i:null})}}})},Nn=(e,t,n,r=!1)=>{if(!Ut(e))return;yf(e.id);let i=q(e,t);if(i&&i.text){if(!e)return;let a=i.text,s=i.height,l=i.width,c=st(e,i),d=Eo(e,i),u=e.height;if(r||n!=="n"&&n!=="s"){a&&(a=Er(i.originalText,Ee(i),c));let f=Bn(a,Ee(i),i.lineHeight);s=f.height,l=f.width}if(s>d){u=Ys(s,e.type);let f=u-e.height,m=!j(e)&&(n==="ne"||n==="nw"||n==="n")?e.y-f:e.y;O(e,{height:u,y:m})}O(i,{text:a,width:l,height:s}),j(e)||O(i,Tf(e,i,t))}},Tf=(e,t,n)=>{if(j(e))return K.getBoundTextElementPosition(e,t,n);let r=js(e),o=Eo(e,t),i=st(e,t),a,s;return t.verticalAlign===Rt.TOP?s=r.y:t.verticalAlign===Rt.BOTTOM?s=r.y+(o-t.height):s=r.y+(o/2-t.height/2),t.textAlign===ts.LEFT?a=r.x:t.textAlign===ts.RIGHT?a=r.x+(i-t.width):a=r.x+(i/2-t.width/2),{x:a,y:s}},Bn=(e,t,n)=>{e=e.split(`
`).map(a=>a||" ").join(`
`);let r=parseFloat(t),o=Ix(e,r,n);return{width:Ks(e,t),height:o}},Af=e=>{let t=Xs(e.text).length;return e.height/t/e.fontSize},hr=(e,t)=>e*t,Ri=(e,t,n)=>{let{unitsPerEm:r,ascender:o,descender:i}=vf[e]||vf[pe.Helvetica],a=t/r,s=n-a*o+a*i;return a*o+s},Sf=(e,t)=>hr(e,t)+he*2,Vs,ho=(e,t)=>{Vs||(Vs=document.createElement("canvas"));let n=Vs.getContext("2d");n.font=t;let r=n.measureText(e).width;return Nt()?r*10:r},Ks=(e,t)=>{let n=Xs(e),r=0;return n.forEach(o=>{r=Math.max(r,ho(o,t))}),r},Ix=(e,t,n)=>{let r=Xs(e).length;return hr(t,n)*r},Px=e=>{let t=e.split("-");return t.length>1&&t.forEach((n,r)=>{r!==t.length-1&&(t[r]=n+="-")}),t.join(" ").split(" ")},Er=(e,t,n)=>{if(!Number.isFinite(n)||n<0)return e;let r=[],o=e.split(`
`),i=ho(" ",t),a="",s=0,l=d=>{d.trim()&&r.push(d)},c=()=>{a="",s=0};return o.forEach(d=>{if(Ks(d,t)<=n){r.push(d);return}let f=Px(d);c();let m=0;for(;m<f.length;){let p=ho(f[m],t);if(p===n)l(f[m]),m++;else if(p>n){for(l(a),c();f[m].length>0;){let h=String.fromCodePoint(f[m].codePointAt(0)),E=_f.calculate(h,t);s+=E,f[m]=f[m].slice(h.length),s>=n?(l(a),a=h,s=E):a+=h}s+i>=n?(l(a),c()):a.endsWith("-")||(a+=" ",s+=i),m++}else for(;s<n&&m<f.length;){let h=f[m];if(s=ho(a+h,t),s>n){l(a),c();break}m++;let E=!h.endsWith("-");if(a+=h,E&&(a+=" "),s+i>=n){E?r.push(a.slice(0,-1)):r.push(a),c();break}}}a.slice(-1)===" "&&(a=a.slice(0,-1),l(a))}),r.join(`
`)},_f=(()=>{let e={};return{calculate:(r,o)=>{let i=r.charCodeAt(0);if(e[o]||(e[o]=[]),!e[o][i]){let a=ho(r,o);e[o][i]=a}return e[o][i]},getCache:r=>e[r]}})(),If="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".toLocaleUpperCase(),Pf=(e,t)=>{let n=Mx(e);return n===0?Bn(If.split("").join(`
`),e,t).width+he*2:n+he*2};var Mx=e=>{let t=_f.getCache(e);if(!t)return 0;let n=t.filter(r=>r!==void 0);return Math.max(...n)};var Ut=e=>e?.boundElements?.length&&e?.boundElements?.filter(t=>t.type==="text")[0]?.id||null,q=(e,t)=>{if(!e)return null;let n=Ut(e);return n&&t.get(n)||null},Se=(e,t)=>e&&e.containerId&&t.get(e.containerId)||null,hS=(e,t,n)=>{if(!j(e))return{x:e.x+e.width/2,y:e.y+e.height/2};let r=K.getPointsGlobalCoordinates(e,n);if(r.length%2===1){let a=Math.floor(e.points.length/2),s=K.getPointGlobalCoordinates(e,e.points[a],n);return{x:s[0],y:s[1]}}let o=e.points.length/2-1,i=K.getEditorMidPoints(e,n,t)[o];return i||(i=K.getSegmentMidPoint(e,r[o],r[o+1],o+1,n)),{x:i[0],y:i[1]}},js=e=>{let t=he,n=he;return e.type==="ellipse"&&(t+=e.width/2*(1-Math.sqrt(2)/2),n+=e.height/2*(1-Math.sqrt(2)/2)),e.type==="diamond"&&(t+=e.width/4,n+=e.height/4),{x:e.x+t,y:e.y+n}},ES=(e,t)=>!t||j(t)?e.angle:t.angle;var gS=(e,t)=>e.some(n=>{if(be(n)){let r=Se(n,t);return!j(r)}return!1}),xS=(e,t)=>e.some(n=>{if(be(n)){let r=Se(n,t);return!j(r)}return Y(n)}),Dx=new Set(["rectangle","ellipse","diamond","arrow"]),wS=e=>Dx.has(e.type),Ys=(e,t)=>{e=Math.ceil(e);let n=he*2;return t==="ellipse"?Math.round((e+n)/Math.sqrt(2)*2):t==="arrow"?e+n*8:t==="diamond"?2*(e+n):e+n},st=(e,t)=>{let{width:n}=e;if(j(e)){let r=(t?.fontSize??wt)*Kd;return Math.max(Zd*n,r)}return e.type==="ellipse"?Math.round(n/2*Math.sqrt(2))-he*2:e.type==="diamond"?Math.round(n/2)-he*2:n-he*2},Eo=(e,t)=>{let{height:n}=e;return j(e)?n-he*8*2<=0?t.height:n:e.type==="ellipse"?Math.round(n/2*Math.sqrt(2))-he*2:e.type==="diamond"?Math.round(n/2)-he*2:n-he*2},bS=()=>Ks(If,Ee({fontSize:wt,fontFamily:Qe}))>0,$s={[pe.Virgil]:1.25,[pe.Helvetica]:1.15,[pe.Cascadia]:1.2},vf={[pe.Virgil]:{unitsPerEm:1e3,ascender:886,descender:-374},[pe.Helvetica]:{unitsPerEm:2048,ascender:1577,descender:-471},[pe.Cascadia]:{unitsPerEm:2048,ascender:1977,descender:-480},[pe.Assistant]:{unitsPerEm:1e3,ascender:1021,descender:-287}},Fi=e=>e in $s?$s[e]:$s[Qe];var qs="invert(100%) hue-rotate(180deg) saturate(1.25)",Cx=et(),kf=(e,t)=>yt(e)&&!t.imageCache.has(e.fileId),Of=(e,t,n)=>n.theme===ke.DARK&&yt(e)&&!kf(e,t)&&t.imageCache.get(e.fileId)?.mimeType!==F.svg,Bi=e=>e.type==="freedraw"?e.strokeWidth*12:20,Lx=(e,t,n)=>{let r=(t?.opacity??100)*e.opacity/1e4;return(n.has(e.id)||t&&n.has(t.id))&&(r*=jd/100),r},kx=(e,t,n)=>{let i=Bi(e),[a,s,l,c]=N(e,t),d=J(e)||ge(e)?Ve(a,l):e.width,u=J(e)||ge(e)?Ve(s,c):e.height,f=d*window.devicePixelRatio+i*2,m=u*window.devicePixelRatio+i*2,p=n.value;return(f*p>32767||m*p>32767)&&(p=Math.min(32767/f,32767/m)),f*m*p*p>16777216&&(p=Math.sqrt(16777216/(f*m))),f=Math.floor(f*p),m=Math.floor(m*p),{width:f,height:m,scale:p}},Ox=(e,t,n,r,o)=>{let i=document.createElement("canvas"),a=i.getContext("2d"),s=Bi(e),{width:l,height:c,scale:d}=kx(e,t,n);i.width=l,i.height=c;let u=0,f=0;if(J(e)||ge(e)){let[p,h]=N(e,t);u=e.x>p?Ve(e.x,p)*window.devicePixelRatio*d:0,f=e.y>h?Ve(e.y,h)*window.devicePixelRatio*d:0,a.translate(u,f)}a.save(),a.translate(s*d,s*d),a.scale(window.devicePixelRatio*d,window.devicePixelRatio*d);let m=Tt.canvas(i);return Of(e,r,o)&&(a.filter=qs),Ni(e,m,a,r,o),a.restore(),{element:e,canvas:i,theme:o.theme,scale:d,zoomValue:n.value,canvasOffsetX:u,canvasOffsetY:f,boundTextElementVersion:q(e,t)?.version||null,containingFrameOpacity:Ce(e,t)?.opacity||100}},Rf=14,Ff=document.createElement("img");Ff.src=`data:${F.svg},${encodeURIComponent('<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="image" class="svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#888" d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"></path></svg>')}`;var Nf=document.createElement("img");Nf.src=`data:${F.svg},${encodeURIComponent('<svg viewBox="0 0 668 668" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2"><path d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48ZM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56ZM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.81709 0 0 .81709 124.825 145.825)"/><path d="M256 8C119.034 8 8 119.033 8 256c0 136.967 111.034 248 248 248s248-111.034 248-248S392.967 8 256 8Zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676ZM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.30366 0 0 .30366 506.822 60.065)"/></svg>')}`;var Rx=(e,t,n)=>{t.fillStyle="#E7E7E7",t.fillRect(0,0,e.width,e.height);let r=Math.min(e.width,e.height),o=Math.min(r,Math.min(r*.4,100));t.drawImage(e.status==="error"?Nf:Ff,e.width/2-o/2,e.height/2-o/2,o,o)},Ni=(e,t,n,r,o)=>{switch(e.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":{n.lineJoin="round",n.lineCap="round",t.draw(le.get(e));break}case"arrow":case"line":{n.lineJoin="round",n.lineCap="round",le.get(e).forEach(i=>{t.draw(i)});break}case"freedraw":{n.save(),n.fillStyle=e.strokeColor;let i=Fx(e),a=le.get(e);a&&t.draw(a),n.fillStyle=e.strokeColor,n.fill(i),n.restore();break}case"image":{let i=yt(e)?r.imageCache.get(e.fileId)?.image:void 0;i!=null&&!(i instanceof Promise)?(e.roundness&&n.roundRect&&(n.beginPath(),n.roundRect(0,0,e.width,e.height,Vt(Math.min(e.width,e.height),e)),n.clip()),n.drawImage(i,0,0,e.width,e.height)):Rx(e,n,o.zoom.value);break}default:if(Y(e)){let i=li(e.text),a=i&&!n.canvas.isConnected;a&&document.body.appendChild(n.canvas),n.canvas.setAttribute("dir",i?"rtl":"ltr"),n.save(),n.font=Ee(e),n.fillStyle=e.strokeColor,n.textAlign=e.textAlign;let s=e.text.replace(/\r\n?/g,`
`).split(`
`),l=e.textAlign==="center"?e.width/2:e.textAlign==="right"?e.width:0,c=hr(e.fontSize,e.lineHeight),d=Ri(e.fontFamily,e.fontSize,c);for(let u=0;u<s.length;u++)n.fillText(s[u],l,u*c+d);n.restore(),a&&n.canvas.remove()}else throw new Error(`Unimplemented type ${e.type}`)}},Oi=new WeakMap,Mf=(e,t,n,r)=>{let o=n?r.zoom:Cx.zoom,i=Oi.get(e),a=i&&i.zoomValue!==o.value&&!r?.shouldCacheIgnoreZoom,s=q(e,t)?.version||null,l=Ce(e,t)?.opacity||100;if(!i||a||i.theme!==r.theme||i.boundTextElementVersion!==s||i.containingFrameOpacity!==l){let c=Ox(e,t,o,n,r);return Oi.set(e,c),c}return i},Df=(e,t,n,r,o)=>{let i=e.element,a=Bi(i),s=e.scale,[l,c,d,u]=N(i,o);ge(i)&&(l=Math.floor(l),d=Math.ceil(d),c=Math.floor(c),u=Math.ceil(u));let f=((l+d)/2+r.scrollX)*window.devicePixelRatio,m=((c+u)/2+r.scrollY)*window.devicePixelRatio;t.save(),t.scale(1/window.devicePixelRatio,1/window.devicePixelRatio);let p=q(i,o);if(j(i)&&p){let h=document.createElement("canvas"),E=h.getContext("2d"),x=Math.max(Ve(l,d),Ve(c,u));h.width=x*window.devicePixelRatio*s+a*e.scale*10,h.height=x*window.devicePixelRatio*s+a*e.scale*10;let w=(h.width-e.canvas.width)/2,v=(h.height-e.canvas.height)/2;E.translate(h.width/2,h.height/2),E.rotate(i.angle),E.drawImage(e.canvas,-e.canvas.width/2,-e.canvas.height/2,e.canvas.width,e.canvas.height);let[,,,,T,b]=N(p,o);E.rotate(-i.angle);let D=h.width/2-(T-l)*window.devicePixelRatio*s-w-a*s,A=h.height/2-(b-c)*window.devicePixelRatio*s-v-a*s;E.translate(-D,-A),E.clearRect(-(p.width/2+he)*window.devicePixelRatio*s,-(p.height/2+he)*window.devicePixelRatio*s,(p.width+he*2)*window.devicePixelRatio*s,(p.height+he*2)*window.devicePixelRatio*s),t.translate(f,m),t.drawImage(h,-(d-l)/2*window.devicePixelRatio-w/s-a,-(u-c)/2*window.devicePixelRatio-v/s-a,h.width/s,h.height/s)}else if(t.translate(f,m),t.rotate(i.angle),"scale"in e.element&&!kf(i,n)&&t.scale(e.element.scale[0],e.element.scale[1]),t.translate(-f,-m),t.drawImage(e.canvas,(l+r.scrollX)*window.devicePixelRatio-a*e.scale/e.scale,(c+r.scrollY)*window.devicePixelRatio-a*e.scale/e.scale,e.canvas.width/e.scale,e.canvas.height/e.scale),y.VITE_APP_DEBUG_ENABLE_TEXT_CONTAINER_BOUNDING_BOX==="true"&&ir(i)){let h=q(i,o),E=js(i);t.strokeStyle="#c92a2a",t.lineWidth=3,t.strokeRect((E.x+r.scrollX)*window.devicePixelRatio,(E.y+r.scrollY)*window.devicePixelRatio,st(i,h)*window.devicePixelRatio,Eo(i,h)*window.devicePixelRatio)}t.restore()},FS=(e,t,n)=>{t.save(),t.translate(e.x+n.scrollX,e.y+n.scrollY),t.fillStyle="rgba(0, 0, 200, 0.04)";let r=.5/n.zoom.value;t.fillRect(r,r,e.width,e.height),t.lineWidth=1/n.zoom.value,t.strokeStyle=" rgb(105, 101, 219)",t.strokeRect(r,r,e.width,e.height),t.restore()},gr=(e,t,n,r,o,i,a)=>{switch(o.globalAlpha=Lx(e,Ce(e,t),i.elementsPendingErasure),e.type){case"magicframe":case"frame":{a.frameRendering.enabled&&a.frameRendering.outline&&(o.save(),o.translate(e.x+a.scrollX,e.y+a.scrollY),o.fillStyle="rgba(0, 0, 200, 0.04)",o.lineWidth=xe.strokeWidth/a.zoom.value,o.strokeStyle=xe.strokeColor,mu(e)&&(o.strokeStyle=a.theme===ke.LIGHT?"#7affd7":"#1d8264"),xe.radius&&o.roundRect?(o.beginPath(),o.roundRect(0,0,e.width,e.height,xe.radius/a.zoom.value),o.stroke(),o.closePath()):o.strokeRect(0,0,e.width,e.height),o.restore());break}case"freedraw":{if(le.generateElementShape(e,null),i.isExporting){let[s,l,c,d]=N(e,t),u=(s+c)/2+a.scrollX,f=(l+d)/2+a.scrollY,m=(c-s)/2-(e.x-s),p=(d-l)/2-(e.y-l);o.save(),o.translate(u,f),o.rotate(e.angle),o.translate(-m,-p),Ni(e,r,o,i,a),o.restore()}else{let s=Mf(e,t,i,a);Df(s,o,i,a,n)}break}case"rectangle":case"diamond":case"ellipse":case"line":case"arrow":case"image":case"text":case"iframe":case"embeddable":{if(le.generateElementShape(e,i),i.isExporting){let[s,l,c,d]=N(e,t),u=(s+c)/2+a.scrollX,f=(l+d)/2+a.scrollY,m=(c-s)/2-(e.x-s),p=(d-l)/2-(e.y-l);if(Y(e)){let E=Se(e,t);if(j(E)){let x=K.getBoundTextElementPosition(E,e,t);m=(c-s)/2-(x.x-s),p=(d-l)/2-(x.y-l)}}o.save(),o.translate(u,f),Of(e,i,a)&&(o.filter="none");let h=q(e,t);if(j(e)&&h){let E=document.createElement("canvas"),x=E.getContext("2d"),w=Math.max(Ve(s,c),Ve(l,d)),v=Bi(e);E.width=w*a.exportScale+v*10*a.exportScale,E.height=w*a.exportScale+v*10*a.exportScale,x.translate(E.width/2,E.height/2),x.scale(a.exportScale,a.exportScale),m=e.width/2-(e.x-s),p=e.height/2-(e.y-l),x.rotate(e.angle);let T=Tt.canvas(E);x.translate(-m,-p),Ni(e,T,x,i,a),x.translate(m,p),x.rotate(-e.angle);let[,,,,b,D]=N(h,t),A=(s+c)/2-b,S=(l+d)/2-D;x.translate(-A,-S),x.clearRect(-h.width/2,-h.height/2,h.width,h.height),o.scale(1/a.exportScale,1/a.exportScale),o.drawImage(E,-E.width/2,-E.height/2,E.width,E.height)}else o.rotate(e.angle),e.type==="image"&&o.scale(e.scale[0],e.scale[1]),o.translate(-m,-p),Ni(e,r,o,i,a);o.restore()}else{let s=Mf(e,t,i,a),l=o.imageSmoothingEnabled;!a?.shouldCacheIgnoreZoom&&(!e.angle||Lf(e.angle))&&(o.imageSmoothingEnabled=!1),Df(s,o,i,a,n),o.imageSmoothingEnabled=l}break}default:throw new Error(`Unimplemented type ${e.type}`)}o.globalAlpha=1},Bf=new WeakMap([]);function Gf(e){let t=Js(e),n=new Path2D(t);return Bf.set(e,n),n}function Fx(e){return Bf.get(e)}function Js(e){let t=e.simulatePressure?e.points:e.points.length?e.points.map(([r,o],i)=>[r,o,e.pressures[i]]):[[0,0,.5]],n={simulatePressure:e.simulatePressure,size:e.strokeWidth*4.25,thinning:.6,smoothing:.5,streamline:.5,easing:r=>Math.sin(r*Math.PI/2),last:!!e.lastCommittedPoint};return Bx(Ru(t,n))}function Cf(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}var Nx=/(\s?[A-Z]?,?-?[0-9]*\.[0-9]{0,2})(([0-9]|e|-)*)/g;function Bx(e){if(!e.length)return"";let t=e.length-1;return e.reduce((n,r,o,i)=>(o===t?n.push(r,Cf(r,i[0]),"L",i[0],"Z"):n.push(r,Cf(r,i[o+1])),n),["M",e[0],"Q"]).join(" ").replace(Nx,"$1")}g();function Qs(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function Gx(e,t,n){let r=Qs(t,n);if(r===0)return Qs(e,t);let o=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/r;return o=Math.max(0,Math.min(1,o)),Qs(e,zx(t,n,o))}function zx(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function zf(e,t){return el(e,0,e.length,t)}function el(e,t,n,r,o){let i=o||[],a=e[t],s=e[n-1],l=0,c=1;for(let d=t+1;d<n-1;++d){let u=Gx(e[d],a,s);u>l&&(l=u,c=d)}return Math.sqrt(l)>r?(el(e,t,c+1,r,i),el(e,c,n,r,i)):(i.length||i.push(a),i.push(s)),i}var Hx=e=>[8,8+e],Vf=e=>[1.5,6+e];function Ux(e){let t=e.roughness,n=Math.max(e.width,e.height),r=Math.min(e.width,e.height);return r>=20&&n>=50||r>=15&&e.roundness&&Ds(e.type)||J(e)&&n>=50?t:Math.min(t/(n<10?3:2),2.5)}var Be=(e,t=!1)=>{let n={seed:e.seed,strokeLineDash:e.strokeStyle==="dashed"?Hx(e.strokeWidth):e.strokeStyle==="dotted"?Vf(e.strokeWidth):void 0,disableMultiStroke:e.strokeStyle!=="solid",strokeWidth:e.strokeStyle!=="solid"?e.strokeWidth+.5:e.strokeWidth,fillWeight:e.strokeWidth/2,hachureGap:e.strokeWidth*4,roughness:Ux(e),stroke:e.strokeColor,preserveVertices:t||e.roughness<ns.cartoonist};switch(e.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":return n.fillStyle=e.fillStyle,n.fill=on(e.backgroundColor)?void 0:e.backgroundColor,e.type==="ellipse"&&(n.curveFitting=1),n;case"line":case"freedraw":return _t(e.points)&&(n.fillStyle=e.fillStyle,n.fill=e.backgroundColor==="transparent"?void 0:e.backgroundColor),n;case"arrow":return n;default:throw new Error(`Unimplemented type ${e.type}`)}},Hf=(e,t,n)=>tt(e)&&(t||ui(e)&&n?.get(e.id)!==!0)&&on(e.backgroundColor)&&on(e.strokeColor)?{...e,roughness:0,backgroundColor:"#d3d3d3",fillStyle:"solid"}:Zr(e)?{...e,strokeColor:on(e.strokeColor)?"#000000":e.strokeColor,backgroundColor:on(e.backgroundColor)?"#f4f4f6":e.backgroundColor}:e,Uf=(e,t,n,r,o,i,a)=>{let s=nl(e,t,n,r);if(s===null)return[];switch(r){case"dot":case"circle":case"circle_outline":{let[l,c,d]=s;return delete i.strokeLineDash,[o.circle(l,c,d,{...i,fill:r==="circle_outline"?a:e.strokeColor,fillStyle:"solid",stroke:e.strokeColor,roughness:Math.min(.5,i.roughness||0)})]}case"triangle":case"triangle_outline":{let[l,c,d,u,f,m]=s;return delete i.strokeLineDash,[o.polygon([[l,c],[d,u],[f,m],[l,c]],{...i,fill:r==="triangle_outline"?a:e.strokeColor,fillStyle:"solid",roughness:Math.min(1,i.roughness||0)})]}case"diamond":case"diamond_outline":{let[l,c,d,u,f,m,p,h]=s;return delete i.strokeLineDash,[o.polygon([[l,c],[d,u],[f,m],[p,h],[l,c]],{...i,fill:r==="diamond_outline"?a:e.strokeColor,fillStyle:"solid",roughness:Math.min(1,i.roughness||0)})]}case"bar":case"arrow":default:{let[l,c,d,u,f,m]=s;if(e.strokeStyle==="dotted"){let p=Vf(e.strokeWidth-1);i.strokeLineDash=[p[0],p[1]-1]}else delete i.strokeLineDash;return i.roughness=Math.min(1,i.roughness||0),[o.line(d,u,l,c,i),o.line(f,m,l,c,i)]}}},gf=(e,t,{isExporting:n,canvasBackgroundColor:r,embedsValidationStatus:o})=>{switch(e.type){case"rectangle":case"iframe":case"embeddable":{let i;if(e.roundness){let a=e.width,s=e.height,l=Vt(Math.min(a,s),e);i=t.path(`M ${l} 0 L ${a-l} 0 Q ${a} 0, ${a} ${l} L ${a} ${s-l} Q ${a} ${s}, ${a-l} ${s} L ${l} ${s} Q 0 ${s}, 0 ${s-l} L 0 ${l} Q 0 0, ${l} 0`,Be(Hf(e,n,o),!0))}else i=t.rectangle(0,0,e.width,e.height,Be(Hf(e,n,o),!1));return i}case"diamond":{let i,[a,s,l,c,d,u,f,m]=tl(e);if(e.roundness){let p=Vt(Math.abs(a-f),e),h=Vt(Math.abs(c-s),e);i=t.path(`M ${a+p} ${s+h} L ${l-p} ${c-h}
            C ${l} ${c}, ${l} ${c}, ${l-p} ${c+h}
            L ${d+p} ${u-h}
            C ${d} ${u}, ${d} ${u}, ${d-p} ${u-h}
            L ${f+p} ${m+h}
            C ${f} ${m}, ${f} ${m}, ${f+p} ${m-h}
            L ${a-p} ${s+h}
            C ${a} ${s}, ${a} ${s}, ${a+p} ${s+h}`,Be(e,!0))}else i=t.polygon([[a,s],[l,c],[d,u],[f,m]],Be(e));return i}case"ellipse":return t.ellipse(e.width/2,e.height/2,e.width,e.height,Be(e));case"line":case"arrow":{let i,a=Be(e),s=e.points.length?e.points:[[0,0]];if(e.roundness?i=[t.curve(s,a)]:a.fill?i=[t.polygon(s,a)]:i=[t.linearPath(s,a)],e.type==="arrow"){let{startArrowhead:l=null,endArrowhead:c="arrow"}=e;if(l!==null){let d=Uf(e,i,"start",l,t,a,r);i.push(...d)}if(c!==null){let d=Uf(e,i,"end",c,t,a,r);i.push(...d)}}return i}case"freedraw":{let i;if(Gf(e),_t(e.points)){let a=zf(e.points,.75);i=t.curve(a,{...Be(e),stroke:"none"})}else i=null;return i}case"frame":case"magicframe":case"text":case"image":return null;default:return Pn(e,`generateElementShape(): Unimplemented type ${e?.type}`),null}};g();var $f=e=>{let t=e.map(r=>r[0]),n=e.map(r=>r[1]);return{width:Math.max(...t)-Math.min(...t),height:Math.max(...n)-Math.min(...n)}},pn=(e,t,n,r)=>{let o=n.map(m=>m[e]),i=Math.max(...o),a=Math.min(...o),s=i-a,l=s===0?1:t/s,c=1/0,d=n.map(m=>{let p=m[e]*l,h=[...m];return h[e]=p,p<c&&(c=p),h});if(!r||d.length===2)return d;let u=a-c;return d.map(m=>m.map((p,h)=>h===e?p+u:p))};var rl=class e{static boundsCache=new WeakMap;static getBounds(t,n){let r=e.boundsCache.get(t);if(r?.version&&r.version===t.version&&!be(t))return r.bounds;let o=e.calculateBounds(t,n);return e.boundsCache.set(t,{version:t.version,bounds:o}),o}static calculateBounds(t,n){let r,[o,i,a,s,l,c]=N(t,n);if(ge(t)){let[d,u,f,m]=il(t.points.map(([p,h])=>H(p,h,l-t.x,c-t.y,t.angle)));return[d+t.x,u+t.y,f+t.x,m+t.y]}else if(J(t))r=Zx(t,l,c,n);else if(t.type==="diamond"){let[d,u]=H(l,i,l,c,t.angle),[f,m]=H(l,s,l,c,t.angle),[p,h]=H(o,c,l,c,t.angle),[E,x]=H(a,c,l,c,t.angle),w=Math.min(d,f,p,E),v=Math.min(u,m,h,x),T=Math.max(d,f,p,E),b=Math.max(u,m,h,x);r=[w,v,T,b]}else if(t.type==="ellipse"){let d=(a-o)/2,u=(s-i)/2,f=Math.cos(t.angle),m=Math.sin(t.angle),p=Math.hypot(d*f,u*m),h=Math.hypot(u*f,d*m);r=[l-p,c-h,l+p,c+h]}else{let[d,u]=H(o,i,l,c,t.angle),[f,m]=H(o,s,l,c,t.angle),[p,h]=H(a,s,l,c,t.angle),[E,x]=H(a,i,l,c,t.angle),w=Math.min(d,f,p,E),v=Math.min(u,m,h,x),T=Math.max(d,f,p,E),b=Math.max(u,m,h,x);r=[w,v,T,b]}return r}},N=(e,t,n=!1)=>{if(ge(e))return $x(e);if(J(e))return K.getElementAbsoluteCoords(e,t,n);if(Y(e)){let r=t?Se(e,t):null;if(j(r)){let o=K.getBoundTextElementPosition(r,e,t);return[o.x,o.y,o.x+e.width,o.y+e.height,o.x+e.width/2,o.y+e.height/2]}}return[e.x,e.y,e.x+e.width,e.y+e.height,e.x+e.width/2,e.y+e.height/2]},ol=(e,t)=>{let[n,r,o,i,a,s]=N(e,t),l=[a,s];if(J(e)||ge(e)){let x=[],w=0;for(;w<e.points.length-1;)x.push([ce([e.points[w][0]+e.x,e.points[w][1]+e.y],l,e.angle),ce([e.points[w+1][0]+e.x,e.points[w+1][1]+e.y],l,e.angle)]),w++;return x}let[c,d,u,f,m,p,h,E]=[[n,r],[o,r],[n,i],[o,i],[a,r],[a,i],[n,s],[o,s]].map(x=>ce(x,l,e.angle));return e.type==="diamond"?[[m,h],[m,E],[p,h],[p,E]]:e.type==="ellipse"?[[m,h],[m,E],[p,h],[p,E],[m,h],[m,E],[p,h],[p,E]]:[[c,d],[u,f],[c,u],[d,f],[c,E],[u,E],[d,h],[f,h]]};var tl=e=>{let t=Math.floor(e.width/2)+1,n=0,r=e.width,o=Math.floor(e.height/2)+1,i=t,a=e.height;return[t,n,r,o,i,a,0,o]},mn=e=>{for(let t of e.sets)if(t.type==="path")return t.ops;return e.sets[0].ops},Yf=(e,t,n,r,o)=>{let i=1-e;return Math.pow(i,3)*t+3*Math.pow(i,2)*e*n+3*i*Math.pow(e,2)*r+Math.pow(e,3)*o},Wf=(e,t,n,r)=>{let o=t-e,i=n-t,a=r-n,s=3*o-6*i+3*a,l=6*i-6*o,c=3*o,d=l*l-4*s*c;if(!(d>=0))return!1;let f=null,m=null,p=1/0,h=1/0;return s===0?p=h=-c/l:(p=(-l+Math.sqrt(d))/(2*s),h=(-l-Math.sqrt(d))/(2*s)),p>=0&&p<=1&&(f=Yf(p,e,t,n,r)),h>=0&&h<=1&&(m=Yf(h,e,t,n,r)),[f,m]},Vx=(e,t,n,r)=>{let o=Wf(e[0],t[0],n[0],r[0]),i=Wf(e[1],t[1],n[1],r[1]),a=Math.min(e[0],r[0]),s=Math.max(e[0],r[0]);if(o){let d=o.filter(u=>u!==null);a=Math.min(a,...d),s=Math.max(s,...d)}let l=Math.min(e[1],r[1]),c=Math.max(e[1],r[1]);if(i){let d=i.filter(u=>u!==null);l=Math.min(l,...d),c=Math.max(c,...d)}return[a,l,s,c]},mo=(e,t)=>{let n=[0,0],{minX:r,minY:o,maxX:i,maxY:a}=e.reduce((s,{op:l,data:c})=>{if(l==="move")n=c;else if(l==="bcurveTo"){let d=[c[0],c[1]],u=[c[2],c[3]],f=[c[4],c[5]],m=t?t(...d):d,p=t?t(...u):u,h=t?t(...f):f,E=t?t(...n):n;n=f;let[x,w,v,T]=Vx(E,m,p,h);s.minX=Math.min(s.minX,x),s.minY=Math.min(s.minY,w),s.maxX=Math.max(s.maxX,v),s.maxY=Math.max(s.maxY,T)}return s},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});return[r,o,i,a]},il=e=>{let t=1/0,n=1/0,r=-1/0,o=-1/0;for(let[i,a]of e)t=Math.min(t,i),n=Math.min(n,a),r=Math.max(r,i),o=Math.max(o,a);return[t,n,r,o]},$x=e=>{let[t,n,r,o]=il(e.points),i=t+e.x,a=n+e.y,s=r+e.x,l=o+e.y;return[i,a,s,l,(i+s)/2,(a+l)/2]},Yx=e=>{switch(e){case"arrow":return 25;case"diamond":case"diamond_outline":return 12;default:return 15}},Wx=e=>{switch(e){case"bar":return 90;case"arrow":return 20;default:return 25}},nl=(e,t,n,r)=>{let o=mn(t[0]);if(o.length<1)return null;let i=n==="start"?1:o.length-1,a=o[i].data,s=[a[4],a[5]],l=[a[2],a[3]],c=[a[0],a[1]],d=o[i-1],u=[0,0];d.op==="move"?u=d.data:d.op==="bcurveTo"&&(u=[d.data[4],d.data[5]]);let f=(G,B)=>Math.pow(1-G,3)*s[B]+3*G*Math.pow(1-G,2)*l[B]+3*Math.pow(G,2)*(1-G)*c[B]+u[B]*Math.pow(G,3),[m,p]=n==="start"?u:s,[h,E]=[f(.3,0),f(.3,1)],x=Math.hypot(m-h,p-E),w=(m-h)/x,v=(p-E)/x,T=Yx(r),b=0;{let[G,B]=n==="end"?e.points[e.points.length-1]:e.points[0],[L,C]=e.points.length>1?n==="end"?e.points[e.points.length-2]:e.points[1]:[0,0];b=Math.hypot(G-L,B-C)}let A=Math.min(T,b*(r==="diamond"||r==="diamond_outline"?.25:.5)),S=m-w*A,I=p-v*A;if(r==="dot"||r==="circle"||r==="circle_outline"){let G=Math.hypot(I-p,S-m)+e.strokeWidth-2;return[m,p,G]}let P=Wx(r),[_,M]=H(S,I,m,p,-P*Math.PI/180),[k,U]=H(S,I,m,p,P*Math.PI/180);if(r==="diamond"||r==="diamond_outline"){let G,B;if(n==="start"){let[L,C]=e.points.length>1?e.points[1]:[0,0];[G,B]=H(m+A*2,p,m,p,Math.atan2(C-p,L-m))}else{let[L,C]=e.points.length>1?e.points[e.points.length-2]:[0,0];[G,B]=H(m-A*2,p,m,p,Math.atan2(p-C,m-L))}return[m,p,_,M,G,B,k,U]}return[m,p,_,M,k,U]},Xx=e=>{let t=Tt.generator(),n=Be(e),r=e.roundness?"curve":n.fill?"polygon":"linearPath";return t[r](e.points,n)},Zx=(e,t,n,r)=>{let o=q(e,r);if(e.points.length<2){let[u,f]=e.points[0],[m,p]=H(e.x+u,e.y+f,t,n,e.angle),h=[m,p,m,p];if(o){let E=K.getMinMaxXYWithBoundText(e,r,[m,p,m,p],o);h=[E[0],E[1],E[2],E[3]]}return h}let a=le.get(e)?.[0]??Xx(e),s=mn(a),c=mo(s,(u,f)=>H(e.x+u,e.y+f,t,n,e.angle)),d=[c[0],c[1],c[2],c[3]];if(o){let u=K.getMinMaxXYWithBoundText(e,r,d,o);d=[u[0],u[1],u[2],u[3]]}return d},Ge=(e,t)=>rl.getBounds(e,t),De=e=>{if(!e.length)return[0,0,0,0];let t=1/0,n=-1/0,r=1/0,o=-1/0,i=X(e);return e.forEach(a=>{let[s,l,c,d]=Ge(a,i);t=Math.min(t,s),r=Math.min(r,l),n=Math.max(n,c),o=Math.max(o,d)}),[t,r,n,o]},l_=(e,t)=>{let[n,r,o,i]=De(e);return[n+t.x,r+t.y,o+t.x,i+t.y]},xr=(e,t,n,r)=>{if(!(J(e)||ge(e)))return[e.x,e.y,e.x+t,e.y+n];let o=pn(0,t,pn(1,n,e.points,r),r),i;if(ge(e))i=il(o);else{let d=Tt.generator(),u=e.roundness?d.curve(o,Be(e)):d.linearPath(o,Be(e)),f=mn(u);i=mo(f)}let[a,s,l,c]=i;return[a+e.x,s+e.y,l+e.x,c+e.y]},Bs=(e,t)=>{let n=Tt.generator(),r=e.roundness==null?n.linearPath(t,Be(e)):n.curve(t,Be(e)),o=mn(r),[i,a,s,l]=mo(o);return[i+e.x,a+e.y,s+e.x,l+e.y]},Ps=(e,t)=>{if(!e.length)return[0,0,0,0];let n=1/0,r=e[0],o=X(e);return e.forEach(i=>{let[a,s,l,c]=Ge(i,o),d=Fe((a+l)/2,(s+c)/2,t.x,t.y);d<n&&(n=d,r=i)}),Ge(r,o)},Xf=e=>{let[t,n,r,o]=De(e);return{minX:t,minY:n,maxX:r,maxY:o,width:r-t,height:o-n,midX:(t+r)/2,midY:(n+o)/2}},c_=({scrollX:e,scrollY:t,width:n,height:r,zoom:o})=>[-e,-t,-e+n/o.value,-t+r/o.value];var H=(e,t,n,r,o)=>[(e-n)*Math.cos(o)-(t-r)*Math.sin(o)+n,(e-n)*Math.sin(o)+(t-r)*Math.cos(o)+r],ce=(e,t,n)=>H(e[0],e[1],t[0],t[1],n),Zf=(e,t,n,r,o,i,a,s)=>{let l=Math.cos(r),c=Math.sin(r);return e.e&&e.w?t+=o+a:e.e?(t+=o*(1+l),n+=o*c,t+=a*(1-l),n+=a*-c):e.w&&(t+=o*(1-l),n+=o*-c,t+=a*(1+l),n+=a*c),e.n&&e.s?n+=i+s:e.n?(t+=i*c,n+=i*(1-l),t+=s*-c,n+=s*(1+l)):e.s&&(t+=i*-c,n+=i*(1+l),t+=s*c,n+=s*(1-l)),[t,n]};var Fe=(e,t,n,r)=>{let o=n-e,i=r-t;return Math.hypot(o,i)},uo=(e,t)=>[(e[0]+t[0])/2,(e[1]+t[1])/2],_t=(e,t=1)=>{if(e.length>=3){let[n,r]=[e[0],e[e.length-1]];return Fe(n[0],n[1],r[0],r[1])<=$d/t}return!1};var Gi=(e,t,n)=>t[0]<=Math.max(e[0],n[0])&&t[0]>=Math.min(e[0],n[0])&&t[1]<=Math.max(e[1],n[1])&&t[1]>=Math.min(e[1],n[1]);var fo=(e,t,n)=>n?[Math.round(e/n)*n,Math.round(t/n)*n]:[e,t],Vt=(e,t)=>{if(t.roundness?.type===Oe.PROPORTIONAL_RADIUS||t.roundness?.type===Oe.LEGACY)return e*oi;if(t.roundness?.type===Oe.ADAPTIVE_RADIUS){let n=t.roundness?.value??qd,r=n/oi;return e<=r?e*oi:n}return 0},Gs=(e,t)=>{let n=le.generateElementShape(e,null);if(!n)return null;let r=mn(n[0]),o=[0,0],i=0,a=1/0,s=null;for(;i<r.length;){let{op:l,data:c}=r[i];if(l==="move"&&(o=c),l==="bcurveTo"){let d=o,u=[c[0],c[1]],f=[c[2],c[3]],m=[c[4],c[5]],p=Fe(m[0],m[1],t[0],t[1]);p<a&&(a=p,s=[d,u,f,m]),o=m}i++}return s},zs=(e,t,n,r,o)=>{let i=(l,c)=>Math.pow(1-l,3)*r[c]+3*l*Math.pow(1-l,2)*n[c]+3*Math.pow(l,2)*(1-l)*t[c]+e[c]*Math.pow(l,3),a=i(o,0),s=i(o,1);return[a,s]},Kx=(e,t)=>{let n=Gs(e,t);if(!n)return[];let r=[],o=1;for(;o>0;){let i=zs(n[0],n[1],n[2],n[3],o);r.push([i[0],i[1]]),o-=.05}return r.length&&Hs(r.at(-1),t)&&r.push([t[0],t[1]]),r},Kf=(e,t)=>{let n=[];n[0]=0;let r=Kx(e,t),o=0,i=0;for(;o<r.length-1;){let a=Fe(r[o][0],r[o][1],r[o+1][0],r[o+1][1]);i+=a,n.push(i),o++}return n},xf=(e,t)=>Kf(e,t).at(-1),wf=(e,t,n)=>{let r=Kf(e,t),o=r.length-1,i=r.at(-1),a=n*i,s=0,l=o,c=0;for(;s<l;)c=Math.floor(s+(l-s)/2),r[c]<a?s=c+1:l=c;return r[c]>a&&c--,r[c]===a?c/o:1-(c+(a-r[c])/(r[c+1]-r[c]))/o},Hs=(e,t)=>e[0]===t[0]&&e[1]===t[1],Lf=e=>Math.round(e/Math.PI*1e4)%5e3===0,h_=([e,t],[n,r])=>e<=n?t>=n:e>=n?r>=e:!1,E_=(e,t)=>{let n=Math.max(e[0],t[0]),r=Math.min(e[1],t[1]);return n<=r?[n,r]:null},go=(e,t,n)=>e>=t&&e<=n;g();var jx=(e,t,n)=>{let r=n.reduce((o,i)=>(i.groupIds.includes(e)&&(o[i.id]=!0),o),{});return Object.keys(r).length<2?t.selectedGroupIds[e]||t.editingGroupId===e?{selectedElementIds:t.selectedElementIds,selectedGroupIds:{...t.selectedGroupIds,[e]:!1},editingGroupId:null}:t:{editingGroupId:t.editingGroupId,selectedGroupIds:{...t.selectedGroupIds,[e]:!0},selectedElementIds:{...t.selectedElementIds,...r}}},v_=function(){let e=null,t=null,n=null,r=(i,a,s,l)=>{if(n!==void 0&&a===t&&i===e&&s.editingGroupId===n?.editingGroupId)return n;let c={};for(let f of i){let m=f.groupIds;if(s.editingGroupId){let p=m.indexOf(s.editingGroupId);p>-1&&(m=m.slice(0,p))}if(m.length>0){let p=m[m.length-1];c[p]=!0}}let d={},u=a.reduce((f,m)=>{let p=m.groupIds.find(h=>c[h]);return p&&(f[m.id]=!0,Array.isArray(d[p])?d[p].push(m.id):d[p]=[m.id]),f},{});for(let f of Object.keys(d))d[f].length<2&&c[f]&&(c[f]=!1);return t=a,e=i,n={editingGroupId:s.editingGroupId,selectedGroupIds:c,selectedElementIds:al({...s.selectedElementIds,...u},l)},n},o=(i,a,s,l)=>{let c=l?l.scene.getSelectedElements({selectedElementIds:i.selectedElementIds,elements:a}):at(a,i);return c.length?r(c,a,i,s):{selectedGroupIds:{},editingGroupId:null,selectedElementIds:al(i.selectedElementIds,s)}};return o.clearCache=()=>{t=null,e=null,n=null},o}(),T_=(e,t)=>qx(e,t)!=null,qx=(e,t)=>t.groupIds.filter(n=>n!==e.editingGroupId).find(n=>e.selectedGroupIds[n]),A_=e=>Object.entries(e.selectedGroupIds).filter(([t,n])=>n).map(([t,n])=>t),jf=(e,t)=>{let n={...t,selectedGroupIds:{}};for(let r of e){let o=r.groupIds;if(t.editingGroupId){let i=o.indexOf(t.editingGroupId);i>-1&&(o=o.slice(0,i))}if(o.length>0){let i=o[o.length-1];n={...n,...jx(i,n,e)}}}return n.selectedGroupIds},S_=(e,t)=>({...e,editingGroupId:t.groupIds.length?t.groupIds[0]:null,selectedGroupIds:{},selectedElementIds:{[t.id]:!0}}),Jx=(e,t)=>e.groupIds.includes(t),wr=(e,t)=>{let n=[];for(let r of e.values())Jx(r,t)&&n.push(r);return n},__=(e,t)=>e.groupIds.find(n=>t[n]),qf=(e,t,n)=>{let r=[...e],o=t?e.indexOf(t):-1,i=o>-1?o:e.length;for(let a=0;a<i;a++)r[a]=n(r[a]);return r},I_=(e,t,n)=>{let r=[...e],o=n?r.indexOf(n):-1,i=o>-1?o:r.length;return r.splice(i,0,t),r},P_=(e,t)=>e.filter(n=>!t[n]),M_=(e,t)=>{let n=new Map;return e.forEach(r=>{let o=r.groupIds.length===0?r.id:r.groupIds[r.groupIds.length-1],i=n.get(o)||[],a=q(r,t);a&&i.push(a),n.set(o,[...i,r])}),Array.from(n.values())},Jf=e=>{let t=new Set;for(let[,n]of e)if(!n.isDeleted)for(let r of n.groupIds??[])t.add(r);return t};var Qf=e=>e.groupIds.length>0;g();g();g();g();g();var tm=Pr(em(),1),Hi=e=>e.replace(/"/g,"&quot;"),br=e=>(e=e.trim(),e&&(0,tm.sanitizeUrl)(Hi(e))),O_=e=>!!(e?.includes(location.origin)||e?.startsWith("/")),nm=e=>{if(e=br(e),e.startsWith("/"))return`${location.origin}${e}`;try{new URL(e)}catch{return"about:blank"}return e};g();g();var rm=[],om=e=>(rm=rm.concat(e),e);g();var am='<svg viewBox="0 0 24 24" stroke-width="1" width="28" height="28" xmlns="http://www.w3.org/2000/svg">',l0='<path d="M6.164 11.755a5.314 5.314 0 0 1-4.932-5.298 5.314 5.314 0 0 1 5.311-5.311 5.314 5.314 0 0 1 5.307 5.113l8.773 8.773a3.322 3.322 0 0 1 0 4.696l-.895.895a3.322 3.322 0 0 1-4.696 0l-8.868-8.868Z" style="fill:#fff"/>',sm='<path stroke="#1b1b1f" fill="#fff" d="m7.868 11.113 7.773 7.774a2.359 2.359 0 0 0 1.667.691 2.368 2.368 0 0 0 2.357-2.358c0-.625-.248-1.225-.69-1.667L11.201 7.78 9.558 9.469l-1.69 1.643v.001Zm10.273 3.606-3.333 3.333m-3.25-6.583 2 2m-7-7 3 3M3.664 3.625l1 1M2.529 6.922l1.407-.144m5.735-2.932-1.118.866M4.285 9.823l.758-1.194m1.863-6.207-.13 1.408"/>',c0=`data:${F.svg},${encodeURIComponent(`${am}${sm}</svg>`)}`,d0=`data:${F.svg},${encodeURIComponent(`${am}${l0}${sm}</svg>`)}`,u0=e=>{e&&(e.style.cursor="")},f0=(e,t)=>{e&&(e.style.cursor=t)},It,im,m0=(e,t)=>{let r=()=>{let o=t===ke.DARK;It=document.createElement("canvas"),It.theme=t,It.height=20,It.width=20;let i=It.getContext("2d");i.lineWidth=1,i.beginPath(),i.arc(It.width/2,It.height/2,5,0,2*Math.PI),i.fillStyle=o?In.black:In.white,i.fill(),i.strokeStyle=o?In.white:In.black,i.stroke(),im=It.toDataURL(F.svg)};(!It||It.theme!==t)&&r(),f0(e,`url(${im}) ${20/2} ${20/2}, auto`)},lm=(e,t)=>{if(e)if(t.activeTool.type==="selection")u0(e);else if(ru(t))e.style.cursor=Qo.GRAB;else if(nu(t))m0(e,t.theme);else if(t.activeTool.type==="laser"){let n=t.theme===ke.LIGHT?c0:d0;e.style.cursor=`url(${n}), auto`}else["image","custom"].includes(t.activeTool.type)?t.activeTool.type!=="image"&&(e.style.cursor=Qo.AUTO):e.style.cursor=Qo.CROSSHAIR};g();g();var p0=new ar(Date.now()),h0=0,Pt=()=>Math.floor(p0.next()*2**31);var lt=()=>Nt()?`id${h0++}`:ii();var $t=(e,{x:t,y:n,strokeColor:r=ne.strokeColor,backgroundColor:o=ne.backgroundColor,fillStyle:i=ne.fillStyle,strokeWidth:a=ne.strokeWidth,strokeStyle:s=ne.strokeStyle,roughness:l=ne.roughness,opacity:c=ne.opacity,width:d=0,height:u=0,angle:f=0,groupIds:m=[],frameId:p=null,index:h=null,roundness:E=null,boundElements:x=null,link:w=null,locked:v=ne.locked,...T})=>({id:T.id||lt(),type:e,x:t,y:n,width:d,height:u,angle:f,strokeColor:r,backgroundColor:o,fillStyle:i,strokeWidth:a,strokeStyle:s,roughness:l,opacity:c,groupIds:m,frameId:p,index:h,roundness:E,seed:T.seed??Pt(),version:T.version||1,versionNonce:T.versionNonce??0,isDeleted:!1,boundElements:x,updated:Ft(),link:w,locked:v,customData:T.customData}),xo=e=>$t(e.type,e),oI=e=>$t("embeddable",e),iI=e=>({...$t("iframe",e)}),aI=e=>Ye({...$t("frame",e),type:"frame",name:e?.name||null},{}),sI=e=>Ye({...$t("magicframe",e),type:"magicframe",name:e?.name||null},{}),cm=(e,t)=>({x:e.textAlign==="center"?t.width/2:e.textAlign==="right"?t.width:0,y:e.verticalAlign==="middle"?t.height/2:0}),Mt=e=>{let t=e.fontFamily||Qe,n=e.fontSize||wt,r=e.lineHeight||Fi(t),o=Ws(e.text),i=Bn(o,Ee({fontFamily:t,fontSize:n}),r),a=e.textAlign||nr,s=e.verticalAlign||ti,l=cm({textAlign:a,verticalAlign:s},i);return Ye({...$t("text",e),text:o,fontSize:n,fontFamily:t,textAlign:a,verticalAlign:s,x:e.x-l.x,y:e.y-l.y,width:i.width,height:i.height,containerId:e.containerId||null,originalText:o,lineHeight:r},{})},E0=(e,t,n)=>{let{width:r,height:o}=Bn(n,Ee(e),e.lineHeight),{textAlign:i,verticalAlign:a}=e,s,l;if(i==="center"&&a===Rt.MIDDLE&&!e.containerId){let c=Bn(e.text,Ee(e),e.lineHeight),d=cm(e,{width:r-c.width,height:o-c.height});s=e.x-d.x,l=e.y-d.y}else{let[c,d,u,f]=N(e,t),[m,p,h,E]=xr(e,r,o,!1),x=(c-m)/2,w=(d-p)/2,v=(u-h)/2,T=(f-E)/2;[s,l]=Zf({s:!0,e:i==="center"||i==="left",w:i==="center"||i==="right"},e.x,e.y,e.angle,x,w,v,T)}return{width:r,height:o,x:Number.isFinite(s)?s:e.x,y:Number.isFinite(l)?l:e.y}},$i=(e,t,n,r=e.text)=>{if(e.isDeleted)return;t&&(r=Er(r,Ee(e),st(t,e)));let o=E0(e,n,r);return{text:r,...o}},g0=(e,t,n,{text:r,isDeleted:o,originalText:i})=>Ye(e,{originalText:i,isDeleted:o??e.isDeleted,...$i(e,t,n,i)}),lI=e=>({...$t(e.type,e),points:e.points||[],pressures:[],simulatePressure:e.simulatePressure,lastCommittedPoint:null}),Gn=e=>({...$t(e.type,e),points:e.points||[],lastCommittedPoint:null,startBinding:null,endBinding:null,startArrowhead:e.startArrowhead||null,endArrowhead:e.endArrowhead||null}),x0=e=>({...$t("image",e),strokeColor:"transparent",status:e.status??"pending",fileId:e.fileId??null,scale:e.scale??[1,1]}),Ui=(e,t=0)=>{if(e==null||typeof e!="object")return e;let n=Object.prototype.toString.call(e);if(n==="[object Object]"){let r=typeof e.constructor=="function"?Object.create(Object.getPrototypeOf(e)):{};for(let o in e)if(e.hasOwnProperty(o)){if(t===0&&(o==="shape"||o==="canvas"))continue;r[o]=Ui(e[o],t+1)}return r}if(Array.isArray(e)){let r=e.length,o=new Array(r);for(;r--;)o[r]=Ui(e[r],t+1);return o}return y.DEV&&n!=="[object Object]"&&n!=="[object Array]"&&n.startsWith("[object ")&&console.warn(`_deepCloneElement: unexpected object type ${n}. This value will not be cloned!`),e},wo=e=>Ui(e),Vi=e=>{if(Nt()&&e){let t=`${e}_copy`;return window.h?.app?.getSceneElementsIncludingDeleted().find(n=>n.id===t)&&(t+="_copy"),t}return lt()},w0=(e,t,n,r)=>{let o=wo(n);return o.id=Vi(o.id),o.boundElements=null,o.updated=Ft(),o.seed=Pt(),o.groupIds=qf(o.groupIds,e,i=>(t.has(i)||t.set(i,Vi(i)),t.get(i))),r&&(o=Object.assign(o,r)),o},cI=(e,t)=>{let n=[],r=X(e),o=new Map,i=s=>{if(o.has(s))return o.get(s);if(r.has(s)){let l=Vi(s);return o.set(s,l),l}return null},a=new Map;for(let s of e){let l=Ui(s);if(l.id=i(s.id),t?.randomizeSeed&&(l.seed=Pt(),bo(l)),l.groupIds&&(l.groupIds=l.groupIds.map(c=>(a.has(c)||a.set(c,Vi(c)),a.get(c)))),"containerId"in l&&l.containerId){let c=i(l.containerId);l.containerId=c}if("boundElements"in l&&l.boundElements&&(l.boundElements=l.boundElements.reduce((c,d)=>{let u=i(d.id);return u&&c.push({...d,id:u}),c},[])),"endBinding"in l&&l.endBinding){let c=i(l.endBinding.elementId);l.endBinding=c?{...l.endBinding,elementId:c}:null}if("startBinding"in l&&l.startBinding){let c=i(l.startBinding.elementId);l.startBinding=c?{...l.startBinding,elementId:c}:null}l.frameId&&(l.frameId=i(l.frameId)),n.push(l)}return n};g();g();g();g();var fm="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function vr(e,t,n){let r=n[0];if(t!=null&&e>=t)throw new Error(e+" >= "+t);if(e.slice(-1)===r||t&&t.slice(-1)===r)throw new Error("trailing zero");if(t){let a=0;for(;(e[a]||r)===t[a];)a++;if(a>0)return t.slice(0,a)+vr(e.slice(a),t.slice(a),n)}let o=e?n.indexOf(e[0]):0,i=t!=null?n.indexOf(t[0]):n.length;if(i-o>1){let a=Math.round(.5*(o+i));return n[a]}else return t&&t.length>1?t.slice(0,1):n[o]+vr(e.slice(1),null,n)}function mm(e){if(e.length!==pm(e[0]))throw new Error("invalid integer part of order key: "+e)}function pm(e){if(e>="a"&&e<="z")return e.charCodeAt(0)-97+2;if(e>="A"&&e<="Z")return 90-e.charCodeAt(0)+2;throw new Error("invalid order key head: "+e)}function yo(e){let t=pm(e[0]);if(t>e.length)throw new Error("invalid order key: "+e);return e.slice(0,t)}function dm(e,t){if(e==="A"+t[0].repeat(26))throw new Error("invalid order key: "+e);let n=yo(e);if(e.slice(n.length).slice(-1)===t[0])throw new Error("invalid order key: "+e)}function um(e,t){mm(e);let[n,...r]=e.split(""),o=!0;for(let i=r.length-1;o&&i>=0;i--){let a=t.indexOf(r[i])+1;a===t.length?r[i]=t[0]:(r[i]=t[a],o=!1)}if(o){if(n==="Z")return"a"+t[0];if(n==="z")return null;let i=String.fromCharCode(n.charCodeAt(0)+1);return i>"a"?r.push(t[0]):r.pop(),i+r.join("")}else return n+r.join("")}function b0(e,t){mm(e);let[n,...r]=e.split(""),o=!0;for(let i=r.length-1;o&&i>=0;i--){let a=t.indexOf(r[i])-1;a===-1?r[i]=t.slice(-1):(r[i]=t[a],o=!1)}if(o){if(n==="a")return"Z"+t.slice(-1);if(n==="A")return null;let i=String.fromCharCode(n.charCodeAt(0)-1);return i<"Z"?r.push(t.slice(-1)):r.pop(),i+r.join("")}else return n+r.join("")}function yr(e,t,n=fm){if(e!=null&&dm(e,n),t!=null&&dm(t,n),e!=null&&t!=null&&e>=t)throw new Error(e+" >= "+t);if(e==null){if(t==null)return"a"+n[0];let l=yo(t),c=t.slice(l.length);if(l==="A"+n[0].repeat(26))return l+vr("",c,n);if(l<t)return l;let d=b0(l,n);if(d==null)throw new Error("cannot decrement any more");return d}if(t==null){let l=yo(e),c=e.slice(l.length),d=um(l,n);return d??l+vr(c,null,n)}let r=yo(e),o=e.slice(r.length),i=yo(t),a=t.slice(i.length);if(r===i)return r+vr(o,a,n);let s=um(r,n);if(s==null)throw new Error("cannot increment any more");return s<t?s:r+vr(o,null,n)}function Yi(e,t,n,r=fm){if(n===0)return[];if(n===1)return[yr(e,t,r)];if(t==null){let a=yr(e,t,r),s=[a];for(let l=0;l<n-1;l++)a=yr(a,t,r),s.push(a);return s}if(e==null){let a=yr(e,t,r),s=[a];for(let l=0;l<n-1;l++)a=yr(e,a,r),s.push(a);return s.reverse(),s}let o=Math.floor(n/2),i=yr(e,t,r);return[...Yi(e,i,o,r),i,...Yi(i,t,n-o-1,r)]}g();var Wi=class extends Error{constructor(t="Couldn't export canvas.",n="CANVAS_ERROR"){super(),this.name=n,this.message=t}},Xi=class extends DOMException{constructor(t="Request Aborted"){super(t,"AbortError")}},Yt=class extends Error{code;constructor(t="Image Scene Data Error",n="IMAGE_SCENE_DATA_ERROR"){super(t),this.name="EncodingError",this.code=n}},Zi=class extends Error{code="ELEMENT_HAS_INVALID_INDEX"};var sl=e=>{for(let[t,n]of e.entries()){let r=e[t-1],o=e[t+1];if(!vo(n,r,o))throw new Zi(`Fractional indices invariant for element has been compromised - ["${r}", "${n}", "${o}"] [predecessor, current, successor]`)}},Em=e=>e.sort((t,n)=>hm(t)&&hm(n)?t.index<n.index?-1:t.index>n.index?1:t.id<n.id?-1:1:1),To=(e,t)=>{try{let n=y0(e,t),r=gm(e,n);sl(e.map(o=>r.get(o)?.index||o.index));for(let[o,i]of r)O(o,i,!1)}catch{zn(e)}return e},zn=e=>{let t=v0(e),n=gm(e,t);for(let[r,o]of n)O(r,o,!1);return e},y0=(e,t)=>{let n=[],r=0;for(;r<e.length;)if(t.has(e[r].id)&&!vo(e[r]?.index,e[r-1]?.index,e[r+1]?.index)){let o=[r-1,r];for(;++r<e.length&&(t.has(e[r].id)&&!vo(e[r]?.index,e[r-1]?.index,e[r+1]?.index));)o.push(r);o.push(r),n.push(o)}else r++;return n},v0=e=>{let t=[],n,r,o=-1,i=0,a=c=>{let d=e[o]?e[o].index:void 0,u=e[c-1]?.index;return!d&&u||d&&u&&u>d?[u,c-1]:[d,o]},s=c=>{let d=e[i]?e[i].index:void 0;if(d&&c<i)return[d,i];let u=i;for(;++u<e.length;){let f=e[u]?.index;if(!d&&f||d&&f&&f>d)return[f,u]}return[void 0,u]},l=0;for(;l<e.length;){let c=e[l].index;if([n,o]=a(l),[r,i]=s(l),vo(c,n,r))l++;else{let d=[o,l];for(;++l<e.length;){let u=e[l].index,[f,m]=a(l),[p,h]=s(l);if(vo(u,f,p))break;[n,o]=[f,m],[r,i]=[p,h],d.push(l)}d.push(i),t.push(d)}}return t},vo=(e,t,n)=>e?t&&n?t<e&&e<n:!t&&n?e<n:t&&!n?t<e:!!e:!1,gm=(e,t)=>{let n=new Map;for(let r of t){let o=r.shift(),i=r.pop(),a=Yi(e[o]?.index,e[i]?.index,r.length);for(let s=0;s<r.length;s++){let l=e[r[s]];n.set(l,{index:a[s]})}}return n},hm=e=>!!e.index;var ae=class e{constructor(t,n){this.deleted=t;this.inserted=n}static create(t,n,r,o){let i=r&&o!=="inserted"?r(t):t,a=r&&o!=="deleted"?r(n):n;return new e(i,a)}static calculate(t,n,r,o){if(t===n)return e.empty();let i={},a={};for(let c of this.distinctKeysIterator("full",t,n))i[c]=t[c],a[c]=n[c];let[s,l]=o?o(i,a):[i,a];return e.create(s,l,r)}static empty(){return new e({},{})}static isEmpty(t){return!Object.keys(t.deleted).length&&!Object.keys(t.inserted).length}static mergeObjects(t,n,r){let o={...t};for(let i of Object.keys(r))delete o[i];return{...o,...n}}static mergeArrays(t,n,r,o){return Object.values(e.mergeObjects(bt(t??[],o),bt(n??[],o),bt(r??[],o)))}static diffObjects(t,n,r,o){if(!(!t[r]&&!n[r])&&(typeof t[r]=="object"||typeof n[r]=="object")){let i=t[r]??{},a=n[r]??{},s=e.getLeftDifferences(i,a).reduce((c,d)=>(c[d]=o(i[d]),c),{}),l=e.getRightDifferences(i,a).reduce((c,d)=>(c[d]=o(a[d]),c),{});Object.keys(s).length||Object.keys(l).length?(Reflect.set(t,r,s),Reflect.set(n,r,l)):(Reflect.deleteProperty(t,r),Reflect.deleteProperty(n,r))}}static diffArrays(t,n,r,o){if(!(!t[r]&&!n[r])&&(Array.isArray(t[r])||Array.isArray(n[r]))){let i=Array.isArray(t[r])?t[r]:[],a=Array.isArray(n[r])?n[r]:[],s=bt(e.getLeftDifferences(bt(i,o),bt(a,o))),l=bt(e.getRightDifferences(bt(i,o),bt(a,o)));if(Object.keys(s).length||Object.keys(l).length){let c=i.filter(u=>s[o?o(u):String(u)]),d=a.filter(u=>l[o?o(u):String(u)]);Reflect.set(t,r,c),Reflect.set(n,r,d)}else Reflect.deleteProperty(t,r),Reflect.deleteProperty(n,r)}}static isLeftDifferent(t,n,r=!1){return!!this.distinctKeysIterator("left",t,n,r).next().value}static isRightDifferent(t,n,r=!1){return!!this.distinctKeysIterator("right",t,n,r).next().value}static getLeftDifferences(t,n,r=!1){return Array.from(this.distinctKeysIterator("left",t,n,r))}static getRightDifferences(t,n,r=!1){return Array.from(this.distinctKeysIterator("right",t,n,r))}static*distinctKeysIterator(t,n,r,o=!1){if(n===r)return;let i=[];t==="left"?i=Object.keys(n):t==="right"?i=Object.keys(r):t==="full"?i=Array.from(new Set([...Object.keys(n),...Object.keys(r)])):Pn(t,`Unknown distinctKeysIterator's join param "${t}"`,!0);for(let a of i){let s=n[a],l=r[a];if(s!==l){if(!o&&typeof s=="object"&&typeof l=="object"&&s!==null&&l!==null&&Bt(s,l))continue;yield a}}}},Ao=class e{constructor(t){this.delta=t}static calculate(t,n){let r=ae.calculate(t,n,void 0,e.postProcess);return new e(r)}static empty(){return new e(ae.create({},{}))}inverse(){let t=ae.create(this.delta.inserted,this.delta.deleted);return new e(t)}applyTo(t,n){try{let{selectedElementIds:r={},selectedGroupIds:o={}}=this.delta.deleted,{selectedElementIds:i={},selectedGroupIds:a={},selectedLinearElementId:s,editingLinearElementId:l,...c}=this.delta.inserted,d=ae.mergeObjects(t.selectedElementIds,i,r),u=ae.mergeObjects(t.selectedGroupIds,a,o),f=s&&n.has(s)?new K(n.get(s)):null,m=l&&n.has(l)?new K(n.get(l)):null,p={...t,...c,selectedElementIds:d,selectedGroupIds:u,selectedLinearElement:typeof s<"u"?f:t.selectedLinearElement,editingLinearElement:typeof l<"u"?m:t.editingLinearElement},h=this.filterInvisibleChanges(t,p,n);return[p,h]}catch(r){if(console.error("Couldn't apply appstate change",r),y.DEV||y.MODE===Je.TEST)throw r;return[t,!1]}}isEmpty(){return ae.isEmpty(this.delta)}static postProcess(t,n){try{ae.diffObjects(t,n,"selectedElementIds",r=>!0),ae.diffObjects(t,n,"selectedGroupIds",r=>r??!1)}catch(r){if(console.error("Couldn't postprocess appstate change deltas."),y.DEV||y.MODE===Je.TEST)throw r}finally{return[t,n]}}filterInvisibleChanges(t,n,r){let o=_o(t),i=_o(n),a=ae.isRightDifferent(e.stripElementsProps(o),e.stripElementsProps(i)),s=ae.isRightDifferent(e.stripStandaloneProps(o),e.stripStandaloneProps(i));if(!a&&!s)return!1;let l={value:a};if(s){let c=ae.getRightDifferences(e.stripStandaloneProps(o),e.stripStandaloneProps(i)),d=new Set;(c.includes("editingGroupId")||c.includes("selectedGroupIds"))&&(d=Jf(r));for(let u of c)switch(u){case"selectedElementIds":n[u]=e.filterSelectedElements(n[u],r,l);break;case"selectedGroupIds":n[u]=e.filterSelectedGroups(n[u],d,l);break;case"editingGroupId":let f=n[u];f?d.has(f)?l.value=!0:n[u]=null:l.value=!0;break;case"selectedLinearElementId":case"editingLinearElementId":let m=e.convertToAppStateKey(u),p=n[m];if(!p)l.value=!0;else{let h=r.get(p.elementId);h&&!h.isDeleted?l.value=!0:n[m]=null}break;default:Pn(u,`Unknown ObservedElementsAppState's key "${u}"`,!0)}}return l.value}static convertToAppStateKey(t){switch(t){case"selectedLinearElementId":return"selectedLinearElement";case"editingLinearElementId":return"editingLinearElement"}}static filterSelectedElements(t,n,r){let o=Object.keys(t);if(!o.length)return r.value=!0,t;let i={...t};for(let a of o){let s=n.get(a);s&&!s.isDeleted?r.value=!0:delete i[a]}return i}static filterSelectedGroups(t,n,r){if(!Object.keys(t).length)return r.value=!0,t;let i={...t};for(let a of Object.keys(i))n.has(a)?r.value=!0:delete i[a];return i}static stripElementsProps(t){let{editingGroupId:n,selectedGroupIds:r,selectedElementIds:o,editingLinearElementId:i,selectedLinearElementId:a,...s}=t;return s}static stripStandaloneProps(t){let{name:n,viewBackgroundColor:r,...o}=t;return o}},So=class e{constructor(t,n,r){this.added=t;this.removed=n;this.updated=r}static create(t,n,r,o={shouldRedistribute:!1}){let i;if(o.shouldRedistribute){let a=new Map,s=new Map,l=new Map,c=[...t,...n,...r];for(let[d,u]of c)this.satisfiesAddition(u)?a.set(d,u):this.satisfiesRemoval(u)?s.set(d,u):l.set(d,u);i=new e(a,s,l)}else i=new e(t,n,r);return(y.DEV||y.MODE===Je.TEST)&&(e.validate(i,"added",this.satisfiesAddition),e.validate(i,"removed",this.satisfiesRemoval),e.validate(i,"updated",this.satisfiesUpdate)),i}static satisfiesAddition=({deleted:t,inserted:n})=>t.isDeleted===!0&&!n.isDeleted;static satisfiesRemoval=({deleted:t,inserted:n})=>!t.isDeleted&&n.isDeleted===!0;static satisfiesUpdate=({deleted:t,inserted:n})=>!!t.isDeleted==!!n.isDeleted;static validate(t,n,r){for(let[o,i]of t[n].entries())if(!r(i))throw console.error(`Broken invariant for "${n}" delta, element "${o}", delta:`,i),new Error(`ElementsChange invariant broken for element "${o}".`)}static calculate(t,n){if(t===n)return e.empty();let r=new Map,o=new Map,i=new Map;for(let a of t.values())if(!n.get(a.id)){let l={...a,isDeleted:!1},c={isDeleted:!0},d=ae.create(l,c,e.stripIrrelevantProps);o.set(a.id,d)}for(let a of n.values()){let s=t.get(a.id);if(!s){let l={isDeleted:!0},c={...a,isDeleted:!1},d=ae.create(l,c,e.stripIrrelevantProps);r.set(a.id,d);continue}if(s.versionNonce!==a.versionNonce){let l=ae.calculate(s,a,e.stripIrrelevantProps,e.postProcess);if(typeof s.isDeleted=="boolean"&&typeof a.isDeleted=="boolean"&&s.isDeleted!==a.isDeleted){s.isDeleted&&!a.isDeleted?r.set(a.id,l):o.set(a.id,l);continue}ae.isEmpty(l)||i.set(a.id,l)}}return e.create(r,o,i)}static empty(){return e.create(new Map,new Map,new Map)}inverse(){let t=i=>{let a=new Map;for(let[s,l]of i.entries())a.set(s,ae.create(l.inserted,l.deleted));return a},n=t(this.added),r=t(this.removed),o=t(this.updated);return e.create(r,n,o)}isEmpty(){return this.added.size===0&&this.removed.size===0&&this.updated.size===0}applyLatestChanges(t){let n=s=>l=>{let c={};for(let d of Object.keys(l))switch(d){case"boundElements":c[d]=l[d];break;default:c[d]=s[d]}return c},r=s=>{let l=new Map;for(let[c,d]of s.entries()){let u=t.get(c);if(u){let f=ae.create(d.deleted,d.inserted,n(u),"inserted");l.set(c,f)}else l.set(c,d)}return l},o=r(this.added),i=r(this.removed),a=r(this.updated);return e.create(o,i,a,{shouldRedistribute:!0})}applyTo(t,n){let r=Gt(new Map(t)),o,i={containsVisibleDifference:!1,containsZindexDifference:!1};try{let a=e.createApplier(r,n,i),s=a(this.added),l=a(this.removed),c=a(this.updated),d=this.resolveConflicts(t,r);o=new Map([...s,...l,...c,...d])}catch(a){if(console.error("Couldn't apply elements change",a),y.DEV||y.MODE===Je.TEST)throw a;return[t,!0]}try{e.redrawTextBoundingBoxes(r,o),e.redrawBoundArrows(r,o),r=e.reorderElements(r,o,i)}catch(a){if(console.error("Couldn't mutate elements after applying elements change",a),y.DEV||y.MODE===Je.TEST)throw a}finally{return[r,i.containsVisibleDifference]}}static createApplier=(t,n,r)=>{let o=e.createGetter(t,n,r);return i=>Array.from(i.entries()).reduce((a,[s,l])=>{let c=o(s,l.inserted);if(c){let d=e.applyDelta(c,l,r);t.set(d.id,d),a.set(d.id,d)}return a},new Map)};static createGetter=(t,n,r)=>(o,i)=>{let a=t.get(o);return a||(a=n.get(o),a&&(r.containsZindexDifference=!0,(i.isDeleted===!1||i.isDeleted!==!0&&a.isDeleted===!1)&&(r.containsVisibleDifference=!0))),a};static applyDelta(t,n,r={containsVisibleDifference:!0,containsZindexDifference:!0}){let{boundElements:o,...i}=n.inserted;if(n.deleted.boundElements?.length||n.inserted.boundElements?.length){let a=ae.mergeArrays(t.boundElements,n.inserted.boundElements,n.deleted.boundElements,s=>s.id);Object.assign(i,{boundElements:a})}if(!r.containsVisibleDifference){let{index:a,...s}=i,l=e.checkForVisibleDifference(t,s);r.containsVisibleDifference=l}return r.containsZindexDifference||(r.containsZindexDifference=n.deleted.index!==n.inserted.index),Ye(t,i)}static checkForVisibleDifference(t,n){return t.isDeleted&&n.isDeleted!==!1?!1:t.isDeleted&&n.isDeleted===!1||t.isDeleted===!1&&n.isDeleted?!0:ae.isRightDifferent(t,n)}resolveConflicts(t,n){let r=new Map,o=(c,d)=>{let u=n.get(c.id);if(!u)return;let f;t.get(c.id)===u?f=Ye(u,d):f=O(u,d),r.set(f.id,f),n.set(f.id,f)};for(let[c]of this.removed)e.unbindAffected(t,n,c,o);for(let[c]of this.added)e.rebindAffected(t,n,c,o);for(let[c]of Array.from(this.updated).filter(([d,u])=>Object.keys({...u.deleted,...u.inserted}).find(f=>Ef.has(f)))){let d=n.get(c);!d||d.isDeleted||e.rebindAffected(t,n,c,o)}let i=new Map(Array.from(t).filter(([c])=>r.has(c))),{added:a,removed:s,updated:l}=e.calculate(i,r);for(let[c,d]of a)this.added.set(c,d);for(let[c,d]of s)this.removed.set(c,d);for(let[c,d]of l)this.updated.set(c,d);return r}static unbindAffected(t,n,r,o){let i=()=>t.get(r),a=()=>n.get(r);dn.unbindAffected(n,i(),o),dn.unbindAffected(n,a(),o),un.unbindAffected(n,i(),o),un.unbindAffected(n,a(),o)}static rebindAffected(t,n,r,o){let i=()=>t.get(r),a=()=>n.get(r);dn.unbindAffected(n,i(),o),dn.rebindAffected(n,a(),o),un.unbindAffected(n,i(),(s,l)=>{Y(s)&&o(s,l)}),un.rebindAffected(n,a(),o)}static redrawTextBoundingBoxes(t,n){let r=new Map;for(let o of n.values()){if(be(o)){let{containerId:i}=o,a=i?t.get(i):void 0;a&&r.set(a.id,{container:a,boundText:o})}if(ir(o)){let i=Ut(o),a=i?t.get(i):void 0;a&&r.set(o.id,{container:o,boundText:a})}}for(let{container:o,boundText:i}of r.values())o.isDeleted||i.isDeleted||Zs(i,o,t,!1)}static redrawBoundArrows(t,n){for(let r of n.values())!r.isDeleted&&Mn(r)&&St(r,t)}static reorderElements(t,n,r){if(!r.containsZindexDifference)return t;let o=Array.from(t.values()),i=Em([...o]);return!r.containsVisibleDifference&&ae.isRightDifferent(o,i,!0)&&(r.containsVisibleDifference=!0),X(To(i,n))}static postProcess(t,n){try{ae.diffArrays(t,n,"boundElements",r=>r.id)}catch(r){if(console.error("Couldn't postprocess elements change deltas."),y.DEV||y.MODE===Je.TEST)throw r}finally{return[t,n]}}static stripIrrelevantProps(t){let{id:n,updated:r,version:o,versionNonce:i,seed:a,...s}=t;return s}};g();var Ki=class{subscribers=[];on(...t){let n=t.flat().filter(r=>typeof r=="function");return this.subscribers.push(...n),()=>this.off(n)}once(...t){let n=t.flat().filter(o=>typeof o=="function");n.push(()=>r());let r=this.on(...n);return r}off(...t){let n=t.flat();this.subscribers=this.subscribers.filter(r=>!n.includes(r))}trigger(...t){for(let n of this.subscribers)n(...t);return this}clear(){this.subscribers=[]}};var wm="__observedAppState",_o=e=>{let t={name:e.name,editingGroupId:e.editingGroupId,viewBackgroundColor:e.viewBackgroundColor,selectedElementIds:e.selectedElementIds,selectedGroupIds:e.selectedGroupIds,editingLinearElementId:e.editingLinearElement?.elementId||null,selectedLinearElementId:e.selectedLinearElement?.elementId||null};return Reflect.defineProperty(t,wm,{value:!0,enumerable:!1}),t},T0=e=>!!Reflect.get(e,wm),Tr={CAPTURE:"capture",UPDATE:"update",NONE:"none"},ll=class{constructor(t,n){this.elementsChange=t;this.appStateChange=n}},xm=class{onStoreIncrementEmitter=new Ki;scheduledActions=new Set;_snapshot=ji.empty();get snapshot(){return this._snapshot}set snapshot(t){this._snapshot=t}shouldCaptureIncrement=()=>{this.scheduleAction(Tr.CAPTURE)};shouldUpdateSnapshot=()=>{this.scheduleAction(Tr.UPDATE)};scheduleAction=t=>{this.scheduledActions.add(t),this.satisfiesScheduledActionsInvariant()};commit=(t,n)=>{try{this.scheduledActions.has(Tr.CAPTURE)?this.captureIncrement(t,n):this.scheduledActions.has(Tr.UPDATE)&&this.updateSnapshot(t,n)}finally{this.satisfiesScheduledActionsInvariant(),this.scheduledActions=new Set}};captureIncrement=(t,n)=>{let r=this.snapshot,o=this.snapshot.maybeClone(t,n);if(r!==o){let i=o.meta.didElementsChange?So.calculate(r.elements,o.elements):So.empty(),a=o.meta.didAppStateChange?Ao.calculate(r.appState,o.appState):Ao.empty();(!i.isEmpty()||!a.isEmpty())&&this.onStoreIncrementEmitter.trigger(new ll(i,a)),this.snapshot=o}};updateSnapshot=(t,n)=>{let r=this.snapshot.maybeClone(t,n);this.snapshot!==r&&(this.snapshot=r)};filterUncomittedElements=(t,n)=>{for(let[r,o]of t.entries()){if(!n.get(r))continue;let a=this.snapshot.elements.get(r);a?a.version<o.version&&n.set(r,a):n.delete(r)}return n};clear=()=>{this.snapshot=ji.empty(),this.scheduledActions=new Set};satisfiesScheduledActionsInvariant=()=>{if(!(this.scheduledActions.size>=0&&this.scheduledActions.size<=3)){let t=`There can be at most three store actions scheduled at the same time, but there are "${this.scheduledActions.size}".`;if(console.error(t,this.scheduledActions.values()),y.DEV||y.MODE===Je.TEST)throw new Error(t)}}},ji=class e{constructor(t,n,r={didElementsChange:!1,didAppStateChange:!1,isEmpty:!1}){this.elements=t;this.appState=n;this.meta=r}static empty(){return new e(new Map,_o(et()),{didElementsChange:!1,didAppStateChange:!1,isEmpty:!0})}isEmpty(){return this.meta.isEmpty}maybeClone(t,n){let r=this.maybeCreateElementsSnapshot(t),o=this.maybeCreateAppStateSnapshot(n),i=!1,a=!1;return this.elements!==r&&(i=!0),this.appState!==o&&(a=!0),!i&&!a?this:new e(r,o,{didElementsChange:i,didAppStateChange:a})}maybeCreateAppStateSnapshot(t){if(!t)return this.appState;let n=T0(t)?t:_o(t);return this.detectChangedAppState(n)?n:this.appState}detectChangedAppState(t){return!Bt(this.appState,t,{selectedElementIds:Bt,selectedGroupIds:Bt})}maybeCreateElementsSnapshot(t){return t?this.detectChangedElements(t)?this.createElementsSnapshot(t):this.elements:this.elements}detectChangedElements(t){if(this.elements===t)return!1;if(this.elements.size!==t.size)return!0;let n=Array.from(t.keys());for(let r=n.length-1;r>=0;r--){let o=this.elements.get(n[r]),i=t.get(n[r]);if(!o||!i||o.id!==i.id||o.versionNonce!==i.versionNonce)return!0}return!1}createElementsSnapshot(t){let n=new Map;for(let[r,o]of this.elements.entries())t.get(r)?n.set(r,o):n.set(r,Ye(o,{isDeleted:!0}));for(let[r,o]of t.entries()){let i=n.get(r);(!i||i&&i.versionNonce!==o.versionNonce)&&n.set(r,wo(o))}return n}};var Wt=new Map,A0=/^(?:http(?:s)?:\/\/)?(?:www\.)?youtu(?:be\.com|\.be)\/(embed\/|watch\?v=|shorts\/|playlist\?list=|embed\/videoseries\?list=)?([a-zA-Z0-9_-]+)(?:\?t=|&t=|\?start=|&start=)?([a-zA-Z0-9_-]+)?[^\s]*$/,S0=/^(?:http(?:s)?:\/\/)?(?:(?:w){3}\.)?(?:player\.)?vimeo\.com\/(?:video\/)?([^?\s]+)(?:\?.*)?$/,_0=/^https:\/\/(?:www\.)?figma\.com/,bm=/^https:\/\/gist\.github\.com\/([\w_-]+)\/([\w_-]+)/,I0=/^<script[\s\S]*?\ssrc=["'](https:\/\/gist\.github\.com\/.*?)\.js["']/i,ym=/(?:https?:\/\/)?(?:(?:w){3}\.)?(?:twitter|x)\.com\/[^/]+\/status\/(\d+)/,P0=/^<blockquote[\s\S]*?\shref=["'](https?:\/\/(?:twitter|x)\.com\/[^"']*)/i,M0=/^https:\/\/(?:www\.)?val\.town\/(v|embed)\/[a-zA-Z_$][0-9a-zA-Z_$]+\.[a-zA-Z_$][0-9a-zA-Z_$]+/,D0=/^<(?:iframe|blockquote)[\s\S]*?\s(?:src|href)=["']([^"']*)["'][\s\S]*?>$/i,vm=/giphy.com\/(?:clips|embed|gifs)\/[a-zA-Z0-9]*?-?([a-zA-Z0-9]+)(?:[^a-zA-Z0-9]|$)/,cl=new Set(["youtube.com","youtu.be","vimeo.com","player.vimeo.com","figma.com","link.excalidraw.com","gist.github.com","twitter.com","x.com","*.simplepdf.eu","stackblitz.com","val.town","giphy.com"]),Tm=new Set(["youtube.com","youtu.be","vimeo.com","player.vimeo.com","figma.com","twitter.com","x.com","*.simplepdf.eu","stackblitz.com"]),Am=e=>`<html><body>${e}</body></html>`,Sm=e=>{if(!e)return null;if(Wt.has(e))return Wt.get(e);let t=e,n=Tm.has(dl(e,Tm)||""),r="generic",o={w:560,h:840},i=e.match(A0);if(i?.[2]){let c=i[3]?`&start=${i[3]}`:"",d=e.includes("shorts");switch(r="video",i[1]){case"embed/":case"watch?v=":case"shorts/":e=`https://www.youtube.com/embed/${i[2]}?enablejsapi=1${c}`;break;case"playlist?list=":case"embed/videoseries?list=":e=`https://www.youtube.com/embed/videoseries?list=${i[2]}&enablejsapi=1${c}`;break;default:e=`https://www.youtube.com/embed/${i[2]}?enablejsapi=1${c}`;break}return o=d?{w:315,h:560}:{w:560,h:315},Wt.set(t,{link:e,intrinsicSize:o,type:r,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:o,type:r,sandbox:{allowSameOrigin:n}}}let a=e.match(S0);if(a?.[1]){let c=a?.[1],d=/^\d+$/.test(c)?void 0:new URIError("Invalid embed link format");return r="video",e=`https://player.vimeo.com/video/${c}?api=1`,o={w:560,h:315},Wt.set(t,{link:e,intrinsicSize:o,type:r,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:o,type:r,error:d,sandbox:{allowSameOrigin:n}}}if(e.match(_0))return r="generic",e=`https://www.figma.com/embed?embed_host=share&url=${encodeURIComponent(e)}`,o={w:550,h:550},Wt.set(t,{link:e,intrinsicSize:o,type:r,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:o,type:r,sandbox:{allowSameOrigin:n}};let l=e.match(M0);if(l)return e=l[1]==="embed"?l[0]:l[0].replace("/v","/embed"),Wt.set(t,{link:e,intrinsicSize:o,type:r,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:o,type:r,sandbox:{allowSameOrigin:n}};if(ym.test(e)){let c=e.match(ym)[1],d=Hi(`https://twitter.com/x/status/${c}`),u={type:"document",srcdoc:f=>Am(`<blockquote class="twitter-tweet" data-dnt="true" data-theme="${f}"><a href="${d}"></a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"><\/script>`),intrinsicSize:{w:480,h:480},sandbox:{allowSameOrigin:n}};return Wt.set(t,u),u}if(bm.test(e)){let[,c,d]=e.match(bm),u=Hi(`https://gist.github.com/${c}/${d}`),f={type:"document",srcdoc:()=>Am(`
          <script src="${u}.js"><\/script>
          <style type="text/css">
            * { margin: 0px; }
            table, .gist { height: 100%; }
            .gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
          </style>
        `),intrinsicSize:{w:550,h:720},sandbox:{allowSameOrigin:n}};return Wt.set(e,f),f}return Wt.set(e,{link:e,intrinsicSize:o,type:r,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:o,type:r,sandbox:{allowSameOrigin:n}}},qi=e=>{let t;Zr(e)?t="IFrame element":t=!e.link||e?.link===""?"Empty Web-Embed":e.link;let n=Math.max(Math.min(e.width/2,e.width/t.length),e.width/30),r=pe.Helvetica,o=Ee({fontSize:n,fontFamily:r});return Mt({x:e.x+e.width/2,y:e.y+e.height/2,strokeColor:e.strokeColor!=="transparent"?e.strokeColor:"black",backgroundColor:"transparent",fontFamily:r,fontSize:n,text:Er(t,o,e.width-20),textAlign:"center",verticalAlign:Rt.MIDDLE,angle:e.angle??0})},n2=om({name:"setEmbeddableAsActiveTool",trackEvent:{category:"toolbar"},target:"Tool",label:"toolBar.embeddable",perform:(e,t,n,r)=>{let o=Wr(t,{type:"embeddable"});return lm(r.canvas,{...t,activeTool:o}),{elements:e,appState:{...t,activeTool:Wr(t,{type:"embeddable"})},storeAction:Tr.NONE}}}),dl=(e,t)=>{try{let{hostname:n}=new URL(e),r=n.replace(/^www\./,"");if(t instanceof Set){if(cl.has(r))return r;let i=r.replace(/^([^.]+)/,"*");return cl.has(i)?i:null}let o=t.replace(/^www\./,"");if(r===o)return o}catch{}return null},r2=e=>{let t=e.match(P0);if(t&&t.length===2)return t[1];let n=e.match(I0);if(n&&n.length===2)return n[1];if(vm.test(e))return`https://giphy.com/embed/${vm.exec(e)[1]}`;let r=e.match(D0);return r&&r.length===2?r[1]:e},o2=(e,t)=>{if(!e)return!1;if(t!=null)if(typeof t=="function"){let n=t(e);if(typeof n=="boolean")return n}else{if(typeof t=="boolean")return t;if(t instanceof RegExp)return t.test(e);if(Array.isArray(t)){for(let n of t)if(n instanceof RegExp){if(e.match(n))return!0}else if(dl(e,n))return!0;return!1}}return!!dl(e,cl)};var Io=(e,t,n)=>{if(typeof n>"u")return e.draw(t);let r={sets:t.sets,shape:t.shape,options:{...t.options,fixedDecimalPlaceDigits:n}};return e.draw(r)},Po=(e,t,n,r,o)=>{if(!r.enabled||!r.clip)return null;let i=Ce(e,o);if(i){let a=t.ownerDocument.createElementNS(Q,"g");return a.setAttributeNS(Q,"clip-path",`url(#${i.id})`),n.forEach(s=>a.appendChild(s)),a}return null},Ji=(e,t,n,r,o,i,a,s)=>{let l={x:i,y:a},[c,d,u,f]=N(e,t),m=(u-c)/2-(e.x-c),p=(f-d)/2-(e.y-d);if(Y(e)){let v=Se(e,t);if(j(v)){let[T,b,D,A]=N(v,t),S=K.getBoundTextElementPosition(v,e,t);m=(D-T)/2-(S.x-T),p=(A-b)/2-(S.y-b),i=i+S.x-e.x,a=a+S.y-e.y}}let h=180*e.angle/Math.PI,E=r;if(e.link){let v=r.ownerDocument.createElementNS(Q,"a");v.setAttribute("href",br(e.link)),E.appendChild(v),E=v}let x=(v,T)=>{Nt()&&v.setAttribute("data-id",T.id),E.appendChild(v)},w=(Ce(e,t)?.opacity??100)*e.opacity/1e4;switch(e.type){case"selection":throw new Error("Selection rendering is not supported for SVG");case"rectangle":case"diamond":case"ellipse":{let v=le.generateElementShape(e,null),T=Io(n,v,rr);w!==1&&(T.setAttribute("stroke-opacity",`${w}`),T.setAttribute("fill-opacity",`${w}`)),T.setAttribute("stroke-linecap","round"),T.setAttribute("transform",`translate(${i||0} ${a||0}) rotate(${h} ${m} ${p})`);let b=Po(e,E,[T],s.frameRendering,t);x(b||T,e);break}case"iframe":case"embeddable":{let v=le.generateElementShape(e,s),T=Io(n,v,rr),b=e.opacity/100;b!==1&&(T.setAttribute("stroke-opacity",`${b}`),T.setAttribute("fill-opacity",`${b}`)),T.setAttribute("stroke-linecap","round"),T.setAttribute("transform",`translate(${i||0} ${a||0}) rotate(${h} ${m} ${p})`),x(T,e);let D=qi(e);Ji(D,t,n,E,o,D.x+l.x-e.x,D.y+l.y-e.y,s);let A=Io(n,v,rr);for(A.setAttribute("stroke-linecap","round"),A.setAttribute("transform",`translate(${i||0} ${a||0}) rotate(${h} ${m} ${p})`);A.firstChild;)A.removeChild(A.firstChild);let S=Vt(Math.min(e.width,e.height),e),I=Sm(nm(e.link||""));if(s.renderEmbeddables===!1||I?.type==="document"){let P=r.ownerDocument.createElementNS(Q,"a");P.setAttribute("href",br(e.link||"")),P.setAttribute("target","_blank"),P.setAttribute("rel","noopener noreferrer"),P.style.borderRadius=`${S}px`,A.appendChild(P)}else{let P=r.ownerDocument.createElementNS(Q,"foreignObject");P.style.width=`${e.width}px`,P.style.height=`${e.height}px`,P.style.border="none";let _=P.ownerDocument.createElementNS(Q,"div");_.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),_.style.width="100%",_.style.height="100%";let M=_.ownerDocument.createElement("iframe");M.src=I?.link??"",M.style.width="100%",M.style.height="100%",M.style.border="none",M.style.borderRadius=`${S}px`,M.style.top="0",M.style.left="0",M.allowFullscreen=!0,_.appendChild(M),P.appendChild(_),A.appendChild(P)}x(A,e);break}case"line":case"arrow":{let v=q(e,t),T=r.ownerDocument.createElementNS(Q,"mask");if(v){T.setAttribute("id",`mask-${e.id}`);let S=r.ownerDocument.createElementNS(Q,"rect");i=i||0,a=a||0,S.setAttribute("x","0"),S.setAttribute("y","0"),S.setAttribute("fill","#fff"),S.setAttribute("width",`${e.width+100+i}`),S.setAttribute("height",`${e.height+100+a}`),T.appendChild(S);let I=r.ownerDocument.createElementNS(Q,"rect"),P=K.getBoundTextElementPosition(e,v,t),_=i+P.x-e.x,M=a+P.y-e.y;I.setAttribute("x",_.toString()),I.setAttribute("y",M.toString()),I.setAttribute("fill","#000"),I.setAttribute("width",`${v.width}`),I.setAttribute("height",`${v.height}`),I.setAttribute("opacity","1"),T.appendChild(I)}let b=r.ownerDocument.createElementNS(Q,"g");v&&b.setAttribute("mask",`url(#mask-${e.id})`),b.setAttribute("stroke-linecap","round"),le.generateElementShape(e,s).forEach(S=>{let I=Io(n,S,rr);w!==1&&(I.setAttribute("stroke-opacity",`${w}`),I.setAttribute("fill-opacity",`${w}`)),I.setAttribute("transform",`translate(${i||0} ${a||0}) rotate(${h} ${m} ${p})`),e.type==="line"&&_t(e.points)&&e.backgroundColor!=="transparent"&&I.setAttribute("fill-rule","evenodd"),b.appendChild(I)});let A=Po(e,E,[b,T],s.frameRendering,t);A?(x(A,e),E.appendChild(A)):(x(b,e),E.append(T));break}case"freedraw":{let v=le.generateElementShape(e,s),T=v?Io(n,v,rr):r.ownerDocument.createElementNS(Q,"g");w!==1&&(T.setAttribute("stroke-opacity",`${w}`),T.setAttribute("fill-opacity",`${w}`)),T.setAttribute("transform",`translate(${i||0} ${a||0}) rotate(${h} ${m} ${p})`),T.setAttribute("stroke","none");let b=r.ownerDocument.createElementNS(Q,"path");b.setAttribute("fill",e.strokeColor),b.setAttribute("d",Js(e)),T.appendChild(b);let D=Po(e,E,[T],s.frameRendering,t);x(D||T,e);break}case"image":{let v=Math.round(e.width),T=Math.round(e.height),b=yt(e)&&o[e.fileId];if(b){let D=`image-${b.id}`,A=r.querySelector(`#${D}`);if(!A){A=r.ownerDocument.createElementNS(Q,"symbol"),A.id=D;let _=r.ownerDocument.createElementNS(Q,"image");_.setAttribute("width","100%"),_.setAttribute("height","100%"),_.setAttribute("href",b.dataURL),A.appendChild(_),E.prepend(A)}let S=r.ownerDocument.createElementNS(Q,"use");if(S.setAttribute("href",`#${D}`),s.exportWithDarkMode&&b.mimeType!==F.svg&&S.setAttribute("filter",qs),S.setAttribute("width",`${v}`),S.setAttribute("height",`${T}`),S.setAttribute("opacity",`${w}`),e.scale[0]!==1||e.scale[1]!==1){let _=e.scale[0]!==1?-v:0,M=e.scale[1]!==1?-T:0;S.setAttribute("transform",`scale(${e.scale[0]}, ${e.scale[1]}) translate(${_} ${M})`)}let I=r.ownerDocument.createElementNS(Q,"g");if(I.appendChild(S),I.setAttribute("transform",`translate(${i||0} ${a||0}) rotate(${h} ${m} ${p})`),e.roundness){let _=r.ownerDocument.createElementNS(Q,"clipPath");_.id=`image-clipPath-${e.id}`;let M=r.ownerDocument.createElementNS(Q,"rect"),k=Vt(Math.min(e.width,e.height),e);M.setAttribute("width",`${e.width}`),M.setAttribute("height",`${e.height}`),M.setAttribute("rx",`${k}`),M.setAttribute("ry",`${k}`),_.appendChild(M),x(_,e),I.setAttributeNS(Q,"clip-path",`url(#${_.id})`)}let P=Po(e,E,[I],s.frameRendering,t);x(P||I,e)}break}case"frame":case"magicframe":{if(s.frameRendering.enabled&&s.frameRendering.outline){let v=document.createElementNS(Q,"rect");v.setAttribute("transform",`translate(${i||0} ${a||0}) rotate(${h} ${m} ${p})`),v.setAttribute("width",`${e.width}px`),v.setAttribute("height",`${e.height}px`),v.setAttribute("rx",xe.radius.toString()),v.setAttribute("ry",xe.radius.toString()),v.setAttribute("fill","none"),v.setAttribute("stroke",xe.strokeColor),v.setAttribute("stroke-width",xe.strokeWidth.toString()),x(v,e)}break}default:if(Y(e)){let v=r.ownerDocument.createElementNS(Q,"g");w!==1&&(v.setAttribute("stroke-opacity",`${w}`),v.setAttribute("fill-opacity",`${w}`)),v.setAttribute("transform",`translate(${i||0} ${a||0}) rotate(${h} ${m} ${p})`);let T=e.text.replace(/\r\n?/g,`
`).split(`
`),b=hr(e.fontSize,e.lineHeight),D=e.textAlign==="center"?e.width/2:e.textAlign==="right"?e.width:0,A=Ri(e.fontFamily,e.fontSize,b),S=li(e.text)?"rtl":"ltr",I=e.textAlign==="center"?"middle":e.textAlign==="right"||S==="rtl"?"end":"start";for(let _=0;_<T.length;_++){let M=r.ownerDocument.createElementNS(Q,"text");M.textContent=T[_],M.setAttribute("x",`${D}`),M.setAttribute("y",`${_*b+A}`),M.setAttribute("font-family",rs(e)),M.setAttribute("font-size",`${e.fontSize}px`),M.setAttribute("fill",e.strokeColor),M.setAttribute("text-anchor",I),M.setAttribute("style","white-space: pre;"),M.setAttribute("direction",S),M.setAttribute("dominant-baseline","alphabetic"),v.appendChild(M)}let P=Po(e,E,[v],s.frameRendering,t);x(P||v,e)}else throw new Error(`Unimplemented type ${e.type}`)}},_m=(e,t,n,r,o,i)=>{r&&(e.filter(a=>!tt(a)).forEach(a=>{if(!a.isDeleted){if(Y(a)&&a.containerId&&t.has(a.containerId))return;try{Ji(a,t,n,r,o,a.x+i.offsetX,a.y+i.offsetY,i);let s=q(a,t);s&&Ji(s,t,n,r,o,s.x+i.offsetX,s.y+i.offsetY,i)}catch(s){console.error(s)}}}),e.filter(a=>tt(a)).forEach(a=>{if(!a.isDeleted)try{Ji(a,t,n,r,o,a.x+i.offsetX,a.y+i.offsetY,i)}catch(s){console.error(s)}}))};g();g();g();var Ar=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{}catch{return!1}else if("showOpenFilePicker"in self)return"showOpenFilePicker";return!1})(),C0=Ar?import("./file-open-002ab408-MILJ6BM2.js"):import("./file-open-7c801643-BHFKUUBS.js");async function Im(...e){return(await C0).default(...e)}var y2=Ar?import("./directory-open-4ed118d0-57WBH3LL.js"):import("./directory-open-01563666-OLGZGYEQ.js");var L0=Ar?import("./file-save-745eba88-CGSHK46Y.js"):import("./file-save-3189631c-IHOU4DOS.js");async function Pm(...e){return(await L0).default(...e)}var Mm=500,Dm=e=>{let t=e.extensions?.reduce((r,o)=>(r.push(F[o]),r),[]),n=e.extensions?.reduce((r,o)=>o==="jpg"?r.concat(".jpg",".jpeg"):r.concat(`.${o}`),[]);return Im({description:e.description,extensions:n,mimeTypes:t,multiple:e.multiple??!1,legacySetup:(r,o,i)=>{let a=su(o,Mm),s=()=>{l(),document.addEventListener("keyup",a),document.addEventListener("pointerup",a),a()},l=()=>{if(i.files?.length){let d=e.multiple?[...i.files]:i.files[0];r(d)}};requestAnimationFrame(()=>{window.addEventListener("focus",s)});let c=window.setInterval(()=>{l()},Mm);return d=>{clearInterval(c),a.cancel(),window.removeEventListener("focus",s),document.removeEventListener("keyup",a),document.removeEventListener("pointerup",a),d&&(console.warn("Opening the file was canceled (legacy-fs)."),d(new Xi))}}})},ul=(e,t)=>Pm(e,{fileName:`${t.name}.${t.extension}`,description:t.description,extensions:[`.${t.extension}`]},t.fileHandle);var k0=(e,t)=>{let n={};for(let r of e)!r.isDeleted&&"fileId"in r&&r.fileId&&t[r.fileId]&&(n[r.fileId]=t[r.fileId]);return n},Mo=(e,t,n,r)=>{let o={type:Pe.excalidraw,version:es.excalidraw,source:Ja,elements:r==="local"?Qi(e):Om(e),appState:r==="local"?ai(t):tu(t),files:r==="local"?k0(e,n):void 0};return JSON.stringify(o,null,2)},N2=async(e,t,n,r=t.name||Qd)=>{let o=Mo(e,t,n,"local"),i=new Blob([o],{type:F.excalidraw});return{fileHandle:await ul(i,{name:r,extension:"excalidraw",description:"Excalidraw file",fileHandle:Cm(t.fileHandle)?null:t.fileHandle})}},B2=async(e,t)=>{let n=await Dm({description:"Excalidraw files"});return Lm(await fl(n),e,t,n.handle)},km=e=>e?.type===Pe.excalidraw&&(!e.elements||Array.isArray(e.elements)&&(!e.appState||typeof e.appState=="object")),ml=e=>typeof e=="object"&&e&&e.type===Pe.excalidrawLibrary&&(e.version===1||e.version===2),O0=e=>{let t={type:Pe.excalidrawLibrary,version:es.excalidrawLibrary,source:Ja,libraryItems:e};return JSON.stringify(t,null,2)},G2=async e=>{let t=O0(e);await ul(new Blob([t],{type:F.excalidrawlib}),{name:"library",extension:"excalidrawlib",description:"Excalidraw library file"})};g();var R0=e=>new Promise((t,n)=>{let r=new Image;r.onload=()=>{t(r)},r.onerror=o=>{n(o)},r.src=e}),Rm=async({fileIds:e,files:t,imageCache:n})=>{let r=new Map,o=new Map;return await Promise.all(e.reduce((i,a)=>{let s=t[a];return s&&!r.has(a)?(r.set(a,!0),i.concat((async()=>{try{if(s.mimeType===F.binary)throw new Error("Only images can be added to ImageCache");let l=R0(s.dataURL),c={image:l,mimeType:s.mimeType};n.set(a,c);let d=await l;n.set(a,{...c,image:d})}catch{o.set(a,!0)}})())):i},[])),{imageCache:n,updatedFiles:r,erroredFiles:o}},Fm=e=>e.filter(t=>yt(t)),F0=e=>e?.nodeName.toLowerCase()==="svg",$2=async e=>{let t=new DOMParser().parseFromString(e,F.svg),n=t.querySelector("svg");if(t.querySelector("parsererror")||!F0(n))throw new Error("Invalid SVG");if(n.hasAttribute("xmlns")||n.setAttribute("xmlns",Q),!n.hasAttribute("width")||!n.hasAttribute("height")){let o=n.getAttribute("viewBox"),i=n.getAttribute("width")||"50",a=n.getAttribute("height")||"50";if(o){let s=o.match(/\d+ +\d+ +(\d+) +(\d+)/);s&&([,i,a]=s)}n.setAttribute("width",i),n.setAttribute("height",a)}return n.outerHTML};g();g();g();g();var Nm=e=>{let{angle:t,width:n,height:r,x:o,y:i}=e,a=At(t),s=o+n/2,l=i+r/2,c=[s,l],d=[];return e.type==="diamond"?d=[se([s,i],a,c),se([o+n,l],a,c),se([s,i+r],a,c),se([o,l],a,c)]:d=[se([o,i],a,c),se([o+n,i],a,c),se([o+n,i+r],a,c),se([o,i+r],a,c)],{type:"polygon",data:d}},j2=(e,t,n=10)=>{let[r,o,i,a,s,l]=N(e,t,!0);r-=n,i+=n,o-=n,a+=n;let c=At(e.angle),d=[s,l],u=se([r,o],c,d),f=se([i,o],c,d),m=se([r,a],c,d),p=se([i,a],c,d);return{type:"polygon",data:[u,f,p,m]}},q2=e=>{let{width:t,height:n,angle:r,x:o,y:i}=e;return{type:"ellipse",data:{center:[o+t/2,i+n/2],angle:r,halfWidth:t/2,halfHeight:n/2}}},Bm=e=>{for(let t of e.sets)if(t.type==="path")return t.ops;return e.sets[0].ops},J2=(e,t=[0,0],n,r)=>{let o=l=>se([l[0]+t[0],l[1]+t[1]],At(n),r),i=Bm(e),a=[],s=[0,0];for(let l of i)if(l.op==="move"&&(s=o(l.data)),l.op==="bcurveTo"){let c=o([l.data[0],l.data[1]]),d=o([l.data[2],l.data[3]]),u=o([l.data[4],l.data[5]]);a.push([s,c,d,u]),s=u}return{type:"polycurve",data:a}},N0=e=>{let t=e[0],n=[];for(let r=1;r<e.length;r++){let o=e[r];n.push([t,o]),t=o}return n},Q2=(e,t,n=!1)=>{let r=At(e.angle),o=a=>se(As(a,[e.x,e.y]),r,t),i=N0(e.points.map(a=>o(a)));return n?{type:"polygon",data:mr(i.flat())}:{type:"polyline",data:i}},eP=(e,t,n=[0,0],r,o)=>{let i=d=>se([d[0]+n[0],d[1]+n[1]],At(r),o);if(e.roundness===null)return{type:"polygon",data:mr(e.points.map(d=>i(d)))};let a=Bm(t),s=[],l=!1;for(let d of a)d.op==="move"?(l=!l,l&&s.push([d.data[0],d.data[1]])):d.op==="bcurveTo"?l&&(s.push([d.data[0],d.data[1]]),s.push([d.data[2],d.data[3]]),s.push([d.data[4],d.data[5]])):d.op==="lineTo"&&l&&s.push([d.data[0],d.data[1]]);return{type:"polygon",data:lr(s,10,5).map(d=>i(d))}};var B0=e=>{if(e.type==="arrow")return!1;let t=!on(e.backgroundColor)||ir(e)||tt(e)||Y(e);return e.type==="line"?t&&_t(e.points):e.type==="freedraw"?t&&_t(e.points):t||di(e)},G0=({x:e,y:t,element:n,shape:r,threshold:o=10,frameNameBound:i=null})=>{let a=B0(n)?Mi([e,t],r)||so([e,t],r,o):so([e,t],r,o);return!a&&i&&(a=Mi([e,t],{type:"polygon",data:Nm(i).data})),a},pl=(e,t,n,r,o=0)=>{let[i,a,s,l]=Ge(n,r);return i-=o,a-=o,s+=o,l+=o,Gi([i,a],[e,t],[s,l])},uP=(e,t)=>!G0(e)&&pl(e.x,e.y,e.element,t),fP=(e,t,n)=>n&&Mi([e,t],n);var hl=document.createElement("img");hl.src=`data:${F.svg}, ${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#1971c2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>')}`;var El=([e,t,n,r],o,i)=>{let a=Rf,s=a/i.zoom.value,l=a/i.zoom.value,c=a/i.zoom.value,d=(e+n)/2,u=(t+r)/2,f=(a-8)/(2*i.zoom.value),m=4/i.zoom.value,p=n+m-f,h=t-m-c+f,[E,x]=H(p+s/2,h+l/2,d,u,o);return[E-s/2,x-l/2,s,l]},z0=(e,t,n,[r,o])=>{let i=4/n.zoom.value,[a,s,l,c]=N(e,t),[d,u,f,m]=El([a,s,l,c],e.angle,n);return r>d-i&&r<d+i+f&&o>u-i&&o<u+m+i},yP=(e,t,n,[r,o],i)=>!e.link||n.selectedElementIds[e.id]?!1:!i&&n.viewModeEnabled&&pl(r,o,e,t)?!0:z0(e,t,n,[r,o]);g();var SP=(e,t,n,r,o=!0)=>{e.beginPath(),e.arc(t,n,r,0,Math.PI*2),e.fill(),o&&e.stroke()},Gm=(e,t)=>[e.width/t,e.height/t],zm=({canvas:e,scale:t,normalizedWidth:n,normalizedHeight:r,theme:o,isExporting:i,viewBackgroundColor:a})=>{let s=e.getContext("2d");return s.setTransform(1,0,0,1,0,0),s.scale(t,t),i&&o===ke.DARK&&(s.filter=ri),typeof a=="string"?((a==="transparent"||a.length===5||a.length===9||/(hsla|rgba)\(/.test(a))&&s.clearRect(0,0,n,r),s.save(),s.fillStyle=a,s.fillRect(0,0,n,r),s.restore()):s.clearRect(0,0,n,r),s};var H0=(e,t,n,r,o,i,a)=>{let l;(E=>(E.Bold="#cccccc",E.Regular="#e5e5e5"))(l||={});let c=-Math.round(o.value/t)*t+n%t,d=-Math.round(o.value/t)*t+r%t,u=Math.min(1/o.value,1),f=1/o.value,m=[u*3,f+(u+f)];e.save(),e.lineWidth=u;for(let p=c;p<c+i+t*2;p+=t){let h=Math.round(p-n)%(5*t)===0;e.beginPath(),e.setLineDash(h?[]:m),e.strokeStyle=h?"#cccccc":"#e5e5e5",e.moveTo(p,d-t),e.lineTo(p,d+a+t*2),e.stroke()}for(let p=d;p<d+a+t*2;p+=t){let h=Math.round(p-r)%(5*t)===0;e.beginPath(),e.setLineDash(h?[]:m),e.strokeStyle=h?"#cccccc":"#e5e5e5",e.moveTo(c-t,p),e.lineTo(c+i+t*2,p),e.stroke()}e.restore()},Hm=(e,t,n,r)=>{t.translate(e.x+r.scrollX,e.y+r.scrollY),t.beginPath(),t.roundRect?t.roundRect(0,0,e.width,e.height,xe.radius/r.zoom.value):t.rect(0,0,e.width,e.height),t.clip(),t.translate(-(e.x+r.scrollX),-(e.y+r.scrollY))},Xt,Um=(e,t,n,r)=>{if(e.link&&!n.selectedElementIds[e.id]){let[o,i,a,s]=N(e,r),[l,c,d,u]=El([o,i,a,s],e.angle,n),f=l+d/2,m=c+u/2;if(t.save(),t.translate(n.scrollX+f,n.scrollY+m),t.rotate(e.angle),!Xt||Xt.zoom!==n.zoom.value){Xt=document.createElement("canvas"),Xt.zoom=n.zoom.value,Xt.width=d*window.devicePixelRatio*n.zoom.value,Xt.height=u*window.devicePixelRatio*n.zoom.value;let p=Xt.getContext("2d");p.scale(window.devicePixelRatio*n.zoom.value,window.devicePixelRatio*n.zoom.value),p.fillStyle="#fff",p.fillRect(0,0,d,u),p.drawImage(hl,0,0,d,u),p.restore(),t.drawImage(Xt,l-f,c-m,d,u)}else t.drawImage(Xt,l-f,c-m,d,u);t.restore()}},Vm=({canvas:e,rc:t,elementsMap:n,allElementsMap:r,visibleElements:o,scale:i,appState:a,renderConfig:s})=>{if(e===null)return;let{renderGrid:l=!0,isExporting:c}=s,[d,u]=Gm(e,i),f=zm({canvas:e,scale:i,normalizedWidth:d,normalizedHeight:u,theme:a.theme,isExporting:c,viewBackgroundColor:a.viewBackgroundColor});f.scale(a.zoom.value,a.zoom.value),l&&a.gridSize&&H0(f,a.gridSize,a.scrollX,a.scrollY,a.zoom,d/a.zoom.value,u/a.zoom.value);let m=new Set;o.forEach(p=>{p.groupIds.length>0&&a.frameToHighlight&&a.selectedElementIds[p.id]&&(hn(p,a.frameToHighlight,n)||p.groupIds.find(h=>m.has(h)))&&p.groupIds.forEach(h=>m.add(h))}),o.filter(p=>!tt(p)).forEach(p=>{try{let h=p.frameId||a.frameToHighlight?.id;if(Y(p)&&p.containerId&&n.has(p.containerId))return;if(f.save(),h&&a.frameRendering.enabled&&a.frameRendering.clip){let x=ea(p,n,a);x&&ta(p,n,a)&&Hm(x,f,s,a),gr(p,n,r,t,f,s,a)}else gr(p,n,r,t,f,s,a);let E=q(p,n);E&&gr(E,n,r,t,f,s,a),f.restore(),c||Um(p,f,a,n)}catch(h){console.error(h)}}),o.filter(p=>tt(p)).forEach(p=>{try{let h=()=>{if(gr(p,n,r,t,f,s,a),tt(p)&&(c||ui(p)&&s.embedsValidationStatus.get(p.id)!==!0)&&p.width&&p.height){let x=qi(p);gr(x,n,r,t,f,s,a)}c||Um(p,f,a,n)};if((p.frameId||a.frameToHighlight?.id)&&a.frameRendering.enabled&&a.frameRendering.clip){f.save();let x=ea(p,n,a);x&&ta(p,n,a)&&Hm(x,f,s,a),h(),f.restore()}else h()}catch(h){console.error(h)}})},U0=lu(e=>{Vm(e)},{trailing:!0}),$m=(e,t)=>{if(t){U0(e);return}Vm(e)};var V0="<!-- svg-source:excalidraw -->",$0=(e,t)=>{if(e.width<=t)return e;let r=document.createElement("canvas").getContext("2d");r.font=Ee({fontFamily:e.fontFamily,fontSize:e.fontSize});let o=e.text;if(r.measureText(o).width>t)for(let a=o.length;a>0;a--){let s=`${o.slice(0,a)}...`;if(r.measureText(s).width<=t){o=s;break}}return Ye(e,{text:o,width:t})},Y0=(e,t)=>{let n=[],r=0,o=0;for(let i of e){if(ee(i)){Kr(i)?r++:o++;let a=Mt({x:i.x,y:i.y-xe.nameOffsetY,fontFamily:pe.Assistant,fontSize:xe.nameFontSize,lineHeight:xe.nameLineHeight,strokeColor:t.exportWithDarkMode?xe.nameColorDarkTheme:xe.nameColorLightTheme,text:Km(i,Kr(i)?r:o)});a.y-=a.height,a=$0(a,i.width),n.push(a)}n.push(i)}return n},Ym=(e,t)=>(t=t||et().frameRendering,{enabled:e?!0:t.enabled,outline:e?!1:t.outline,name:e?!1:t.name,clip:e?!0:t.clip}),Wm=({elements:e,exportingFrame:t,frameRendering:n,exportWithDarkMode:r})=>{let o;return t?o=jm(e,t):n.enabled&&n.name?o=Y0(e,{exportWithDarkMode:r}):o=e,o},Xm=async(e,t,n,{exportBackground:r,exportPadding:o=Qa,viewBackgroundColor:i,exportingFrame:a},s=(l,c)=>{let d=document.createElement("canvas");return d.width=l*t.exportScale,d.height=c*t.exportScale,{canvas:d,scale:t.exportScale}})=>{let l=Ym(a??null,t.frameRendering??null),c=Wm({elements:e,exportingFrame:a,exportWithDarkMode:t.exportWithDarkMode,frameRendering:l});a&&(o=0);let[d,u,f,m]=gl(a?[a]:wl(c),o),{canvas:p,scale:h=1}=s(f,m),E=et(),{imageCache:x}=await Rm({imageCache:new Map,fileIds:Fm(c).map(w=>w.fileId),files:n});return $m({canvas:p,rc:Tt.canvas(p),elementsMap:Gt(X(c)),allElementsMap:Gt(X(zn(e))),visibleElements:c,scale:h,appState:{...t,frameRendering:l,viewBackgroundColor:r?i:null,scrollX:-d+o,scrollY:-u+o,zoom:E.zoom,shouldCacheIgnoreZoom:!1,theme:t.exportWithDarkMode?ke.DARK:ke.LIGHT},renderConfig:{canvasBackgroundColor:i,imageCache:x,renderGrid:!1,isExporting:!0,embedsValidationStatus:new Map,elementsPendingErasure:new Set}}),p},Zm=async(e,t,n,r)=>{let o=Ym(r?.exportingFrame??null,t.frameRendering??null),{exportPadding:i=Qa,exportWithDarkMode:a=!1,viewBackgroundColor:s,exportScale:l=1,exportEmbedScene:c}=t,{exportingFrame:d=null}=r||{},u=Wm({elements:e,exportingFrame:d,exportWithDarkMode:a,frameRendering:o});d&&(i=0);let f="";if(c)try{f=await(await import("./image-35KQQ5EN.js")).encodeSvgMetadata({text:Mo(e,t,n||{},"local")})}catch(P){console.error(P)}let[m,p,h,E]=gl(d?[d]:wl(u),i),x=document.createElementNS(Q,"svg");x.setAttribute("version","1.1"),x.setAttribute("xmlns",Q),x.setAttribute("viewBox",`0 0 ${h} ${E}`),x.setAttribute("width",`${h*l}`),x.setAttribute("height",`${E*l}`),a&&x.setAttribute("filter",ri);let w="https://excalidraw.com/";y.VITE_IS_EXCALIDRAW_NPM_PACKAGE&&(w=window.EXCALIDRAW_ASSET_PATH||`https://unpkg.com/${y.VITE_PKG_NAME}@${y.PKG_VERSION}`,w?.startsWith("/")&&(w=w.replace("/",`${window.location.origin}/`)),w=`${w}/dist/excalidraw-assets/`);let v=-m+i,T=-p+i,b=xl(e),D="",A=X(e);for(let P of b){let[_,M,k,U]=N(P,A),G=(k-_)/2-(P.x-_),B=(U-M)/2-(P.y-M);D+=`<clipPath id=${P.id}>
            <rect transform="translate(${P.x+v} ${P.y+T}) rotate(${P.angle} ${G} ${B})"
          width="${P.width}"
          height="${P.height}"
          >
          </rect>
        </clipPath>`}if(x.innerHTML=`
  ${V0}
  ${f}
  <defs>
    <style class="style-fonts">
      @font-face {
        font-family: "Virgil";
        src: url("${w}Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("${w}Cascadia.woff2");
      }
      @font-face {
        font-family: "Assistant";
        src: url("${w}Assistant-Regular.woff2");
      }
    </style>
    ${D}
  </defs>
  `,t.exportBackground&&s){let P=x.ownerDocument.createElementNS(Q,"rect");P.setAttribute("x","0"),P.setAttribute("y","0"),P.setAttribute("width",`${h}`),P.setAttribute("height",`${E}`),P.setAttribute("fill",s),x.appendChild(P)}let S=Tt.svg(x),I=r?.renderEmbeddables??!1;return _m(u,Gt(X(u)),S,x,n||{},{offsetX:v,offsetY:T,isExporting:!0,exportWithDarkMode:a,renderEmbeddables:I,frameRendering:o,canvasBackgroundColor:s,embedsValidationStatus:I?new Map(u.filter(P=>ee(P)).map(P=>[P.id,!0])):new Map}),x},gl=(e,t)=>{let[n,r,o,i]=De(e),a=Ve(n,o)+t*2,s=Ve(r,i)+t*2;return[n,r,a,s]},tM=(e,t,n)=>{let[,,r,o]=gl(e,t).map(i=>Math.trunc(i*n));return[r,o]};g();var W0={selection:!0,text:!0,rectangle:!0,diamond:!0,ellipse:!0,line:!0,image:!0,arrow:!0,freedraw:!0,eraser:!1,custom:!0,frame:!0,embeddable:!0,hand:!0,laser:!1,magicframe:!1},X0=e=>Object.keys(pe).includes(e)?pe[e]:Qe,qm=e=>e?{...e,focus:e.focus||0}:null,Sr=(e,t)=>{let n={type:t.type||e.type,version:e.version||1,versionNonce:e.versionNonce??0,index:e.index??null,isDeleted:e.isDeleted??!1,id:e.id||lt(),fillStyle:e.fillStyle||ne.fillStyle,strokeWidth:e.strokeWidth||ne.strokeWidth,strokeStyle:e.strokeStyle??ne.strokeStyle,roughness:e.roughness??ne.roughness,opacity:e.opacity==null?ne.opacity:e.opacity,angle:e.angle||0,x:t.x??e.x??0,y:t.y??e.y??0,strokeColor:e.strokeColor||ne.strokeColor,backgroundColor:e.backgroundColor||ne.backgroundColor,width:e.width||0,height:e.height||0,seed:e.seed??1,groupIds:e.groupIds??[],frameId:e.frameId??null,roundness:e.roundness?e.roundness:e.strokeSharpness==="round"?{type:fi(e.type)?Oe.LEGACY:Oe.PROPORTIONAL_RADIUS}:null,boundElements:e.boundElementIds?e.boundElementIds.map(r=>({type:"arrow",id:r})):e.boundElements??[],updated:e.updated??Ft(),link:e.link?br(e.link):null,locked:e.locked??!1};return("customData"in e||"customData"in t)&&(n.customData="customData"in t?t.customData:e.customData),{...n,...bl(n),...t}},Z0=e=>{switch(e.type){case"text":let t=e.fontSize,n=e.fontFamily;if("font"in e){let[i,a]=e.font.split(" ");t=parseFloat(i),n=X0(a)}let r=typeof e.text=="string"&&e.text||"",o=e.lineHeight||(e.height?Af(e):Fi(e.fontFamily));return e=Sr(e,{fontSize:t,fontFamily:n,text:r,textAlign:e.textAlign||nr,verticalAlign:e.verticalAlign||ti,containerId:e.containerId??null,originalText:e.originalText||r,lineHeight:o}),!r&&!e.isDeleted&&(e={...e,originalText:r,isDeleted:!0},e=bo(e)),e;case"freedraw":return Sr(e,{points:e.points,lastCommittedPoint:null,simulatePressure:e.simulatePressure,pressures:e.pressures});case"image":return Sr(e,{status:e.status||"pending",fileId:e.fileId,scale:e.scale||[1,1]});case"line":case"draw":case"arrow":{let{startArrowhead:i=null,endArrowhead:a=e.type==="arrow"?"arrow":null}=e,s=e.x,l=e.y,c=!Array.isArray(e.points)||e.points.length<2?[[0,0],[e.width,e.height]]:e.points;return(c[0][0]!==0||c[0][1]!==0)&&({points:c,x:s,y:l}=K.getNormalizedPoints(e)),Sr(e,{type:e.type==="draw"?"line":e.type,startBinding:qm(e.startBinding),endBinding:qm(e.endBinding),lastCommittedPoint:null,startArrowhead:i,endArrowhead:a,points:c,x:s,y:l})}case"ellipse":case"rectangle":case"diamond":case"iframe":case"embeddable":return Sr(e,{});case"magicframe":case"frame":return Sr(e,{name:e.name??null})}return null},K0=(e,t)=>{if(e.boundElements){let n=e.boundElements.slice(),r=new Set;e.boundElements=n.reduce((o,i)=>{let a=t.get(i.id);if(a&&!r.has(i.id)){if(r.add(i.id),a.isDeleted)return o;o.push(i),Y(a)&&!a.containerId&&(a.containerId=e.id)}return o},[])}},j0=(e,t)=>{let n=e.containerId?t.get(e.containerId):null;if(!n){e.containerId=null;return}if(!e.isDeleted&&n.boundElements&&!n.boundElements.find(r=>r.id===e.id)){let r=(n.boundElements||(n.boundElements=[])).slice();r.push({type:"text",id:e.id}),n.boundElements=r}},q0=(e,t)=>{e.frameId&&(t.get(e.frameId)||(e.frameId=null))},ep=(e,t,n)=>{let r=new Set,o=t?X(t):null,i=zn((e||[]).reduce((s,l)=>{if(l.type!=="selection"&&!Co(l)){let c=Z0(l);if(c){let d=o?.get(l.id);d&&d.version>c.version&&(c=bo(c,d.version)),r.has(c.id)&&(c={...c,id:lt()}),r.add(c.id),s.push(c)}}return s},[]));if(!n?.repairBindings)return i;let a=X(i);for(let s of i)s.frameId&&q0(s,a),Y(s)&&s.containerId?j0(s,a):s.boundElements&&K0(s,a),n.refreshDimensions&&Y(s)&&Object.assign(s,$i(s,Se(s,a),a));return i},J0=(e,t,n)=>{let r=t[e];return r!==void 0?r:n[e]},Jm={isSidebarDocked:(e,t)=>["defaultSidebarDockedPreference",e.isSidebarDocked??J0("defaultSidebarDockedPreference",e,t)]},Q0=(e,t)=>{e=e||{};let n=et(),r={};for(let o of Object.keys(Jm))if(o in e){let[i,a]=Jm[o](e,n);r[i]=a}for(let[o,i]of Object.entries(n)){let a=e[o],s=t?t[o]:void 0;r[o]=a!==void 0?a:s!==void 0?s:i}return{...r,cursorButton:t?.cursorButton||"up",penDetected:t?.penDetected??(e.penMode?e.penDetected??!1:!1),activeTool:{...Wr(n,r.activeTool.type&&W0[r.activeTool.type]?r.activeTool:{type:"selection"}),lastActiveTool:null,locked:r.activeTool.locked??!1},zoom:typeof e.zoom=="number"?{value:e.zoom}:e.zoom?.value?e.zoom:n.zoom,openSidebar:typeof e.openSidebar=="string"?{name:Jd.name}:r.openSidebar}},Do=(e,t,n,r)=>({elements:ep(e?.elements,n,r),appState:Q0(e?.appState,t||null),files:e?.files||{}}),Qm=e=>{let t=ep(yl(e.elements),null);return t.length?{...e,elements:t}:null},tp=(e=[],t)=>{let n=[];for(let r of e)if(Array.isArray(r)){let o=Qm({status:t,elements:r,id:lt(),created:Date.now()});o&&n.push(o)}else{let o=r,i=Qm({...o,id:o.id||lt(),status:o.status||t,created:o.created||Date.now()});i&&n.push(i)}return n};g();g();var ct=32,te=12,En=256,rp=50,Hn="NOT_SPREADSHEET",_r="VALID_SPREADSHEET",Lo=e=>{let t=/^([-+]?)[$]?([-+]?)([\d.,]+)[%]?$/.exec(e);return t?parseFloat(`${(t[1]||t[2])+t[3]}`.replace(/,/g,"")):null},vl=(e,t)=>e.slice(1).every(n=>Lo(n[t])!==null),np=e=>{let t=e[0].length;if(t>2)return{type:Hn,reason:"More than 2 columns"};if(t===1){if(!vl(e,0))return{type:Hn,reason:"Value is not numeric"};let l=Lo(e[0][0])===null,c=(l?e.slice(1):e).map(d=>Lo(d[0]));return c.length<2?{type:Hn,reason:"Less than two rows"}:{type:_r,spreadsheet:{title:l?e[0][0]:null,labels:null,values:c}}}let n=vl(e,0),r=vl(e,1);if(!n&&!r)return{type:Hn,reason:"Value is not numeric"};let[o,i]=r?[0,1]:[1,0],a=Lo(e[0][i])===null,s=a?e.slice(1):e;return s.length<2?{type:Hn,reason:"Less than 2 rows"}:{type:_r,spreadsheet:{title:a?e[0][i]:null,labels:s.map(l=>l[o]),values:s.map(l=>Lo(l[i]))}}},ew=e=>{let t=[];for(let n=0;n<e[0].length;n++){let r=[];for(let o=0;o<e.length;o++)r.push(e[o][n]);t.push(r)}return t},op=e=>{let t=e.trim().split(`
`).map(i=>i.trim().split("	"));if(t.length&&t[0].length!==2&&(t=e.trim().split(`
`).map(i=>i.trim().split(","))),t.length===0)return{type:Hn,reason:"No values"};let n=t[0].length;if(!t.every(i=>i.length===n))return{type:Hn,reason:"All rows don't have same number of columns"};let o=np(t);if(o.type!==_r){let i=np(ew(t));if(i.type===_r)return i}return o},na=zd(Bd),We={fillStyle:"hachure",fontFamily:Qe,fontSize:wt,opacity:100,roughness:1,strokeColor:z.black,roundness:null,strokeStyle:"solid",strokeWidth:1,verticalAlign:Rt.MIDDLE,locked:!1},ip=e=>{let t=(ct+te)*e.values.length+te,n=En+te*2;return{chartWidth:t,chartHeight:n}},tw=(e,t,n,r,o)=>e.labels?.map((i,a)=>Mt({groupIds:[r],backgroundColor:o,...We,text:i.length>8?`${i.slice(0,5)}...`:i,x:t+a*(ct+te)+te*2,y:n+te/2,width:ct,angle:5.87,fontSize:16,textAlign:"center",verticalAlign:"top"}))||[],nw=(e,t,n,r,o)=>{let i=Mt({groupIds:[r],backgroundColor:o,...We,x:t-te,y:n-te,text:"0",textAlign:"right"}),a=Mt({groupIds:[r],backgroundColor:o,...We,x:t-te,y:n-En-i.height/2,text:Math.max(...e.values).toLocaleString(),textAlign:"right"});return[i,a]},rw=(e,t,n,r,o)=>{let{chartWidth:i,chartHeight:a}=ip(e),s=Gn({backgroundColor:o,groupIds:[r],...We,type:"line",x:t,y:n,startArrowhead:null,endArrowhead:null,width:i,points:[[0,0],[i,0]]}),l=Gn({backgroundColor:o,groupIds:[r],...We,type:"line",x:t,y:n,startArrowhead:null,endArrowhead:null,height:a,points:[[0,0],[0,-a]]}),c=Gn({backgroundColor:o,groupIds:[r],...We,type:"line",x:t,y:n-En-te,startArrowhead:null,endArrowhead:null,strokeStyle:"dotted",width:i,opacity:rp,points:[[0,0],[i,0]]});return[s,l,c]},ap=(e,t,n,r,o,i)=>{let{chartWidth:a,chartHeight:s}=ip(e),l=e.title?Mt({backgroundColor:o,groupIds:[r],...We,text:e.title,x:t+a/2,y:n-En-te*2-wt,roundness:null,textAlign:"center"}):null,c=i?xo({backgroundColor:o,groupIds:[r],...We,type:"rectangle",x:t,y:n-s,width:a,height:s,strokeColor:z.black,fillStyle:"solid",opacity:6}):null;return[...c?[c]:[],...l?[l]:[],...tw(e,t,n,r,o),...nw(e,t,n,r,o),...rw(e,t,n,r,o)]},ow=(e,t,n)=>{let r=Math.max(...e.values),o=lt(),i=na[Math.floor(Math.random()*na.length)];return[...e.values.map((s,l)=>{let c=s/r*En;return xo({backgroundColor:i,groupIds:[o],...We,type:"rectangle",x:t+l*(ct+te)+te,y:n-c-te,width:ct,height:c})}),...ap(e,t,n,o,i,y.DEV)]},iw=(e,t,n)=>{let r=Math.max(...e.values),o=lt(),i=na[Math.floor(Math.random()*na.length)],a=0,s=[];for(let h of e.values){let E=a*(ct+te),x=-(h/r)*En;s.push([E,x]),a++}let l=Math.max(...s.map(h=>h[0])),c=Math.max(...s.map(h=>h[1])),d=Math.min(...s.map(h=>h[0])),u=Math.min(...s.map(h=>h[1])),f=Gn({backgroundColor:i,groupIds:[o],...We,type:"line",x:t+te+ct/2,y:n-te,startArrowhead:null,endArrowhead:null,height:c-u,width:l-d,strokeWidth:2,points:s}),m=e.values.map((h,E)=>{let x=E*(ct+te)+te/2,w=-(h/r)*En+te/2;return xo({backgroundColor:i,groupIds:[o],...We,fillStyle:"solid",strokeWidth:2,type:"ellipse",x:t+x+ct/2,y:n+w-te*2,width:te,height:te})}),p=e.values.map((h,E)=>{let x=E*(ct+te)+te/2,w=h/r*En+te/2+te;return Gn({backgroundColor:i,groupIds:[o],...We,type:"line",x:t+x+ct/2+te/2,y:n-w,startArrowhead:null,endArrowhead:null,height:w,strokeStyle:"dotted",opacity:rp,points:[[0,0],[0,w]]})});return[...ap(e,t,n,o,i,y.DEV),f,...p,...m]},vM=(e,t,n,r)=>e==="line"?iw(t,n,r):ow(t,n,r);var kM="clipboard"in navigator&&"readText"in navigator.clipboard,aw="clipboard"in navigator&&"writeText"in navigator.clipboard,OM="clipboard"in navigator&&"write"in navigator.clipboard&&"ClipboardItem"in window&&"toBlob"in HTMLCanvasElement.prototype,sw=e=>!!([Pe.excalidraw,Pe.excalidrawClipboard,Pe.excalidrawClipboardWithAPI].includes(e?.type)&&Array.isArray(e.elements)),RM=({types:e,files:t})=>{!e&&!t&&console.warn("createPasteEvent: no types or files provided");let n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});if(e)for(let[r,o]of Object.entries(e))try{if(n.clipboardData?.setData(r,o),n.clipboardData?.getData(r)!==o)throw new Error(`Failed to set "${r}" as clipboardData item`)}catch(i){throw new Error(i.message)}if(t){let r=-1;for(let o of t){r++;try{if(n.clipboardData?.items.add(o),n.clipboardData?.files[r]!==o)throw new Error(`Failed to set file "${o.name}" as clipboardData item`)}catch(i){throw new Error(i.message)}}}return n},lw=({elements:e,files:t})=>{let n=X(e),r=new Set(e.filter(s=>ee(s))),o=!1,i=e.reduce((s,l)=>(yt(l)&&(o=!0,t&&t[l.fileId]&&(s[l.fileId]=t[l.fileId])),s),{});o&&!t&&console.warn("copyToClipboard: attempting to file element(s) without providing associated `files` object.");let a={type:Pe.excalidrawClipboard,elements:e.map(s=>{if(Ce(s,n)&&!r.has(Ce(s,n))){let l=wo(s);return O(l,{frameId:null}),l}return s}),files:t?i:void 0};return JSON.stringify(a)},sp=async(e,t,n)=>{await Tl(lw({elements:e,files:t}),n)},cw=e=>{let t=op(e);return t.type===_r?{spreadsheet:t.spreadsheet}:null};function lp(e){let t=[];for(let n of e.childNodes)if(n.nodeType===3){let r=n.textContent?.trim();r&&t.push({type:"text",value:r})}else if(n instanceof HTMLImageElement){let r=n.getAttribute("src");r&&r.startsWith("http")&&t.push({type:"imageUrl",value:r})}else t=t.concat(lp(n));return t}var dw=e=>{let t=e.clipboardData?.getData("text/html");if(!t)return null;try{let n=new DOMParser().parseFromString(t,"text/html"),r=lp(n.body);if(r.length)return{type:"mixedContent",value:r}}catch(n){console.error(`error in parseHTMLFromPaste: ${n.message}`)}return null},FM=async()=>{let e={};try{if(navigator.clipboard?.readText)return{"text/plain":await navigator.clipboard?.readText()}}catch(n){if(navigator.clipboard?.read)console.warn(`navigator.clipboard.readText() failed (${n.message}). Failling back to navigator.clipboard.read()`);else throw n}let t;try{t=await navigator.clipboard?.read()}catch(n){if(n.name==="DataError")return console.warn(`navigator.clipboard.read() error, clipboard is probably empty: ${n.message}`),e;throw n}for(let n of t)for(let r of n.types)if(uu(Yd,r))try{e[r]=await(await n.getType(r)).text()}catch(o){console.warn(`Cannot retrieve ${r} from clipboardItem: ${o.message}`)}return Object.keys(e).length===0&&console.warn("No clipboard data found from clipboard.read()."),e},uw=async(e,t=!1)=>{try{let n=!t&&e&&dw(e);return n?n.value.every(o=>o.type==="text")?{type:"text",value:e.clipboardData?.getData("text/plain")||n.value.map(o=>o.value).join(`
`).trim()}:n:{type:"text",value:(e.clipboardData?.getData("text/plain")||"").trim()}}catch{return{type:"text",value:""}}},NM=async(e,t=!1)=>{let n=await uw(e,t);if(n.type==="mixedContent")return{mixedContent:n.value};try{let r=!t&&cw(n.value);if(r)return r}catch(r){console.error(r)}try{let r=JSON.parse(n.value),o=r.type===Pe.excalidrawClipboardWithAPI;if(sw(r))return{elements:r.elements,files:r.files,text:t?JSON.stringify(r.elements,null,2):void 0,programmaticAPI:o}}catch{}return{text:n.value}},cp=async e=>{try{await navigator.clipboard.write([new window.ClipboardItem({[F.png]:e})])}catch(t){if(ci(e))await navigator.clipboard.write([new window.ClipboardItem({[F.png]:await e})]);else throw t}},Tl=async(e,t)=>{if(aw)try{await navigator.clipboard.writeText(e||"");return}catch(n){console.error(n)}try{if(t){if(t.clipboardData?.setData("text/plain",e||""),t.clipboardData?.getData("text/plain")!==e)throw new Error("Failed to setData on clipboardEvent");return}}catch(n){console.error(n)}if(!fw(e))throw new Error("Error copying to clipboard.")},fw=e=>{e||(e=" ");let t=document.documentElement.getAttribute("dir")==="rtl",n=document.createElement("textarea");n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[t?"right":"left"]="-9999px";let r=window.pageYOffset||document.documentElement.scrollTop;n.style.top=`${r}px`,n.style.fontSize="12pt",n.setAttribute("readonly",""),n.value=e,document.body.appendChild(n);let o=!1;try{n.select(),n.setSelectionRange(0,n.value.length),o=document.execCommand("copy")}catch(i){console.error(i)}return n.remove(),o};var mw=({elements:e,appState:t,files:n,maxWidthOrHeight:r,getDimensions:o,exportPadding:i,exportingFrame:a})=>{let{elements:s,appState:l}=Do({elements:e,appState:t},null,null),{exportBackground:c,viewBackgroundColor:d}=l;return Xm(s,{...l,offsetTop:0,offsetLeft:0,width:0,height:0},n||{},{exportBackground:c,exportPadding:i,viewBackgroundColor:d,exportingFrame:a},(u,f)=>{let m=document.createElement("canvas");if(r){typeof o=="function"&&console.warn("`getDimensions()` is ignored when `maxWidthOrHeight` is supplied.");let h=Math.max(u,f),E=r<h?r/h:t?.exportScale??1;return m.width=u*E,m.height=f*E,{canvas:m,scale:E}}let p=o?.(u,f)||{width:u,height:f};return m.width=p.width,m.height=p.height,{canvas:m,scale:p.scale??1}})},pw=async e=>{let{mimeType:t=F.png,quality:n}=e;t===F.png&&typeof n=="number"&&console.warn(`"quality" will be ignored for "${F.png}" mimeType`),t==="image/jpg"&&(t=F.jpg),t===F.jpg&&!e.appState?.exportBackground&&(console.warn(`Defaulting "exportBackground" to "true" for "${F.jpg}" mimeType`),e={...e,appState:{...e.appState,exportBackground:!0}});let r=await mw(e);return n=n||(/image\/jpe?g/.test(t)?.92:.8),new Promise((o,i)=>{r.toBlob(async a=>{if(!a)return i(new Error("couldn't export to blob"));a&&t===F.png&&e.appState?.exportEmbedScene&&(a=await dp({blob:a,metadata:Mo(e.elements,e.appState,e.files||{},"local")})),o(a)},t,n)})},hw=async({elements:e,appState:t=et(),files:n={},exportPadding:r,renderEmbeddables:o,exportingFrame:i})=>{let{elements:a,appState:s}=Do({elements:e,appState:t},null,null),l={...s,exportPadding:r};return Zm(a,l,n,{exportingFrame:i,renderEmbeddables:o})},XM=async e=>{if(e.type==="svg"){let t=await hw(e);await Tl(t.outerHTML)}else if(e.type==="png")await cp(pw(e));else if(e.type==="json")await sp(e.elements,e.files);else throw new Error("Invalid export type")};g();var Ew=e=>e.type==="diamond"?[[e.width/2,0],[e.width,e.height/2],[e.width/2,e.height],[0,e.height/2]]:[[0,0],[0+e.width,0],[0+e.width,e.height],[0,e.height]],gw=e=>J(e)||ge(e)?e.points:Ew(e),up=e=>{let t=e.reduce((n,[r,o])=>(n.minY=Math.min(n.minY,o),n.minX=Math.min(n.minX,r),n.maxX=Math.max(n.maxX,r),n.maxY=Math.max(n.maxY,o),n),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,cx:0,cy:0});return t.cx=(t.maxX+t.minX)/2,t.cy=(t.maxY+t.minY)/2,t},mp=e=>{let t=gw(e),{cx:n,cy:r}=up(t),o=[n,r],i=t.map(d=>ce([d[0],d[1]],o,e.angle)),{minX:a,minY:s,maxX:l,maxY:c}=up(i);return[a+e.x,s+e.y,l+e.x,c+e.y]},fp=(e,t,n=!1)=>{let r=mp(e),o=t[0]<=r[0]&&t[2]>=r[2]&&t[1]<=r[1]&&t[3]>=r[3];return n?o?!0:r[0]<=t[0]&&r[2]>=t[2]&&r[1]<=t[1]&&r[3]>=t[3]:o},xw=(e,t)=>{let n=mp(e);return(go(n[0],t[0],t[2])||go(t[0],n[0],n[2]))&&(go(n[1],t[1],t[3])||go(t[1],n[1],n[3]))},pp=({elements:e,bounds:t,type:n,errorMargin:r=0})=>{as(t)&&(t=Ge(t,X(e)));let o=[t[0]-r,t[1]-r,t[2]+r,t[3]+r],i=new Set;for(let a of e){if(i.has(a.id))continue;if(n==="overlap"?xw(a,o):n==="inside"?fp(a,o):fp(a,o,!0)){if(i.add(a.id),a.boundElements)for(let l of a.boundElements)i.add(l.id);Y(a)&&a.containerId&&i.add(a.containerId),j(a)&&(a.startBinding&&i.add(a.startBinding.elementId),a.endBinding&&i.add(a.endBinding?.elementId))}}return e.filter(a=>i.has(a.id))};g();function hp(e){return[Math.min(e[0][0],e[1][0]),Math.min(e[0][1],e[1][1]),Math.max(e[0][0],e[1][0]),Math.max(e[0][1],e[1][1])]}function xp(e,t){return e[0]*t[1]-t[0]*e[1]}function ww(e,t){return e[0]<=t[2]&&e[2]>=t[0]&&e[1]<=t[3]&&e[3]>=t[1]}function ra(e,t){return[e[0]-t[0],e[1]-t[1]]}var bw=1e-6;function Ep(e,t){let n=ra(e[1],e[0]),r=ra(t,e[0]),o=xp(n,r);return Math.abs(o)<bw}function Al(e,t){let n=ra(e[1],e[0]),r=ra(t,e[0]);return xp(n,r)<0}function gp(e,t){return Ep(e,t[0])||Ep(e,t[1])||(Al(e,t[0])?!Al(e,t[1]):Al(e,t[1]))}function wp(e,t){return ww(hp(e),hp(t))&&gp(e,t)&&gp(t,e)}var bD=(e,t,n)=>{let r=X(e);for(let o of t)if(o.frameId){let i=n.get(o.id),a=n.get(o.frameId);if(i){let s=r.get(i);s&&O(s,{frameId:a??o.frameId},!1)}}};function bp(e,t,n){let r=ol(t,n),o=ol(e,n);return r.some(a=>o.some(s=>wp(a,s)))}var yp=(e,t,n)=>oa(Di(e,t,n,!1)).filter(r=>!ee(r)&&!r.frameId||r.frameId===t.id),vp=(e,t,n,r)=>Di(e,t,r).some(o=>o.id===n.id);var Tp=(e,t,n)=>{let[r,o,i,a]=N(t,n),[s,l,c,d]=De(e);return r<=s&&o<=l&&i>=c&&a>=d},hn=(e,t,n)=>Tp([e],t,n)||bp(e,t,n)||vp([t],e,t,n),yD=(e,t,n)=>{let[r,o,i,a]=N(t,n);return Gi([r,o],[e.x,e.y],[i,a])};var vD=e=>{let t=new Map;for(let n of e){let r=ee(n)?n.id:n.frameId;r&&!t.has(r)&&t.set(r,ko(e,r))}return t},ko=(e,t)=>{let n=[];for(let r of e.values())r.frameId===t&&n.push(r);return n},xl=e=>e.filter(t=>ee(t)),wl=e=>{let t=X(xl(e));return e.filter(n=>t.has(n.id)||!n.frameId||!t.has(n.frameId))},TD=(e,t,n,r)=>{let o=ko(e,t.id),i=new Set(o),a=new Set([...yp(e,t,r),...o.filter(f=>vp(e,f,t,r))]),s=o.filter(f=>!a.has(f)),l=new Set(Array.from(a).flatMap(f=>f.groupIds));for(let f of s)if(!bp(f,t,r))f.groupIds.length===0&&i.delete(f);else if(f.groupIds.length>0)for(let m of f.groupIds)l.add(m);for(let f of s)if(f.groupIds.length>0){let m=!0;for(let p of f.groupIds)l.has(p)&&(m=!1);m&&i.delete(f)}let c=Array.from(a).filter(f=>f.groupIds.length===0);for(let f of c)i.add(f);let d=Array.from(a).filter(f=>f.groupIds.length>0),u=jf(d,n);for(let[f,m]of Object.entries(u))if(m){let p=wr(e,f);if(Tp(p,t,r))for(let h of p)i.add(h)}return[...i].filter(f=>!(Y(f)&&f.containerId))},AD=(e,t,n)=>oa(e,yp(e,t,n)),Ce=(e,t)=>e.frameId&&t.get(e.frameId)||null,SD=(e,t)=>{let n=new Set,r=X(e);e=oa(e);for(let a of e)ee(a)&&a.id!==t.id&&n.add(a.id);let o=new Set,i=[];for(let a of e)if(!(ee(a)||a.frameId&&n.has(a.frameId)))if(a.groupIds.length){let s=a.groupIds.at(-1);if(!o.has(s)){o.add(s);let l=wr(e,s);if(l.some(c=>hn(c,t,r)))for(let c of l)i.push(c)}}else hn(a,t,r)&&i.push(a);return i},yw=(e,t,n)=>{let r=X(e),o=new Map;for(let l of e.values())l.frameId===n.id&&o.set(l.id,!0);let i=new Set(t.map(l=>l.id)),a=[],s=new Set;for(let l of t)ee(l)&&l.id!==n.id&&s.add(l.id);for(let l of oa(e,t)){if(ee(l)||l.frameId&&s.has(l.frameId))continue;o.has(l.id)||a.push(l);let c=q(l,r);c&&!i.has(c.id)&&!o.has(c.id)&&a.push(c)}for(let l of a)O(l,{frameId:n.id},!1);return e},Ap=(e,t)=>{let n=new Map,r=new Map;for(let o of e)if(o.frameId){n.set(o.id,o);let i=r.get(o.frameId)||[];i.push(o);let a=q(o,t);a&&(n.set(a.id,a),i.push(a)),r.set(o.frameId,i)}for(let[,o]of n)O(o,{frameId:null},!1)},vw=(e,t)=>{let n=ko(e,t.id);return Ap(n,X(e)),e},_D=(e,t,n,r)=>yw(vw(e,n),t,n).slice(),ID=(e,t,n)=>{let r=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,elements:e}),o=new Set(r);if(t.editingGroupId)for(let s of r)s.groupIds.length===0?o.add(s):s.groupIds.flatMap(l=>wr(e,l)).forEach(l=>o.add(l));let i=new Set,a=X(e);return o.forEach(s=>{s.frameId&&!ee(s)&&!ta(s,a,t)&&i.add(s)}),i.size>0&&Ap(i,a),e},oa=(e,t)=>{let n=new Set,r=t||e;for(let a of r.values()){let s=a.groupIds[a.groupIds.length-1];s&&n.add(s)}let o=new Set;for(let a of n)wr(e,a).some(s=>ee(s))&&o.add(a);let i=[];for(let a of r.values())o.has(a.groupIds[a.groupIds.length-1])||i.push(a);return i},ea=(e,t,n)=>{let r=Y(e)&&Se(e,t)||e;return n.selectedElementIds[r.id]&&n.selectedElementsAreBeingDragged?n.frameToHighlight:Ce(r,t)},ta=(e,t,n)=>{let r=ea(e,t,n),o=Y(e)&&Se(e,t)||e;if(r){if(!n.selectedElementIds[e.id]||!n.selectedElementsAreBeingDragged)return!0;if(o.groupIds.length===0)return hn(o,r,t);let i=new Set(o.groupIds.flatMap(a=>wr(t,a)));if(n.editingGroupId&&n.selectedElementsAreBeingDragged){let a=new Set(at(t,n));if(n.frameToHighlight!==null)return!0;a.forEach(l=>{i.delete(l)})}for(let a of i)if(ee(a))return!1;for(let a of i)if(hn(a,r,t))return!0}return!1},Km=(e,t)=>e.name===null?Kr(e)?`Frame ${t}`:`AI Frame $${t}`:e.name,jm=(e,t)=>pp({elements:e,bounds:t,type:"overlap"}).filter(n=>!n.frameId||n.frameId===t.id);var Tw=e=>{let t=new Set;return e.forEach(n=>{ee(n)&&t.add(n.id)}),e.filter(n=>!(n.frameId&&t.has(n.frameId)))},Di=(e,t,n,r=!0)=>{let[o,i,a,s]=N(t,n),l=e.filter(c=>{let[d,u,f,m]=Ge(c,n),p=Ce(c,n);if(p){let[h,E,x,w]=Ge(p,n);d=Math.max(h,d),u=Math.max(E,u),f=Math.min(x,f),m=Math.min(w,m)}return c.locked===!1&&c.type!=="selection"&&!be(c)&&o<=d&&i<=u&&a>=f&&s>=m});return l=r?Tw(l):l,l=l.filter(c=>{let d=Ce(c,n);return d?hn(c,d,n):!0}),l},RD=(e,t,n,r)=>{let o=new Set(t.map(i=>i.id));return e.filter(i=>{let a=Sp(i,n.width,n.height,n,r);return!o.has(i.id)&&a})},Jg=function(){let e=null,t=null,n=null,r=(o,i)=>(n!=null&&o===e&&i.selectedElementIds===t||(n=o.some(a=>i.selectedElementIds[a.id]),e=o,t=i.selectedElementIds),n);return r.clearCache=()=>{e=null,t=null,n=null},r}(),Qg=(e,t,n)=>{let r=Array.from(new Set(at(e,t).map(o=>n(o))));return r.length===1?r[0]:null},at=(e,t,n)=>{let r=[];for(let o of e.values()){if(t.selectedElementIds[o.id]){r.push(o);continue}if(n?.includeBoundTextElement&&be(o)&&t.selectedElementIds[o?.containerId]){r.push(o);continue}}if(n?.includeElementsInFrames){let o=[];return r.forEach(i=>{ee(i)&&ko(e,i.id).forEach(a=>o.push(a)),o.push(i)}),o}return r},ex=(e,t)=>t.editingElement?[t.editingElement]:at(e,t,{includeBoundTextElement:!0}),al=(e,t)=>Bt(t.selectedElementIds,e)?t.selectedElementIds:e;var _p=e=>{let t=new Map,n=[];for(let r of e)r.isDeleted||(n.push(r),t.set(r.id,r));return{elementsMap:t,elements:n}},Aw=e=>{let t=["includeBoundTextElement","includeElementsInFrames"],n="";for(let r of t)n+=`${r}:${e[r]?"1":"0"}`;return n},Ip=e=>typeof e=="string",Sl=class e{static sceneMapByElement=new WeakMap;static sceneMapById=new Map;static mapElementToScene(t,n){Ip(t)?this.sceneMapById.set(t,n):(this.sceneMapByElement.set(t,n),this.sceneMapById.set(t.id,n))}static getScene(t){return Ip(t)?this.sceneMapById.get(t)||null:this.sceneMapByElement.get(t)||null}callbacks=new Set;nonDeletedElements=[];nonDeletedElementsMap=Gt(new Map);elements=[];nonDeletedFramesLikes=[];frames=[];elementsMap=Gt(new Map);selectedElementsCache={selectedElementIds:null,elements:null,cache:new Map};versionNonce;getNonDeletedElementsMap(){return this.nonDeletedElementsMap}getElementsIncludingDeleted(){return this.elements}getElementsMapIncludingDeleted(){return this.elementsMap}getNonDeletedElements(){return this.nonDeletedElements}getFramesIncludingDeleted(){return this.frames}getSelectedElements(t){let n=Aw(t),r=t?.elements||this.nonDeletedElements;if(this.selectedElementsCache.elements===r&&this.selectedElementsCache.selectedElementIds===t.selectedElementIds){let i=this.selectedElementsCache.cache.get(n);if(i)return i}else t?.elements==null&&this.selectedElementsCache.cache.clear();let o=at(r,{selectedElementIds:t.selectedElementIds},t);return t?.elements==null&&(this.selectedElementsCache.selectedElementIds=t.selectedElementIds,this.selectedElementsCache.elements=this.nonDeletedElements,this.selectedElementsCache.cache.set(n,o)),o}getNonDeletedFramesLikes(){return this.nonDeletedFramesLikes}getElement(t){return this.elementsMap.get(t)||null}getVersionNonce(){return this.versionNonce}getNonDeletedElement(t){let n=this.getElement(t);return n&&Pp(n)?n:null}mapElements(t){let n=!1,r=this.elements.map(o=>{let i=t(o);return i!==o&&(n=!0),i});return n&&this.replaceAllElements(r),n}replaceAllElements(t){let n=t instanceof Array?t:Array.from(t.values()),r=[];(y.DEV||y.MODE===Je.TEST)&&sl(n.map(i=>i.index)),this.elements=zn(n),this.elementsMap.clear(),this.elements.forEach(i=>{ee(i)&&r.push(i),this.elementsMap.set(i.id,i),e.mapElementToScene(i,this)});let o=_p(this.elements);this.nonDeletedElements=o.elements,this.nonDeletedElementsMap=o.elementsMap,this.frames=r,this.nonDeletedFramesLikes=_p(this.frames).elements,this.informMutation()}informMutation(){this.versionNonce=Pt();for(let t of Array.from(this.callbacks))t()}addCallback(t){if(this.callbacks.has(t))throw new Error;return this.callbacks.add(t),()=>{if(!this.callbacks.has(t))throw new Error;this.callbacks.delete(t)}}destroy(){this.elements=[],this.nonDeletedElements=[],this.nonDeletedFramesLikes=[],this.frames=[],this.elementsMap.clear(),this.selectedElementsCache.selectedElementIds=null,this.selectedElementsCache.elements=null,this.selectedElementsCache.cache.clear(),e.sceneMapById.forEach((t,n)=>{t===this&&e.sceneMapById.delete(n)}),this.callbacks.clear()}insertElementAtIndex(t,n){if(!Number.isFinite(n)||n<0)throw new Error("insertElementAtIndex can only be called with index >= 0");let r=[...this.elements.slice(0,n),t,...this.elements.slice(n)];To(r,X([t])),this.replaceAllElements(r)}insertElementsAtIndex(t,n){if(!Number.isFinite(n)||n<0)throw new Error("insertElementAtIndex can only be called with index >= 0");let r=[...this.elements.slice(0,n),...t,...this.elements.slice(n)];To(r,X(t)),this.replaceAllElements(r)}insertElement=t=>{let n=t.frameId?this.getElementIndex(t.frameId):this.elements.length;this.insertElementAtIndex(t,n)};insertElements=t=>{let n=t[0].frameId?this.getElementIndex(t[0].frameId):this.elements.length;this.insertElementsAtIndex(t,n)};getElementIndex(t){return this.elements.findIndex(n=>n.id===t)}getContainerElement=t=>t&&t.containerId&&this.getElement(t.containerId)||null},fn=Sl;var O=(e,t,n=!0)=>{let r=!1,{points:o,fileId:i}=t;typeof o<"u"&&(t={...$f(o),...t});for(let a in t){let s=t[a];if(typeof s<"u"){if(e[a]===s&&(typeof s!="object"||s===null||a==="groupIds"||a==="scale"))continue;if(a==="scale"){let l=e[a],c=s;if(l[0]===c[0]&&l[1]===c[1])continue}else if(a==="points"){let l=e[a],c=s;if(l.length===c.length){let d=!1,u=l.length;for(;--u;){let f=l[u],m=c[u];if(f[0]!==m[0]||f[1]!==m[1]){d=!0;break}}if(!d)continue}}e[a]=s,r=!0}}return r&&((typeof t.height<"u"||typeof t.width<"u"||typeof i<"u"||typeof o<"u")&&le.delete(e),e.version++,e.versionNonce=Pt(),e.updated=Ft(),n&&fn.getScene(e)?.informMutation()),e},Ye=(e,t)=>{let n=!1;for(let r in t){let o=t[r];if(typeof o<"u"){if(e[r]===o&&(typeof o!="object"||o===null))continue;n=!0}}return n?{...e,...t,updated:Ft(),version:e.version+1,versionNonce:Pt()}:e},bo=(e,t)=>(e.version=(t??e.version)+1,e.versionNonce=Pt(),e.updated=Ft(),e);var Co=e=>J(e)||ge(e)?e.points.length<2:e.width===0&&e.height===0,Sp=(e,t,n,r,o)=>{let[i,a,s,l]=Ge(e,o),c=Xr({clientX:r.offsetLeft,clientY:r.offsetTop},r),d=Xr({clientX:r.offsetLeft+t,clientY:r.offsetTop+n},r);return c.x<=s&&c.y<=l&&d.x>=i&&d.y>=a},ia=(e,t,n)=>{let r=Math.abs(t),o=Math.abs(n);if(e==="line"||e==="arrow"||e==="freedraw"){let i=Math.round(Math.atan(o/r)/xt)*xt;i===0?n=0:i===Math.PI/2?t=0:n=r*Math.tan(i)*Math.sign(n)||n}else e!=="selection"&&(n=r*Math.sign(n));return{width:t,height:n}},Us=(e,t,n,r)=>{let o=n-e,i=r-t,a=Math.round(Math.atan(i/o)/xt)*xt;if(a===0)i=0;else if(a===Math.PI/2)o=0;else{let s=Math.tan(a),l=-1,c=t-s*e,d=-1/s,u=-1,f=r-d*n,m=(l*f-u*c)/(s*u-d*l),p=(c*d-f*s)/(s*u-d*l);o=m-e,i=p-t}return{width:o,height:i}};var bl=e=>{let t={width:e.width,height:e.height,x:e.x,y:e.y};if(e.width<0){let n=Math.abs(e.width);t.width=n,t.x=e.x-n}if(e.height<0){let n=Math.abs(e.height);t.height=n,t.y=e.y-n}return t};g();var Mp={mouse:8,pen:16,touch:28},Sw=16,Cp={e:!0,s:!0,n:!0,w:!0};var _w={e:!0,s:!0,n:!0,w:!0},Dp={e:!0,s:!0,n:!0,w:!0,nw:!0,se:!0},_l={e:!0,s:!0,n:!0,w:!0},Zt=(e,t,n,r,o,i,a)=>{let[s,l]=H(e+n/2,t+r/2,o,i,a);return[s-n/2,l-r/2,n,r]},aa=e=>!(e.viewport.isMobile||e.isTouchScreen&&(Hd||Ud)),Il=e=>aa(e)?Cp:{},sa=([e,t,n,r,o,i],a,s,l,c={},d=4)=>{let u=Mp[l],f=u/s.value,m=u/s.value,p=u/s.value,h=u/s.value,E=n-e,x=r-t,w=d/s.value,v=(u-Yr*2)/(2*s.value),T={nw:c.nw?void 0:Zt(e-w-p+v,t-w-h+v,f,m,o,i,a),ne:c.ne?void 0:Zt(n+w-v,t-w-h+v,f,m,o,i,a),sw:c.sw?void 0:Zt(e-w-p+v,r+w-v,f,m,o,i,a),se:c.se?void 0:Zt(n+w-v,r+w-v,f,m,o,i,a),rotation:c.rotation?void 0:Zt(e+E/2-f/2,t-w-h+v-Sw/s.value,f,m,o,i,a)},b=5*Mp.mouse/s.value;return Math.abs(E)>b&&(c.n||(T.n=Zt(e+E/2-f/2,t-w-h+v,f,m,o,i,a)),c.s||(T.s=Zt(e+E/2-f/2,r+w-v,f,m,o,i,a))),Math.abs(x)>b&&(c.w||(T.w=Zt(e-w-p+v,t+x/2-m/2,f,m,o,i,a)),c.e||(T.e=Zt(n+w-v,t+x/2-m/2,f,m,o,i,a))),T},Pl=(e,t,n,r="mouse",o=Cp)=>{if(e.locked)return{};if(e.type==="freedraw"||J(e)){if(e.points.length===2){let[,a]=e.points;a[0]===0||a[1]===0?o=_l:a[0]>0&&a[1]<0?o=Dp:a[0]>0&&a[1]>0?o=_l:a[0]<0&&a[1]>0?o=Dp:a[0]<0&&a[1]<0&&(o=_l)}}else Y(e)?o=_w:ee(e)&&(o={...o,rotation:!0});let i=J(e)?Yr+8:Yr;return sa(N(e,n,!0),e.angle,t,r,o,i)},pC=(e,t)=>{if(t.editingLinearElement)return!1;if(e.length>1)return!0;let n=e[0];return J(n)?n.points.length>2:!0};g();var Dl=(e,t,n)=>t>=e[0]&&t<=e[0]+e[2]&&n>=e[1]&&n<=e[1]+e[3],Lp=(e,t,n,r,o,i,a,s)=>{if(!n.selectedElementIds[e.id])return!1;let{rotation:l,...c}=Pl(e,i,t,a,Il(s));if(l&&Dl(l,r,o))return"rotation";let d=Object.keys(c).filter(u=>{let f=c[u];return f?Dl(f,r,o):!1});if(d.length>0)return d[0];if(aa(s)){let[u,f,m,p,h,E]=N(e,t);if(e.type!=="text"&&!(J(e)&&e.points.length<=2)){let x=ni/i.value,w=kp([u-x,f-x],[m+x,p+x],[h,E],At(e.angle));for(let[v,T]of Object.entries(w))if(Fn([r,o],T,x))return v}}return!1},Iw=(e,t,n,r,o,i,a,s)=>e.reduce((l,c)=>{if(l)return l;let d=Lp(c,a,t,n,r,o,i,s);return d?{element:c,transformHandleType:d}:null},null),Pw=([e,t,n,r],o,i,a,s,l)=>{let c=sa([e,t,n,r,(e+n)/2,(t+r)/2],0,a,s,Il(l)),d=Object.keys(c).find(u=>{let f=c[u];return f&&Dl(f,o,i)});if(d)return d;if(aa(l)){let u=(e+n)/2,f=(t+r)/2,m=ni/a.value,p=kp([e-m,t-m],[n+m,r+m],[u,f],At(0));for(let[h,E]of Object.entries(p))if(Fn([o,i],E,m))return h}return!1},Ml=["ns","nesw","ew","nwse"],Mw=(e,t)=>{let n=Ml.indexOf(e);if(n>=0){let r=Math.round(t/(Math.PI/4));e=Ml[(n+r)%Ml.length]}return e},Dw=e=>{let{element:t,transformHandleType:n}=e,r=t&&Math.sign(t.height)*Math.sign(t.width)===-1,o=null;switch(n){case"n":case"s":o="ns";break;case"w":case"e":o="ew";break;case"nw":case"se":r?o="nesw":o="nwse";break;case"ne":case"sw":r?o="nwse":o="nesw";break;case"rotation":return"grab"}return o&&t&&(o=Mw(o,t.angle)),o?`${o}-resize`:""},kp=([e,t],[n,r],o,i)=>{let a=se([e,t],i,o),s=se([n,t],i,o),l=se([e,r],i,o),c=se([n,r],i,o);return{n:[a,s],e:[s,c],s:[c,l],w:[l,a]}};g();var la=e=>e<0?e+2*Math.PI:e>=2*Math.PI?e-2*Math.PI:e,Cw=(e,t,n,r,o,i,a,s,l,c,d)=>{if(n.length===1){let[u]=n;return t==="rotation"?(Lw(u,r,s,l,o),St(u,r)):Y(u)&&(t==="nw"||t==="ne"||t==="sw"||t==="se")?(Ow(u,r,t,i,s,l),St(u,r)):t&&Rw(e,a,u,r,t,i,s,l),!0}else if(n.length>1){if(t==="rotation")return Nw(e,n,r,s,l,o,c,d),!0;if(t)return Fw(e,n,r,t,i,a,s,l),!0}return!1},Lw=(e,t,n,r,o)=>{let[i,a,s,l]=N(e,t),c=(i+s)/2,d=(a+l)/2,u;ee(e)?u=0:(u=5*Math.PI/2+Math.atan2(r-d,n-c),o&&(u+=xt/2,u-=u%xt),u=la(u));let f=Ut(e);if(O(e,{angle:u}),f){let m=fn.getScene(e)?.getElement(f);m&&!j(e)&&O(m,{angle:u})}},kw=(e,t,n,r)=>J(e)||ge(e)?{points:pn(0,t,pn(1,n,e.points,r),r)}:{},Cl=(e,t,n)=>{let r=e.width;if(be(e)){let a=Se(e,t);a&&(r=st(a,e))}let i=e.fontSize*(n/r);return i<ei?null:{size:i}},Ow=(e,t,n,r,o,i)=>{let[a,s,l,c,d,u]=N(e,t),[f,m]=H(o,i,d,u,-e.angle),p=0,h=0;n.includes("e")&&(p=(f-a)/(l-a)),n.includes("w")&&(p=(l-f)/(l-a)),n.includes("n")&&(h=(c-m)/(c-s)),n.includes("s")&&(h=(m-s)/(c-s));let E=Math.max(p,h);if(E>0){let x=e.width*E,w=e.height*E,v=Cl(e,t,x);if(v===null)return;let T=[a,s],b=[l,c],D=[d,u],A=[a,s];if(["n","w","nw"].includes(n)&&(A=[b[0]-Math.abs(x),b[1]-Math.abs(w)]),n==="ne"){let U=[T[0],b[1]];A=[U[0],U[1]-Math.abs(w)]}if(n==="sw"){let U=[b[0],T[1]];A=[U[0]-Math.abs(x),U[1]]}["s","n"].includes(n)&&(A[0]=D[0]-x/2),["e","w"].includes(n)&&(A[1]=D[1]-w/2),r&&(A[0]=D[0]-Math.abs(x)/2,A[1]=D[1]-Math.abs(w)/2);let S=e.angle,I=ce(A,[d,u],S),P=[A[0]+Math.abs(x)/2,A[1]+Math.abs(w)/2],_=ce(P,[d,u],S);A=ce(I,_,-S);let[M,k]=A;O(e,{fontSize:v.size,width:x,height:w,x:M,y:k})}},Rw=(e,t,n,r,o,i,a,s)=>{let l=e.get(n.id),[c,d,u,f]=xr(l,l.width,l.height,!0),m=[c,d],p=[u,f],h=uo(m,p),E=ce([a,s],h,-l.angle),[x,w,v,T]=xr(n,n.width,n.height,!0),b=v-x,D=T-w,A=p[0]-m[0],S=p[1]-m[1],I=A/b,P=S/D,_={},M=q(n,r);o.includes("e")&&(I=(E[0]-m[0])/b),o.includes("s")&&(P=(E[1]-m[1])/D),o.includes("w")&&(I=(p[0]-E[0])/b),o.includes("n")&&(P=(p[1]-E[1])/D);let k=l.width,U=l.height,G=n.width*I,B=n.height*P;if(i&&(G=2*G-k,B=2*B-U),t){let _e=Math.abs(G)/k,Yn=Math.abs(B)/U;if(o.length===1&&(B*=_e,G*=Yn),o.length===2){let xn=Math.max(_e,Yn);G=k*xn*Math.sign(G),B=U*xn*Math.sign(B)}}if(M){let _e=e.get(M.id);if(_e&&(_={fontSize:_e.fontSize}),t){let Yn={...n,width:G,height:B},xn=Cl(M,r,st(Yn,M));if(xn===null)return;_={fontSize:xn.size}}else{let Yn=Pf(Ee(M),M.lineHeight),xn=Sf(M.fontSize,M.lineHeight);G=Math.max(G,Yn),B=Math.max(B,xn)}}let[L,C,V,$]=xr(l,G,B,!0),de=V-L,fe=$-C,ie=[...m];if(["n","w","nw"].includes(o)&&(ie=[p[0]-Math.abs(de),p[1]-Math.abs(fe)]),o==="ne"){let _e=[m[0],p[1]];ie=[_e[0],_e[1]-Math.abs(fe)]}if(o==="sw"){let _e=[p[0],m[1]];ie=[_e[0]-Math.abs(de),_e[1]]}t&&(["s","n"].includes(o)&&(ie[0]=h[0]-de/2),["e","w"].includes(o)&&(ie[1]=h[1]-fe/2));let jt=G<0,Un=B<0;jt&&(o.includes("e")&&(ie[0]-=Math.abs(de)),o.includes("w")&&(ie[0]+=Math.abs(de))),Un&&(o.includes("s")&&(ie[1]-=Math.abs(fe)),o.includes("n")&&(ie[1]+=Math.abs(fe))),i&&(ie[0]=h[0]-Math.abs(de)/2,ie[1]=h[1]-Math.abs(fe)/2);let Dt=l.angle,Ir=ce(ie,h,Dt),Vn=[ie[0]+Math.abs(de)/2,ie[1]+Math.abs(fe)/2],$n=ce(Vn,h,Dt);ie=ce(Ir,$n,-Dt);let ve=[...ie],Xe=l.x-L,dt=l.y-C;ve[0]+=Xe,ve[1]+=dt;let gn=ve[0],Vp=ve[1],Nl,Bl;(J(n)||ge(n))&&(Nl=pn(1,B,l.points,!0),Bl=pn(0,G,Nl,!0));let qt={width:Math.abs(G),height:Math.abs(B),x:gn,y:Vp,points:Bl};if("scale"in n&&"scale"in l&&O(n,{scale:[(Math.sign(V-l.x)||l.scale[0])*l.scale[0],(Math.sign($-l.y)||l.scale[1])*l.scale[1]]}),j(n)&&M&&t){let _e=qt.width/n.width*M.fontSize;if(_e<ei)return;_.fontSize=_e}qt.width!==0&&qt.height!==0&&Number.isFinite(qt.x)&&Number.isFinite(qt.y)&&(O(n,qt),St(n,r,{newSize:{width:qt.width,height:qt.height}}),M&&_!=null&&O(M,{fontSize:_.fontSize}),Nn(n,r,o,t))},Fw=(e,t,n,r,o,i,a,s)=>{let l=t.reduce((C,V)=>{let $=e.get(V.id);return $&&C.push({orig:$,latest:V}),C},[]),c=l.reduce((C,{orig:V})=>{if(!J(V))return C;let $=Ut(V);if(!$)return C;let de=e.get($)??null;if(!be(de))return C;let fe=K.getBoundTextElementPosition(V,de,n);return[...C,{...de,...fe}]},[]),{minX:d,minY:u,maxX:f,maxY:m,midX:p,midY:h}=Xf(l.map(({orig:C})=>C).concat(c)),E=f-d,x=m-u,w=r,v={ne:[d,m],se:[d,u],sw:[f,u],nw:[f,m],e:[d,u+x/2],w:[f,u+x/2],n:[d+E/2,m],s:[d+E/2,u]},[T,b]=o?[p,h]:v[w],D=o?2:1,A=Math.max(Math.abs(a-T)/E||0,Math.abs(s-b)/x||0)*D;if(A===0)return;let S=w.includes("e")||w.includes("w")?Math.abs(a-T)/E*D:1,I=w.includes("n")||w.includes("s")?Math.abs(s-b)/x*D:1,P=i||l.some(C=>C.latest.angle!==0||Y(C.latest)||Qf(C.latest));P&&(S=A,I=A);let _={ne:[a<T,s>b],se:[a<T,s<b],sw:[a>T,s<b],nw:[a>T,s>b],e:[a<T,!1],w:[a>T,!1],n:[!1,s>b],s:[!1,s<b]},[M,k]=_[w].map(C=>C?-1:1),U=M<0,G=k<0,B=[];for(let{orig:C,latest:V}of l){if(Y(C)&&be(C))continue;let $=C.width*S,de=C.height*I,fe=la(C.angle*M*k),ie=J(C)||ge(C),jt=C.x-T,Un=C.y-b,Dt=U&&!ie?$:0,Ir=G&&!ie?de:0,Vn=T+M*(jt*S+Dt),$n=b+k*(Un*I+Ir),ve=kw(C,$*M,de*k,!1),Xe={x:Vn,y:$n,width:$,height:de,angle:fe,...ve};if(di(C)&&(Xe.scale=[C.scale[0]*M,C.scale[1]*k]),Y(C)){let gn=Cl(C,n,$);if(!gn)return;Xe.fontSize=gn.size}let dt=e.get(Ut(C)??"");if(dt)if(P){let gn=dt.fontSize*A;if(gn<ei)return;Xe.boundTextFontSize=gn}else Xe.boundTextFontSize=dt.fontSize;B.push({element:V,update:Xe})}let L=B.map(({element:C})=>C);for(let{element:C,update:{boundTextFontSize:V,...$}}of B){let{width:de,height:fe,angle:ie}=$;O(C,$,!1),St(C,n,{simultaneouslyUpdated:L,newSize:{width:de,height:fe}});let jt=q(C,n);jt&&V&&(O(jt,{fontSize:V,angle:J(C)?void 0:ie},!1),Nn(C,n,r,!0))}fn.getScene(B[0].element)?.informMutation()},Nw=(e,t,n,r,o,i,a,s)=>{let l=5*Math.PI/2+Math.atan2(o-s,r-a);i&&(l+=xt/2,l-=l%xt),t.filter(c=>!ee(c)).forEach(c=>{let[d,u,f,m]=N(c,n),p=(d+f)/2,h=(u+m)/2,E=e.get(c.id)?.angle??c.angle,[x,w]=H(p,h,a,s,l+E-c.angle);O(c,{x:c.x+(x-p),y:c.y+(w-h),angle:la(l+E)},!1),St(c,n,{simultaneouslyUpdated:t});let v=q(c,n);v&&!j(c)&&O(v,{x:v.x+(x-p),y:v.y+(w-h),angle:la(l+E)},!1)}),fn.getScene(t[0])?.informMutation()},Bw=(e,t,n,r,o)=>{let[i,a,s,l]=t.length===1?N(t[0],n):De(t),c=(i+s)/2,d=(a+l)/2,u=t.length===1?t[0].angle:0;switch([r,o]=H(r,o,c,d,-u),e){case"n":return H(r-(i+s)/2,o-a,0,0,u);case"s":return H(r-(i+s)/2,o-l,0,0,u);case"w":return H(r-i,o-(a+l)/2,0,0,u);case"e":return H(r-s,o-(a+l)/2,0,0,u);case"nw":return H(r-i,o-a,0,0,u);case"ne":return H(r-s,o-a,0,0,u);case"sw":return H(r-i,o-l,0,0,u);case"se":return H(r-s,o-l,0,0,u);default:return[0,0]}},Gw=(e,t)=>{let[,[n,r]]=t.points;return e==="nw"&&(n<0||r<0)||e==="ne"&&n>=0||e==="sw"&&n<=0||e==="se"&&(n>0||r>0)?"end":"origin"};g();var zw=(e,t,n,r,o,i,a)=>{let s=new Set(t),l=t.filter(u=>ee(u)).map(u=>u.id);if(l.length>0)for(let u of o.getNonDeletedElements())u.frameId!==null&&l.includes(u.frameId)&&s.add(u);let c=De(Array.from(s).map(u=>e.originalElements.get(u.id)??u)),d=Hw(c,n,i,a);s.forEach(u=>{if(Op(e,u,d),!j(u)){let f=q(u,o.getNonDeletedElementsMap());f&&Op(e,f,d)}St(u,o.getElementsMapIncludingDeleted(),{simultaneouslyUpdated:Array.from(s)})})},Hw=(e,t,n,r)=>{let[o,i]=e,a=o+t.x+n.x,s=i+t.y+n.y;if(n.x===0||n.y===0){let[l,c]=fo(o+t.x,i+t.y,r);n.x===0&&(a=l),n.y===0&&(s=c)}return{x:a-o,y:s-i}},Op=(e,t,n)=>{let r=e.originalElements.get(t.id)??t,o=r.x+n.x,i=r.y+n.y;O(t,{x:o,y:i})},Uw=(e,t,n)=>{let[r,o]=De(e);return[t-r,n-o]},Vw=(e,t,n,r,o,i,a,s,l,c,d,u=null)=>{l&&e.type!=="selection"&&(d?s=a/d:(Math.abs(i-r)>Math.abs(o-n)?{width:a,height:s}=ia(t,s,o<n?-a:a):{width:a,height:s}=ia(t,a,i<r?-s:s),s<0&&(s=-s)));let f=o<n?n-a:n,m=i<r?r-s:r;c&&(a+=a,s+=s,f=n-a/2,m=r-s/2),a!==0&&s!==0&&O(e,{x:f+(u?.x??0),y:m+(u?.y??0),width:a,height:s})};g();var $w=(e,t)=>!!(!e.viewModeEnabled&&(e.activeTool.type!=="custom"&&(e.editingElement||e.activeTool.type!=="selection"&&e.activeTool.type!=="eraser"&&e.activeTool.type!=="hand"&&e.activeTool.type!=="laser")||at(t,e).length));var iL=e=>e.reduce((t,n)=>t+n.version,0),aL=e=>{let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e[n].versionNonce;return t>>>0},sL=e=>{let t=5381;for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);t=(t<<5)+t+r}return t>>>0},of=e=>e.filter(t=>!t.isDeleted&&!Co(t)),yl=e=>e.filter(t=>!t.isDeleted),Pp=e=>!e.isDeleted,Rp=e=>yl(e).map(t=>is(t.type)?{...t,lastCommittedPoint:null}:t),Om=e=>Rp(e),Qi=e=>Rp(e);var Np=async e=>{let t;if(e.type===F.png)try{return await(await import("./image-35KQQ5EN.js")).decodePngMetadata(e)}catch(n){throw n.message==="INVALID"?new Yt("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):new Yt("Error: cannot restore image")}else if("text"in Blob?t=await e.text():t=await new Promise(n=>{let r=new FileReader;r.readAsText(e,"utf8"),r.onloadend=()=>{r.readyState===FileReader.DONE&&n(r.result)}}),e.type===F.svg)try{return await(await import("./image-35KQQ5EN.js")).decodeSvgMetadata({svg:t})}catch(n){throw n.message==="INVALID"?new Yt("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):new Yt("Error: cannot restore image")}return t};var Yw=e=>e&&e.name.match(/\.(json|excalidraw|png|svg)$/)?.[1]||null,CL=e=>e==="png"||e==="svg",Cm=e=>{let t=Yw(e);return t==="png"||t==="svg"},da=e=>{let{type:t}=e||{};return!!t&&Object.values(qa).includes(t)},Ww=async(e,t,n,r)=>{let o=await Np(e),i;try{try{i=JSON.parse(o)}catch(a){throw da(e)?new Yt("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):a}if(km(i))return{type:F.excalidraw,data:Do({elements:Qi(i.elements||[]),appState:{theme:t?.theme,fileHandle:r||e.handle||null,...ai(i.appState||{}),...t?Ms(i.elements||[],t):{}},files:i.files},t,n,{repairBindings:!0,refreshDimensions:!1})};if(ml(i))return{type:F.excalidrawlib,data:i};throw new Error("Error: invalid file")}catch(a){throw a instanceof Yt?a:new Error("Error: invalid file")}},Lm=async(e,t,n,r)=>{let o=await Ww(e,t,n,r);if(o.type!==F.excalidraw)throw new Error("Error: invalid file");return o.data},Xw=(e,t="unpublished")=>{let n=JSON.parse(e);if(!ml(n))throw new Error("Invalid library");let r=n.libraryItems||n.library;return tp(r,t)},LL=async(e,t="unpublished")=>Xw(await Np(e),t),kL=async e=>new Promise(async(t,n)=>{try{ci(e)&&(e=await e),e.toBlob(r=>{if(!r)return n(new Wi("Error: Canvas too big","CANVAS_POSSIBLY_TOO_BIG"));t(r)})}catch(r){n(r)}}),OL=async e=>{try{let t=await window.crypto.subtle.digest("SHA-1",await Kt(e));return du(new Uint8Array(t))}catch(t){return console.error(t),ii(40)}},RL=async e=>new Promise((t,n)=>{let r=new FileReader;r.onload=()=>{let o=r.result;t(o)},r.onerror=o=>n(o),r.readAsDataURL(e)}),FL=(e,t="")=>{let n=e.indexOf(","),r=atob(e.slice(n+1)),o=e.slice(0,n).split(":")[1].split(";")[0],i=new ArrayBuffer(r.length),a=new Uint8Array(i);for(let s=0;s<r.length;s++)a[s]=r.charCodeAt(s);return new File([i],t,{type:o})},NL=async(e,t)=>{if(e.type===F.svg)return e;let[n,r]=await Promise.all([import("./pica-GFNRRI3K.js").then(i=>i.default),import("./image-blob-reduce.esm-2RRQLBYF.js").then(i=>i.default)]),o=r({pica:n({features:["js","wasm"]})});if(t.outputType){let{outputType:i}=t;o._create_blob=function(a){return this.pica.toBlob(a.out_canvas,i,.8).then(s=>(a.out_blob=s,a))}}if(!da(e))throw new Error("Error: unsupported file type",{cause:"UNSUPPORTED"});return new File([await o.toBlob(e,{max:t.maxWidthOrHeight})],e.name,{type:t.outputType||e.type})},BL=(e,t="")=>new File([new TextEncoder().encode(e)],t,{type:F.svg}),GL=async(e,t="")=>{let n;try{n=await fetch(e)}catch{throw new Error("Error: failed to fetch image",{cause:"FETCH_ERROR"})}if(!n.ok)throw new Error("Error: failed to fetch image",{cause:"FETCH_ERROR"});let r=await n.blob();if(r.type&&da(r)){let o=t||r.name||"";return new File([r],o,{type:r.type})}throw new Error("Error: unsupported file type",{cause:"UNSUPPORTED"})},zL=async e=>{let t=e.dataTransfer.files.item(0),n=await Zw(e);return{file:t?await fl(t):null,fileHandle:n}},Zw=async e=>{if(Ar)try{return await e.dataTransfer.items[0].getAsFileSystemHandle()||null}catch(t){return console.warn(t.name,t.message),null}return null},Fp=e=>{let t=null,n=`${[...new Uint8Array(e).slice(0,8)].join(" ")} `,r={png:"137 80 78 71 13 10 26 10 ",jpg:"255 216 255 ",gif:"71 73 70 56 57 97 "};return n===r.png?t=F.png:n.startsWith(r.jpg)?t=F.jpg:n.startsWith(r.gif)&&(t=F.gif),t},ca=(e,t,n)=>new File([e],n||"",{type:t}),fl=async e=>{if(e.type){if(da(e)){let t=await Kt(e),n=Fp(t);n&&n!==e.type&&(e=ca(t,n,e.name))}}else if(e?.name?.endsWith(".excalidrawlib"))e=ca(await Kt(e),F.excalidrawlib,e.name);else if(e?.name?.endsWith(".excalidraw"))e=ca(await Kt(e),F.excalidraw,e.name);else{let t=await Kt(e),n=Fp(t);n&&(e=ca(t,n,e.name))}return e},Kt=e=>"arrayBuffer"in e?e.arrayBuffer():new Promise((t,n)=>{let r=new FileReader;r.onload=o=>{if(!o.target?.result)return n(new Error("Couldn't convert blob to ArrayBuffer"));t(o.target.result)},r.readAsArrayBuffer(e)});var Ll=e=>new Promise((t,n)=>{let r=typeof e=="string"?new Blob([new TextEncoder().encode(e)]):new Blob([e instanceof Uint8Array?e:new Uint8Array(e)]),o=new FileReader;o.onload=i=>{if(!i.target||typeof i.target.result!="string")return n(new Error("couldn't convert to byte string"));t(i.target.result)},o.readAsBinaryString(r)}),Bp=e=>{let t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t},Gp=e=>new TextDecoder("utf-8").decode(Bp(e)),zp=async(e,t=!1)=>t?window.btoa(e):window.btoa(await Ll(e)),Hp=async(e,t=!1)=>t?window.atob(e):Gp(window.atob(e)),kl=async({text:e,compress:t})=>{let n;if(t!==!1)try{n=await Ll((0,ua.deflate)(e))}catch(r){console.error("encode: cannot deflate",r)}return{version:"1",encoding:"bstring",compressed:!!n,encoded:n||await Ll(e)}},Ol=async e=>{let t;switch(e.encoding){case"bstring":t=e.compressed?e.encoded:await Gp(e.encoded);break;default:throw new Error(`decode: unknown encoding "${e.encoding}"`)}return e.compressed?(0,ua.inflate)(new Uint8Array(Bp(t)),{to:"string"}):t};var Kw=async e=>{let n=(0,Rl.default)(new Uint8Array(await Kt(e))).find(r=>r.name==="tEXt");return n?Fl.default.decode(n.data):null},dp=async({blob:e,metadata:t})=>{let n=(0,Rl.default)(new Uint8Array(await Kt(e))),r=Fl.default.encode(F.excalidraw,JSON.stringify(await kl({text:t,compress:!0})));return n.splice(-1,0,r),new Blob([(0,Up.default)(n)],{type:F.png})},nk=async e=>{let t=await Kw(e);if(t?.keyword===F.excalidraw)try{let n=JSON.parse(t.text);if(!("encoded"in n)){if("type"in n&&n.type===Pe.excalidraw)return t.text;throw new Error("FAILED")}return await Ol(n)}catch(n){throw console.error(n),new Error("FAILED")}throw new Error("INVALID")},rk=async({text:e})=>{let t=await zp(JSON.stringify(await kl({text:e})),!0),n="";return n+=`<!-- payload-type:${F.excalidraw} -->`,n+="<!-- payload-version:2 -->",n+="<!-- payload-start -->",n+=t,n+="<!-- payload-end -->",n},ok=async({svg:e})=>{if(e.includes(`payload-type:${F.excalidraw}`)){let t=e.match(/<!-- payload-start -->\s*(.+?)\s*<!-- payload-end -->/);if(!t)throw new Error("INVALID");let o=(e.match(/<!-- payload-version:(\d+) -->/)?.[1]||"1")!=="1";try{let i=await Hp(t[1],o),a=JSON.parse(i);if(!("encoded"in a)){if("type"in a&&a.type===Pe.excalidraw)return i;throw new Error("FAILED")}return await Ol(a)}catch(i){throw console.error(i),new Error("FAILED")}}throw new Error("INVALID")};export{In as a,Yb as b,Wb as c,jo as d,qo as e,z as f,Xb as g,Zb as h,Kb as i,jb as j,qb as k,Jb as l,Jo as m,ry as n,oy as o,Ud as p,ay as q,sy as r,ly as s,Vd as t,$d as u,cy as v,dy as w,uy as x,fy as y,Qo as z,my as A,py as B,hy as C,Je as D,Ey as E,pe as F,ke as G,xe as H,wt as I,Qe as J,nr as K,ti as L,Yr as M,gy as N,xy as O,wy as P,by as Q,yy as R,qa as S,F as T,vy as U,Pe as V,Ja as W,Ty as X,Ay as Y,Sy as Z,_y as _,Iy as $,Wd as aa,Py as ba,My as ca,ri as da,Dy as ea,Cy as fa,Ly as ga,ky as ha,Oy as ia,Ry as ja,Fy as ka,Ny as la,Xd as ma,Qa as na,By as oa,Gy as pa,Q as qa,es as ra,he as sa,Rt as ta,ts as ua,Oe as va,zy as wa,JE as xa,Jd as ya,Hy as za,Uy as Aa,Vy as Ba,Qd as Ca,Tt as Da,ii as Ea,a1 as Fa,s1 as Ga,l1 as Ha,tg as Ia,c1 as Ja,d1 as Ka,rs as La,Ee as Ma,su as Na,lu as Oa,cu as Pa,u1 as Qa,f1 as Ra,Ve as Sa,Wr as Ta,m1 as Ua,Xr as Va,os as Wa,p1 as Xa,or as Ya,h1 as Za,E1 as _a,g1 as $a,on as ab,x1 as bb,w1 as cb,b1 as db,y1 as eb,X as fb,v1 as gb,Nt as hb,T1 as ib,A1 as jb,S1 as kb,_1 as lb,ci as mb,I1 as nb,Bt as ob,P1 as pb,Pn as qb,M1 as rb,uu as sb,D1 as tb,C1 as ub,L1 as vb,k1 as wb,O1 as xb,fu as yb,Gt as zb,R1 as Ab,yt as Bb,di as Cb,ui as Db,Zr as Eb,tt as Fb,Y as Gb,Kr as Hb,mu as Ib,ee as Jb,J as Kb,j as Lb,is as Mb,jr as Nb,ag as Ob,sg as Pb,as as Qb,ir as Rb,be as Sb,fi as Tb,z1 as Ub,H1 as Vb,Pt as Wb,lt as Xb,Xi as Yb,Yt as Zb,Em as _b,To as $b,zn as ac,fn as bc,$f as cc,ce as dc,Fe as ec,_t as fc,fo as gc,Vt as hc,h_ as ic,E_ as jc,Xg as kc,JT as lc,Zg as mc,Kg as nc,Ds as oc,jg as pc,Mi as qc,mA as rc,Ne as sc,pA as tc,hA as uc,EA as vc,Ls as wc,DA as xc,ks as yc,Os as zc,CA as Ac,LA as Bc,kA as Cc,Ci as Dc,ix as Ec,co as Fc,St as Gc,OA as Hc,RA as Ic,pf as Jc,K as Kc,po as Lc,bf as Mc,yf as Nc,oS as Oc,Ws as Pc,Zs as Qc,pS as Rc,Tf as Sc,Bn as Tc,hr as Uc,Sf as Vc,Ks as Wc,Er as Xc,Pf as Yc,Ut as Zc,q as _c,Se as $c,hS as ad,ES as bd,gS as cd,xS as dd,wS as ed,Ys as fd,st as gd,Eo as hd,bS as id,Fi as jd,N as kd,De as ld,l_ as md,Xf as nd,c_ as od,et as pd,nu as qd,ru as rd,jx as sd,v_ as td,T_ as ud,qx as vd,A_ as wd,jf as xd,S_ as yd,Jx as zd,wr as Ad,__ as Bd,I_ as Cd,P_ as Dd,M_ as Ed,br as Fd,O_ as Gd,nm as Hd,rm as Id,om as Jd,u0 as Kd,f0 as Ld,m0 as Md,lm as Nd,xo as Od,oI as Pd,iI as Qd,aI as Rd,sI as Sd,Mt as Td,$i as Ud,g0 as Vd,lI as Wd,Gn as Xd,x0 as Yd,wo as Zd,w0 as _d,cI as $d,Ki as ae,Tr as be,xm as ce,Am as de,Sm as ee,r2 as fe,o2 as ge,Ar as he,Dm as ie,ul as je,ep as ke,Q0 as le,Do as me,tp as ne,Kw as oe,dp as pe,nk as qe,rk as re,ok as se,Yw as te,CL as ue,Cm as ve,da as we,Ww as xe,Lm as ye,Xw as ze,LL as Ae,kL as Be,OL as Ce,RL as De,FL as Ee,NL as Fe,BL as Ge,GL as He,zL as Ie,fl as Je,Mo as Ke,N2 as Le,B2 as Me,O0 as Ne,G2 as Oe,R0 as Pe,Rm as Qe,Fm as Re,$2 as Se,Nm as Te,j2 as Ue,q2 as Ve,J2 as We,Q2 as Xe,eP as Ye,B0 as Ze,G0 as _e,pl as $e,uP as af,fP as bf,El as cf,z0 as df,yP as ef,SP as ff,Gm as gf,zm as hf,U0 as if,$m as jf,Xm as kf,Zm as lf,tM as mf,vM as nf,aw as of,OM as pf,RM as qf,sp as rf,FM as sf,NM as tf,cp as uf,Tl as vf,mw as wf,pw as xf,hw as yf,XM as zf,fp as Af,xw as Bf,pp as Cf,bD as Df,hn as Ef,yD as Ff,vD as Gf,ko as Hf,xl as If,TD as Jf,AD as Kf,Ce as Lf,SD as Mf,yw as Nf,Ap as Of,vw as Pf,_D as Qf,ID as Rf,ta as Sf,Km as Tf,jm as Uf,Lx as Vf,FS as Wf,Js as Xf,le as Yf,O as Zf,Ye as _f,bo as $f,Co as ag,Sp as bg,Us as cg,bl as dg,Il as eg,sa as fg,Pl as gg,pC as hg,Iw as ig,Pw as jg,Dw as kg,Cw as lg,Fw as mg,Bw as ng,Gw as og,zw as pg,Uw as qg,Vw as rg,$w as sg,iL as tg,aL as ug,sL as vg,yl as wg,Pp as xg,Tw as yg,Di as zg,RD as Ag,Jg as Bg,Qg as Cg,at as Dg,ex as Eg,al as Fg,Wg as Gg,Ms as Hg,qg as Ig,nA as Jg};
